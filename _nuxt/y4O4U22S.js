import{d as O,r as C,j as R,a8 as q,k as F,z as U,o as i,l,J as c,g as f,F as _,B as v,m as S,E as $,q as T,t as A,h as V,f as J,R as G,a9 as P,_ as Q}from"./DJlEGeV1.js";import{i as W}from"./D_bDmjDt.js";import{d as j}from"./DD4asW33.js";const X={key:0,class:"ui-table-mobile__header"},Y={key:1,class:"ui-table-mobile__head"},Z={class:"ui-table-mobile__sort"},x=["title","onClick"],ee={key:0,class:"ui-table-mobile__sort-icons"},te={key:0,class:"ui-table-mobile__summary"},ae={key:2,class:"ui-table-mobile__no-data"},se={key:3,class:"ui-table-mobile__footer"},le=O({__name:"UiTableMobile",props:{data:{type:Array,required:!0,default:()=>[]},headers:{type:Array,default:()=>[]},summary:{type:Object,default:void 0},defaultSort:{type:Object,default:void 0},scrollAutoDisabling:{type:Boolean,default:!1},scrollToTop:{type:Boolean,default:!1},hideHeaders:{type:Boolean,default:!1},height:{type:String,default:void 0},rowKey:{type:String,default:void 0},maxHeight:{type:String,default:void 0},minHeight:{type:String,default:void 0}},emits:["sort","row-click"],setup(o,{expose:z,emit:M}){var B,w;const r=o,m=C(),y=C([]),d=R({order:((B=r.defaultSort)==null?void 0:B.order)??"",prop:((w=r.defaultSort)==null?void 0:w.prop)??""});q(()=>{var e;y.value=r.data,g(),r.scrollToTop&&((e=m.value)==null||e.scrollTo({top:0}))});let b=null;function D(){m.value&&(b=W({target:[m.value],threshold:1,callback(e){const t=e.target;e.isIntersecting?j(!1,t):(j(!0,t),t.scrollTo({top:0}))}}))}F(()=>{r.scrollAutoDisabling&&D()}),U(()=>{r.scrollAutoDisabling&&(b==null||b.disconnect())});const p=(e="default")=>!!P()[e];function g(){var a;let e=d.order,t=d.prop;e===""&&r.defaultSort&&(e=r.defaultSort.order,t=r.defaultSort.prop);const s=(a=r.headers)==null?void 0:a.find(n=>n.key===t);s&&(typeof s.sortMethod=="function"?y.value.sort((n,u)=>{var h,k;return e==="desc"?((h=s.sortMethod)==null?void 0:h.call(s,u,n))||0:((k=s.sortMethod)==null?void 0:k.call(s,n,u))||0}):s.sortable===!0&&y.value.sort((n,u)=>{const h=(e==="desc"?u:n)[t],k=(e==="desc"?n:u)[t];return String(h).localeCompare(String(k),void 0,{numeric:!0,sensitivity:"base"})}))}const I=M;function N(e){let t=e.key,s=d.order;d.prop!==t&&(s=""),s?s==="asc"?s="desc":(s="",t=""):s="asc",d.order=s,d.prop=t}function E(e){var t;e.sortable&&((t=m.value)==null||t.scrollTo({top:0}),N(e),g(),I("sort",{...d,column:e}))}function K(e,t){return typeof e.formatter=="function"?e.formatter(t):t}function H(e,t){return d.order===e&&d.prop===t}function L(e){return typeof r.summary!="object"||!Object.keys(r.summary).includes(e.key)?"":typeof e.formatter=="function"?e.formatter(r.summary[e.key]):r.summary[e.key]}return z({sortItems:g}),(e,t)=>{const s=Q;return i(),l("div",{class:"ui-table-mobile",style:G({height:o.height,maxHeight:o.maxHeight,minHeight:o.minHeight})},[p("header")?(i(),l("div",X,[c(e.$slots,"header")])):f("",!0),o.headers.length&&!o.hideHeaders?(i(),l("ul",Y,[(i(!0),l(_,null,v(o.headers,a=>(i(),l("li",{key:a.key,class:"ui-table-mobile__head-item"},[S("div",Z,[S("button",{title:a.tooltip,class:$(["ui-table-mobile__sort-btn",[a.sortable?"ui-table-mobile__sort-btn--has-sort":""]]),onClick:n=>E(a)},[c(e.$slots,`${a.key}-header`,{},()=>[T(A(a.label),1)])],10,x),a.sortable?(i(),l("span",ee,[V(s,{size:"16",name:"arrow-up",class:$(["ui-table-mobile__sort-icon",[H("asc",a.key)?"is-active":""]])},null,8,["class"]),V(s,{size:"16",name:"arrow-down",class:$(["ui-table-mobile__sort-icon",[H("desc",a.key)?"is-active":""]])},null,8,["class"])])):f("",!0)]),o.summary?(i(),l("div",te,[c(e.$slots,`${a.key}-summary`,{},()=>[T(A(L(a)),1)])])):f("",!0)]))),128))])):f("",!0),S("ul",{ref_key:"tableListRef",ref:m,class:"ui-table-mobile__list"},[(i(!0),l(_,null,v(J(y),(a,n)=>(i(),l("li",{key:String(o.rowKey?a[o.rowKey]:n),class:"ui-table-mobile__row"},[p("default")?c(e.$slots,"default",{key:0,row:a,data:null,index:n}):(i(!0),l(_,{key:1},v(o.headers,u=>(i(),l("td",{key:u.key,class:"ui-table-mobile__cell"},[a?c(e.$slots,`${u.key}`,{key:0,row:a,data:a[u.key],index:n},()=>[T(A(K(u,a[u.key])),1)]):f("",!0)]))),128))]))),128))],512),Array.isArray(o.data)&&o.data.length?f("",!0):(i(),l("div",ae," Нет данных ")),p("footer")?(i(),l("div",se,[c(e.$slots,"footer")])):f("",!0)],4)}}});export{le as _};
