import{t as S,d as j,_ as U}from"./disableScroll.CnCvpm-R.js";import{f as W,r as q,n as G,Q as P,q as Q,y as J,o as u,c as d,G as g,m as h,a as m,F as $,A as N,k as x,C as w,K as T,P as X,d as B,t as F,b as z}from"./entry.BwCe-mLo.js";function Y(o,A,p){const r=[],c={...o};if(typeof c.target=="string"){const n=document.querySelectorAll(c.target);Array.prototype.forEach.call(n,y=>{r.push(y)})}else Array.isArray(c.target)&&c.target.forEach(n=>{r.push(n)});const i=new IntersectionObserver(n=>{n.forEach(y=>{const{target:b,isIntersecting:_}=y;c.visibleClassName&&b.classList[_?"add":"remove"](c.visibleClassName),c.hiddenSelector&&b.classList[_?"remove":"add"](c.hiddenSelector),typeof p=="function"&&p(y),o.once&&_&&i.unobserve(b)})},A);return r.forEach(n=>i.observe(n)),i}const Z={key:0,class:"ui-table__header"},ee={class:"ui-table__table"},te={class:"ui-table__head"},se={class:"ui-table__head-row"},re={class:"ui-table__sort"},ae=["title","onClick"],oe={key:0,class:"ui-table__sort-icons"},ie={key:0,class:"ui-table__summary"},le={class:"ui-table__body"},ne=["onClick"],ue={key:0,class:"ui-table__no-data"},de={key:1,class:"ui-table__footer"},ye=W({__name:"UiTable",props:{data:{type:Array,required:!0,default:()=>[]},headers:{type:Array,required:!0,default:()=>[]},summary:{type:Object,default:void 0},defaultSort:{type:Object,default:void 0},noWrap:Boolean,scrollAutoDisabling:Boolean,scrollToTop:Boolean,isFixed:Boolean,height:{type:String,default:void 0},rowKey:{type:String,default:void 0},maxHeight:{type:String,default:void 0},minHeight:{type:String,default:void 0}},emits:["sort","row-click"],setup(o,{expose:A,emit:p}){var V,M;const r=o,c=q(),i=G({order:((V=r.defaultSort)==null?void 0:V.order)??"",prop:((M=r.defaultSort)==null?void 0:M.prop)??""}),n=q([]);P(()=>{var e;n.value=r.data,S(r.scrollToTop)&&((e=c.value)==null||e.scrollTo({top:0}))});let y=null;function b(){y=Y({target:".ui-table__scroll",visibleClassName:"ui-table__scroll--in-view"},{rootMargin:"0%",threshold:1},e=>{const a=e.target;e.isIntersecting?j(!1,a):(j(!0,a),a.scrollTo({top:0}))})}function _(){y==null||y.disconnect()}Q(()=>{S(r.scrollAutoDisabling)&&b(),C()}),J(()=>{S(r.scrollAutoDisabling)&&_()});const E=e=>({textAlign:e.align,width:Number(e.width)?`${e.width}px`:"auto"}),H=(e="default")=>!!X()[e];function C(){var t;let e=i.order,a=i.prop;e===""&&r.defaultSort&&(e=r.defaultSort.order,a=r.defaultSort.prop);const s=(t=r.headers)==null?void 0:t.find(f=>f.key===a);s&&(typeof s.sortMethod=="function"?n.value.sort((f,l)=>{var v,k;return e==="desc"?((v=s.sortMethod)==null?void 0:v.call(s,l,f))||0:((k=s.sortMethod)==null?void 0:k.call(s,f,l))||0}):s.sortable===!0&&n.value.sort((f,l)=>{const v=(e==="desc"?l:f)[a],k=(e==="desc"?f:l)[a];return String(v).localeCompare(String(k),void 0,{numeric:!0,sensitivity:"base"})}))}const I=p;function D(e){let a=e.key,s=i.order;i.prop!==a&&(s=""),s?s==="asc"?s="desc":(s="",a=""):s="asc",i.order=s,i.prop=a}function K(e){e.sortable&&(D(e),C(),I("sort",{...i,column:e}))}function L(e,a){return typeof e.formatter=="function"?e.formatter(a):a}function O(e,a){return i.order===e&&i.prop===a}function R(e){return typeof r.summary!="object"||!Object.keys(r.summary).includes(e.key)?"":typeof e.formatter=="function"?e.formatter(r.summary[e.key]):r.summary[e.key]}return A({sortItems:C}),(e,a)=>{const s=U;return u(),d("div",{class:w(["ui-table",[o.noWrap?"ui-table--no-wrap":""]]),style:T({height:o.height,maxHeight:o.maxHeight,minHeight:o.minHeight,tableLayout:("toFlag"in e?e.toFlag:x(S))(o.isFixed)?"fixed":"auto"})},[H("header")?(u(),d("div",Z,[g(e.$slots,"header")])):h("",!0),m("div",{ref_key:"tableScrollRef",ref:c,class:"ui-table__scroll"},[m("table",ee,[m("thead",te,[m("tr",se,[(u(!0),d($,null,N(o.headers,t=>(u(),d("th",{key:t.key,style:T(E(t)),class:"ui-table__cell ui-table__cell--header"},[m("div",re,[m("button",{title:t.tooltip,class:w(["ui-table__sort-btn",[t.sortable?"ui-table__sort-btn--has-sort":""]]),onClick:f=>K(t)},[g(e.$slots,`${t.key}-header`,{},()=>[B(F(t.label),1)])],10,ae),t.sortable?(u(),d("span",oe,[z(s,{size:"16",name:"arrow-up",class:w(["ui-table__sort-icon",[O("asc",t.key)?"is-active":""]])},null,8,["class"]),z(s,{size:"16",name:"arrow-down",class:w(["ui-table__sort-icon",[O("desc",t.key)?"is-active":""]])},null,8,["class"])])):h("",!0)]),o.summary?(u(),d("div",ie,[g(e.$slots,`${t.key}-summary`,{},()=>[B(F(R(t)),1)])])):h("",!0)],4))),128))])]),m("tbody",le,[(u(!0),d($,null,N(x(n),(t,f)=>(u(),d("tr",{key:String(o.rowKey?t[o.rowKey]:f),class:"ui-table__row",onClick:l=>I("row-click",t)},[(u(!0),d($,null,N(o.headers,l=>(u(),d("td",{key:l.key,class:"ui-table__cell",style:T(E(l))},[t?g(e.$slots,`${l.key}`,{key:0,row:t,data:t[l.key],index:f},()=>[B(F(L(l,t[l.key])),1)]):h("",!0)],4))),128))],8,ne))),128))])]),Array.isArray(o.data)&&o.data.length?h("",!0):(u(),d("div",ue," Нет данных "))],512),H("footer")?(u(),d("div",de,[g(e.$slots,"footer")])):h("",!0)],6)}}});export{ye as _};
