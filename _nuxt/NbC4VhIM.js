import{d as E,r as B,k as F,an as R,l as U,B as q,o as l,m as n,N as c,g as f,F as v,D as S,n as $,I as p,t as T,v as w,h as V,f as G,a4 as J,ao as P,_ as Q}from"./CjZrE5Wh.js";import{i as W}from"./Bx2A0I5R.js";import{d as D}from"./DD4asW33.js";const X={key:0,class:"ui-table-mobile__header"},Y={key:1,class:"ui-table-mobile__head"},Z={class:"ui-table-mobile__sort"},x=["title","onClick"],ee={key:0,class:"ui-table-mobile__sort-icons"},te={key:0,class:"ui-table-mobile__summary"},ae={key:2,class:"ui-table-mobile__no-data"},se={key:3,class:"ui-table-mobile__footer"},le=E({__name:"UiTableMobile",props:{data:{type:Array,required:!0,default:()=>[]},headers:{type:Array,default:()=>[]},summary:{type:Object,default:void 0},defaultSort:{type:Object,default:void 0},scrollAutoDisabling:{type:Boolean,default:!1},scrollToTop:{type:Boolean,default:!1},hideHeaders:{type:Boolean,default:!1},height:{type:String,default:void 0},rowKey:{type:String,default:void 0},maxHeight:{type:String,default:void 0},minHeight:{type:String,default:void 0}},emits:["sort","row-click"],setup(o,{expose:I,emit:M}){var C,H;const r=o,m=B(),y=B([]),d=F({order:((C=r.defaultSort)==null?void 0:C.order)??"",prop:((H=r.defaultSort)==null?void 0:H.prop)??""});R(()=>{var e;y.value=r.data,_(),r.scrollToTop&&((e=m.value)==null||e.scrollTo({top:0}))});let b=null;function N(){m.value&&(b=W({target:[m.value],threshold:1,callback(e){const t=e.target;e.isIntersecting?D(!1,t):(D(!0,t),t.scrollTo({top:0}))}}))}U(()=>{r.scrollAutoDisabling&&N()}),q(()=>{r.scrollAutoDisabling&&(b==null||b.disconnect())});const g=(e="default")=>!!P()[e];function _(){var a;let e=d.order,t=d.prop;e===""&&r.defaultSort&&(e=r.defaultSort.order,t=r.defaultSort.prop);const s=(a=r.headers)==null?void 0:a.find(u=>u.key===t);s&&(typeof s.sortMethod=="function"?y.value.sort((u,i)=>{var h,k;return e==="desc"?((h=s.sortMethod)==null?void 0:h.call(s,i,u))||0:((k=s.sortMethod)==null?void 0:k.call(s,u,i))||0}):s.sortable===!0&&y.value.sort((u,i)=>{const h=(e==="desc"?i:u)[t],k=(e==="desc"?u:i)[t];return String(h).localeCompare(String(k),void 0,{numeric:!0,sensitivity:"base"})}))}const j=M;function z(e){let t=e.key,s=d.order;d.prop!==t&&(s=""),s?s==="asc"?s="desc":(s="",t=""):s="asc",d.order=s,d.prop=t}function K(e){var t;e.sortable&&((t=m.value)==null||t.scrollTo({top:0}),z(e),_(),j("sort",{...d,column:e}))}function L(e,t){return typeof e.formatter=="function"?e.formatter(t):t}function A(e,t){return d.order===e&&d.prop===t}function O(e){return typeof r.summary!="object"||!Object.keys(r.summary).includes(e.key)?"":typeof e.formatter=="function"?e.formatter(r.summary[e.key]):r.summary[e.key]}return I({sortItems:_}),(e,t)=>{const s=Q;return l(),n("div",{class:"ui-table-mobile",style:J({height:o.height,maxHeight:o.maxHeight,minHeight:o.minHeight})},[g("header")?(l(),n("div",X,[c(e.$slots,"header")])):f("",!0),o.headers.length&&!o.hideHeaders?(l(),n("ul",Y,[(l(!0),n(v,null,S(o.headers,a=>(l(),n("li",{key:a.key,class:"ui-table-mobile__head-item"},[$("div",Z,[$("button",{title:a.tooltip,class:p(["ui-table-mobile__sort-btn",[a.sortable?"ui-table-mobile__sort-btn--has-sort":""]]),onClick:u=>K(a)},[c(e.$slots,`${a.key}-header`,{},()=>[T(w(a.label),1)])],10,x),a.sortable?(l(),n("span",ee,[V(s,{size:"16",name:"arrow-up",class:p(["ui-table-mobile__sort-icon",[A("asc",a.key)?"is-active":""]])},null,8,["class"]),V(s,{size:"16",name:"arrow-down",class:p(["ui-table-mobile__sort-icon",[A("desc",a.key)?"is-active":""]])},null,8,["class"])])):f("",!0)]),o.summary?(l(),n("div",te,[c(e.$slots,`${a.key}-summary`,{},()=>[T(w(O(a)),1)])])):f("",!0)]))),128))])):f("",!0),$("ul",{ref_key:"tableListRef",ref:m,class:"ui-table-mobile__list"},[(l(!0),n(v,null,S(G(y),(a,u)=>(l(),n("li",{key:String(o.rowKey?a[o.rowKey]:u),class:"ui-table-mobile__row"},[g("default")?c(e.$slots,"default",{key:0,row:a,data:null,index:u}):(l(!0),n(v,{key:1},S(o.headers,i=>(l(),n("td",{key:i.key,class:p(["ui-table-mobile__cell",[i.rowClass?i.rowClass:""]])},[a?c(e.$slots,`${i.key}`,{key:0,row:a,data:a[i.key],index:u},()=>[T(w(L(i,a[i.key])),1)]):f("",!0)],2))),128))]))),128))],512),Array.isArray(o.data)&&o.data.length?f("",!0):(l(),n("div",ae," Нет данных ")),g("footer")?(l(),n("div",se,[c(e.$slots,"footer")])):f("",!0)],4)}}});export{le as _};
