import{_ as P}from"./DiXYNXtO.js";import{_ as x}from"./BzuktaOv.js";import{_ as I}from"./DqBwsydm.js";import{b as T,h as m,_ as S}from"./Dv9xmF1z.js";import{f as $,u as B,n as p,s as e,i as N,q as V,c as C,b as s,w as i,k as _,a as o,o as E,t as L}from"./C0--9zv3.js";import{u as M}from"./BS9eCQy9.js";import{_ as R}from"./DFny041v.js";import"./eq0CTgKj.js";import"./B4KRNvBX.js";import"./DlAUqK2U.js";import"./CUPIIRYo.js";const U={class:"leaderboards-tanks-page"},W=o("div",{class:"leaderboards-tanks-page__description content-area"},[o("h2",null,"Топ популярных танков (тест)"),o("p",null,"Чем выше позиция рейтинге, тем больше боёв сыграно на танке."),o("p",null,"В учёт бои сыгранные игроками зарегистрированными на данном ресурсе.")],-1),q={class:"leaderboards-tanks-page__tank"},z={class:"leaderboards-tanks-page__tank-name"},Z=$({__name:"tanks",setup(A){B({title:"Рейтинги / Аккаунты"});const l=M(),a=p({loading:0,tanks:[],items:[]}),d=p({page:1,pageSize:10}),u=[{key:"position",label:"#",width:40,align:"center"},{key:"name",label:"Название"},{key:"players",label:"Игроков",tooltip:e.stat.accountProp("battles"),formatter:t=>e.number.toInteger(t)},{key:"battles",label:"Боёв всего",tooltip:e.stat.accountProp("battles"),formatter:t=>e.number.toInteger(t)},{key:"win_rate",label:"Победы",tooltip:e.stat.accountProp("winRate"),formatter:t=>e.number.toFloatNumber(t)},{key:"damage_per_battle",label:"Урон",tooltip:e.stat.accountProp("damagePerBattle"),formatter:t=>e.number.toInteger(t)},{key:"xp_per_battle",label:"Опыт",tooltip:e.stat.accountProp("xp"),formatter:t=>e.number.toInteger(t)}],c=N(()=>l.vehicles);V(()=>{b()});async function f(){a.loading++;try{const{data:t}=await T.leaderboards.getTanks(d);a.tanks=t}catch(t){a.tanks=[],m(t,{title:"Получение рейтинга игроков"})}a.loading--}async function g(){if(!c.value){a.loading++;try{await l.getTanksVehicles()}catch(t){m(t,{title:"Получение данных описания техники"})}a.loading--}}function k(){const t=c.value;a.tanks.length&&t&&(a.items=a.tanks.map(r=>({...r,...t[r.tank_id]})))}async function b(){await Promise.all([f(),g()]),k()}return(t,r)=>{const h=P,y=x,w=I,v=S;return E(),C("div",U,[W,s(w,{"no-wrap":"","row-key":"id","scroll-to-top":"","scroll-auto-disabling":"",headers:u,data:_(a).items,height:"calc(100vh - 112px)"},{position:i(({index:n})=>[s(R,{position:n+1},null,8,["position"])]),name:i(({row:n})=>[o("div",q,[s(h,{class:"leaderboards-tanks-page__tank-img",src:n.images.preview,alt:n.name},null,8,["src","alt"]),o("div",z,L(n.name),1)])]),win_rate:i(({row:n})=>[s(y,{"win-rate":n.win_rate,class:"leaderboards-tanks-page__win-rate"},null,8,["win-rate"])]),_:1},8,["data"]),s(v,{loading:_(a).loading>0},null,8,["loading"])])}}});export{Z as default};
