import{_ as T}from"./B6ZSgAcB.js";import{_ as I}from"./B4NeK8UY.js";import{_ as S}from"./DX4LQXT-.js";import{_ as $}from"./34P0Lxgg.js";import{d as B,u as N,a as V,b as C,l as m,x as e,e as R,m as A,G as E,p,o as H,q as L,s as n,j as r,w as i,v as M,g as d}from"./Divx9Nzj.js";import{c as U}from"./B4FMxlHh.js";import{u as j}from"./C8llOfle.js";import{_ as q}from"./DMsb_d6n.js";import"./O7DRg4lh.js";import"./AomIj8wQ.js";import"./DlAUqK2U.js";import"./DD4asW33.js";const z={class:"leaderboards-tanks-page"},D={class:"leaderboards-tanks-page__tank"},F={class:"leaderboards-tanks-page__tank-name"},nt=B({__name:"tanks",setup(G){const{$formatter:_}=N(),u=V();C({title:()=>_.route.getTitle(U.toString(u.name)??"")});const l=j(),a=m({loading:0,tanks:[],items:[]}),g=m({page:1,pageSize:99}),f=[{key:"position",label:"#",width:40,align:"center"},{key:"name",label:"Название"},{key:"players",label:"Игроков",tooltip:e.stat.accountProp("battles"),formatter:t=>e.number.toInteger(t)},{key:"battles",label:"Боёв всего",tooltip:e.stat.accountProp("battles"),formatter:t=>e.number.toInteger(t)},{key:"win_rate",label:"Победы",tooltip:e.stat.accountProp("winRate"),formatter:t=>e.number.toFloatNumber(t)},{key:"damage_per_battle",label:"Урон",tooltip:e.stat.accountProp("damagePerBattle"),formatter:t=>e.number.toInteger(t)},{key:"xp_per_battle",label:"Опыт",tooltip:e.stat.accountProp("xp"),formatter:t=>e.number.toInteger(t)}],c=R(()=>l.vehicles);A(()=>{y()});async function k(){a.loading++;try{const{data:t}=await E.leaderboards.getTanks(g);a.tanks=t}catch(t){a.tanks=[],p(t,{title:"Получение рейтинга игроков"})}a.loading--}async function b(){if(!c.value){a.loading++;try{await l.getTanksVehicles()}catch(t){p(t,{title:"Получение данных описания техники"})}a.loading--}}function h(){const t=c.value;a.tanks.length&&t&&(a.items=a.tanks.map(s=>({...s,...t[s.tank_id]})))}async function y(){await Promise.all([k(),b()]),h()}return(t,s)=>{const w=T,v=I,x=S,P=$;return H(),L("div",z,[s[0]||(s[0]=n("div",{class:"leaderboards-tanks-page__description content-area"},[n("h2",null,"Топ популярных танков (тест)"),n("p",null,"Чем выше позиция рейтинге, тем больше боёв сыграно на танке."),n("p",null,"В учёт бои сыгранные игроками зарегистрированными на данном ресурсе.")],-1)),r(x,{"no-wrap":"","row-key":"id","scroll-to-top":"","scroll-auto-disabling":"",headers:f,data:d(a).items,height:"calc(100vh - 112px)"},{position:i(({index:o})=>[r(q,{position:o+1},null,8,["position"])]),name:i(({row:o})=>[n("div",D,[r(w,{class:"leaderboards-tanks-page__tank-img",src:o.images.preview,alt:o.name},null,8,["src","alt"]),n("div",F,M(o.name),1)])]),win_rate:i(({row:o})=>[r(v,{"win-rate":o.win_rate,class:"leaderboards-tanks-page__win-rate"},null,8,["win-rate"])]),_:1},8,["data"]),r(P,{loading:d(a).loading>0},null,8,["loading"])])}}});export{nt as default};
