import{N as De}from"./nuxt-icon.C5s37704.js";import{J as Pe,o as f,c as w,a as i,f as j,i as M,s as B,b as y,C as J,k as r,t as R,m as P,r as z,n as Y,j as V,w as T,d as I,F as G,A as Q,q as Be,v as ke,x as ue,y as Et,T as Ye,D as Ze,E as te,_ as ae,K as et,L as X,M as Ie,g as Lt,z as Ee,N as Re,O as Te,H as ve}from"./entry.D9s_uxMW.js";import{_ as Ft,m as ie}from"./RatingIcon.vue.DFlXyFD0.js";import{_ as tt}from"./nuxt-link.BZuFVyid.js";import{_ as we,a as ne,h as q,u as qt,t as Nt}from"./disableScroll.DsAaY2lW.js";import{_ as de,a as oe,s as W}from"./request.BaBM-RDs.js";import{_ as _e,a as jt,i as Ht,g as Gt}from"./UiDialog.vue.D5eiAM2Z.js";import{a as ge}from"./index.BserKom7.js";import{c as zt,_ as at,m as se}from"./index.k9frDcAh.js";import{a as le,_ as Kt}from"./UiSelect.vue.B7zQuOWp.js";import{u as Wt}from"./index.DHt8-hNG.js";import{_ as Xt}from"./PageSection.vue.B0xWyULr.js";import{_ as Oe}from"./UiImage.vue.BJHbq71s.js";import{f as nt,m as Jt}from"./index.DvmWSzMD.js";import{_ as xe}from"./WinRate.vue.3hlswtnN.js";import{_ as st}from"./UiTable.vue.DurFHiUj.js";import{s as L}from"./index.C1Da7NNJ.js";import{_ as Qt,a as Yt,b as Zt,d as ea,e as ta,i as aa,f as na,g as sa,c as ee}from"./cloneDeep.Hrh3Pw33.js";import{e as oa}from"./isArrayLike.CWcuhWDo.js";import{u as ia}from"./user.TkPZn-Bw.js";import{u as ca}from"./index.yp7RdZMY.js";const la={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 62 62"},ra=i("path",{fill:"currentColor","fill-rule":"evenodd",d:"M28.5 43c8.56 0 15.5-3.134 15.5-7v6c0 3.866-6.94 7-15.5 7S13 45.866 13 42v-6c0 3.866 6.94 7 15.5 7","clip-rule":"evenodd"},null,-1),ua=i("path",{fill:"currentColor","fill-rule":"evenodd",d:"M34.5 36c8.56 0 15.5-3.134 15.5-7v6c0 3.866-6.94 7-15.5 7S19 38.866 19 35v-6c0 3.866 6.94 7 15.5 7","clip-rule":"evenodd"},null,-1),da=i("path",{fill:"currentColor","fill-rule":"evenodd",d:"M44 19c0 3.866-6.94 7-15.5 7S13 22.866 13 19v6c0 3.866 6.94 7 15.5 7S44 28.866 44 25zm-1 0c0 1.296-1.21 2.8-3.951 4.038C36.4 24.234 32.672 25 28.5 25s-7.9-.766-10.549-1.962C15.211 21.801 14 20.296 14 19s1.21-2.8 3.951-4.038C20.6 13.766 24.328 13 28.5 13s7.9.766 10.549 1.962C41.789 16.199 43 17.704 43 19","clip-rule":"evenodd"},null,-1),_a=[ra,ua,da];function ma(t,l){return f(),w("svg",la,[..._a])}const Le={render(){return Pe(De,{icon:{render:ma},name:"gold"})}},fa={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 62 62"},pa=i("path",{stroke:"currentColor","stroke-width":"4",d:"m31 13.472 3.486 10.73.45 1.382H47.67l-9.127 6.63-1.176.855.45 1.382 3.486 10.73-9.127-6.632L31 37.695l-1.176.854-9.127 6.631 3.487-10.73.449-1.381-1.176-.854-9.127-6.631h12.735l.449-1.382z"},null,-1),va=[pa];function ha(t,l){return f(),w("svg",fa,[...va])}const ka={render(){return Pe(De,{icon:{render:ha},name:"xp"})}},ga={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 62 62"},ya=i("path",{fill:"currentColor","fill-rule":"evenodd",d:"M49.306 27.104 44.133 9l9.483 11.574zm-14.426 25L56 23.654v13.793l-14.655 7.759h12.069l-7.759 5.172zm-21.552-25L18.5 9 9.017 20.574zm13.793 25L6 23.656v13.793l14.655 7.758H8.586l7.759 5.173zM21 20l10-4 10 4v16l-10 8-10-8zm6 12.5L29 22l5.5-1-2 7 4-.5-7 11 2-8z","clip-rule":"evenodd"},null,-1),wa=[ya];function ba(t,l){return f(),w("svg",ga,[...wa])}const $a={render(){return Pe(De,{icon:{render:ba},name:"prem"})}},Aa={class:"account-resources"},Ra={class:"account-resources__inner"},Ta={key:0,class:"account-resources__item"},Ca={class:"account-resources__text"},Sa={class:"account-resources__item"},Ia={class:"account-resources__text"},Da={class:"account-resources__item"},Pa={class:"account-resources__text"},Ba={class:"account-resources__item"},Oa={class:"account-resources__text"},xa=j({__name:"AccountResources",props:{resources:{type:Object,required:!0,default:()=>({})}},setup(t){const l=t,u=M(()=>{const v=l.resources.premium_expires_at*1e3;return v-Date.now()<=0?"":B.date.toTimePassed(v,Date.now(),!0)});return(v,d)=>(f(),w("div",Aa,[i("div",Ra,[t.resources.is_premium.toLocaleString()?(f(),w("div",Ta,[y(r($a),{filled:!0,"font-controlled":!1,class:J(["account-resources__icon",[{"account-resources__icon--prem":r(u)}]])},null,8,["class"]),i("div",Ca,R(r(u)||"0 дн."),1)])):P("",!0),i("div",Sa,[y(r(Le),{filled:!0,"font-controlled":!1,class:"account-resources__icon account-resources__icon--gold"}),i("div",Ia,R(t.resources.gold.toLocaleString()),1)]),i("div",Da,[y(r(Le),{filled:!0,"font-controlled":!1,class:"account-resources__icon account-resources__icon--credits"}),i("div",Pa,R(t.resources.credits.toLocaleString()),1)]),i("div",Ba,[y(r(ka),{filled:!0,"font-controlled":!1,class:"account-resources__icon account-resources__icon--xp"}),i("div",Oa,R(t.resources.free_xp.toLocaleString()),1)])])]))}}),Ma={class:"account-preview-details__body"},Ua={class:"account-preview-details__section"},Va={class:"account-preview-details__props-title"},Ea={class:"account-preview-details__props"},La={class:"account-preview-details__prop"},Fa=i("span",{class:"account-preview-details__prop-title"}," Дата создания ",-1),qa={class:"account-preview-details__prop"},Na=i("span",{class:"account-preview-details__prop-title"}," Дата обновления ",-1),ja={key:0,class:"account-preview-details__section"},Ha={class:"account-preview-details__props-title"},Ga={class:"account-preview-details__props"},za={class:"account-preview-details__prop"},Ka=i("span",{class:"account-preview-details__prop-title"}," Зарегистрирован ",-1),Wa={class:"account-preview-details__prop"},Xa=i("span",{class:"account-preview-details__prop-title"}," Последний визит ",-1),Ja={class:"account-preview-details__section"},Qa={class:"account-preview-details__props-title"},Ya={key:0,class:"account-preview-details__props"},Za={class:"account-preview-details__prop"},en=i("span",{class:"account-preview-details__prop-title"}," Командир ",-1),tn={class:"account-preview-details__prop"},an=i("span",{class:"account-preview-details__prop-title"}," Участников ",-1),nn={class:"account-preview-details__prop"},sn=i("span",{class:"account-preview-details__prop-title"}," Создан ",-1),on={class:"account-preview-details__prop"},cn=i("span",{class:"account-preview-details__prop-title"}," Роль ",-1),ln={class:"account-preview-details__prop"},rn=i("span",{class:"account-preview-details__prop-title"}," Вступил ",-1),un={key:1,class:"account-preview-details__props"},dn=i("div",{class:"account-preview-details__prop"}," Не состоит в клане ",-1),_n=[dn],mn={key:1,class:"account-preview-details__section"},fn={class:"account-preview-details__props-title"},pn={class:"account-preview-details__props"},vn={class:"account-preview-details__prop"},hn=i("span",{class:"account-preview-details__prop-title"}," Данные собираются со дня регистрации на сайте. ",-1),kn={key:0,class:"account-preview-details__clan-history"},gn={class:"account-preview-details__clan-history-date"},yn={key:1,class:"account-preview-details__clan-history-link"},wn={style:{display:"flex","justify-content":"space-between"}},bn=i("span",null,null,-1),$n=j({__name:"AccountPreviewDetails",props:{account:{type:[Object,null],required:!0},clanAccount:{type:[Object,null],required:!0}},setup(t,{expose:l}){const u=(n,a)=>{var x,F;if(!(n!=null&&n.raw)&&n.timestamp)return B.date.toDate(n.timestamp);const p=a?a.raw?a.raw.joined_at*1e3:a.timestamp:Date.now(),S=n.raw?((x=n.raw)==null?void 0:x.joined_at)*1e3:n.timestamp,m=B.date.toDate(n.raw?((F=n.raw)==null?void 0:F.joined_at)*1e3:n==null?void 0:n.timestamp),C=B.date.toDaysPassed(p,S,!0);return`${m} (${C})`},v=t,d=z(null),_=Y({user:null,clan:null,clanHistory:[],loading:0,isOpened:!1});async function $(n){_.loading++;try{const{data:a}=await oe.clan.getInfo({clan_id:n});_.clan=a?a[n]:null}catch(a){q(a,{title:"Получение данных клана"})}_.loading--}async function b(n){_.loading++;try{const{data:a}=await ge.user.get(n);_.user=a}catch(a){q(a,{title:"Получение данных пользователя"})}finally{_.loading--}}async function A(n){_.loading++;try{const{data:a}=await oe.clan.getInfo({clan_id:n.join(","),fields:"clan_id,name,tag"});return a??null}catch(a){return q(a,{title:"Получение данных кланов"}),null}finally{_.loading--}}function e(n,a){_.clanHistory=n.map((p,S)=>{const{raw:m,timestamp:C}=p,x=m&&a?a[m.clan_id]:null;return{key:C,date:u(p,n[S-1]),info:x&&m?`[${x.tag}] ${B.clan.role(m.role)}`:"Не в клане",clanId:(m==null?void 0:m.clan_id)??null}})}async function s(n){_.loading++;try{const{data:a}=await ge.stat.clansAccounts.getList({id:n});return a??[]}catch(a){return q(a,{title:"Получение данных пользователя"}),[]}finally{_.loading--}}async function h(){var a;if(_.isOpened||!v.account||(_.isOpened=!0,(a=v.clanAccount)!=null&&a.clan_id&&await $(v.clanAccount.clan_id),await b(v.account.account_id),!_.user))return;const n=await s(v.account.account_id);if(n.length){const p=n.filter(({raw:m})=>m==null?void 0:m.clan_id).map(({raw:m})=>m==null?void 0:m.clan_id),S=await A(p);e(n,S)}}function k(){var n;(n=d.value)==null||n.doClose()}async function o(){var n;await h(),await((n=d.value)==null?void 0:n.doOpen())}return l({close:k,open:o}),(n,a)=>{const p=we,S=tt,m=de,C=ne,x=_e;return t.account?(f(),V(x,{key:0,ref_key:"detailedDialogRef",ref:d,class:"account-preview-details",title:"Дополнительная информация",width:"600px"},{footer:T(()=>[i("div",wn,[bn,y(C,{onClick:k},{default:T(()=>[I(" Закрыть ")]),_:1})])]),default:T(()=>{var F,E,U,Z;return[i("div",Ma,[i("div",Ua,[i("h5",Va,[y(p,{class:"account-preview-details__prop-title-icon",name:"sports-esports"}),I(" Аккаунт игрока ")]),i("div",Ea,[i("div",La,[Fa,I(" "+R(n.$formatter.date.toDate(t.account.created_at*1e3)),1)]),i("div",qa,[Na,I(" "+R(n.$formatter.date.toDate(t.account.updated_at*1e3)),1)])])]),r(_).user?(f(),w("div",ja,[i("h5",Ha,[y(p,{class:"account-preview-details__prop-title-icon",name:"person"}),I(" Пользователь ресурса ")]),i("div",Ga,[i("div",za,[Ka,I(" "+R(n.$formatter.date.toDate((F=r(_).user)==null?void 0:F.createAt)),1)]),i("div",Wa,[Xa,I(" "+R(n.$formatter.date.toDate((E=r(_).user)==null?void 0:E.visitedAt)),1)])])])):P("",!0),i("div",Ja,[i("h5",Qa,[y(p,{class:"account-preview-details__prop-title-icon",name:"groups"}),I(" Клан игрока ")]),r(_).clan&&t.clanAccount?(f(),w("div",Ya,[i("div",Za,[en,r(_).clan.leader_id?(f(),V(S,{key:0,class:"account-preview-details__clan-history-link link",to:{name:"account-id",params:{id:r(_).clan.leader_id}}},{default:T(()=>{var K;return[I(R((K=r(_).clan)==null?void 0:K.leader_name),1)]}),_:1},8,["to"])):P("",!0)]),i("div",tn,[an,I(" "+R(n.$formatter.number.toInteger((U=r(_).clan)==null?void 0:U.members_count)),1)]),i("div",nn,[sn,I(" "+R(n.$formatter.date.toDate(((Z=r(_).clan)==null?void 0:Z.created_at)*1e3)),1)]),i("div",on,[cn,I(" "+R(n.$formatter.clan.role(t.clanAccount.role)),1)]),i("div",ln,[rn,I(" "+R(n.$formatter.date.toDate(t.clanAccount.joined_at*1e3)),1)])])):(f(),w("div",un,_n))]),r(_).user?(f(),w("div",mn,[i("h5",fn,[y(p,{class:"account-preview-details__prop-title-icon",name:"history"}),I(" Клановая история ")]),i("div",pn,[i("div",vn,[hn,r(_).clanHistory.length?(f(),w("div",kn,[(f(!0),w(G,null,Q(r(_).clanHistory,K=>(f(),w("div",{key:K.key,class:"account-preview-details__clan-history-item"},[i("span",gn,R(K.date),1),K.clanId?(f(),V(S,{key:0,class:"account-preview-details__clan-history-link link",to:{name:"clan-id",params:{id:K.clanId}}},{default:T(()=>[I(R(K.info),1)]),_:2},1032,["to"])):(f(),w("span",yn,R(K.info),1))]))),128))])):(f(),w(G,{key:1},[I(" Данные собираются. ")],64))])])])):P("",!0)]),y(m,{"backdrop-light":"",loading:r(_).loading>0},null,8,["loading"])]}),_:1},512)):P("",!0)}}}),An={class:"account-preview"},Rn={key:0,class:"account-preview__inner"},Tn={class:"account-preview__league"},Cn={class:"account-preview__info"},Sn={class:"account-preview__nickname"},In={class:"account-preview__nickname-text"},Dn={class:"account-preview__clan-text"},Pn={class:"account-preview__props"},Bn={class:"account-preview__prop"},On=i("span",{class:"account-preview__prop-title"}," Последний бой ",-1),xn={class:"account-preview__prop-value"},Mn={key:0,class:"account-preview__prop"},Un=i("span",{class:"account-preview__prop-title"}," Должность ",-1),Vn={class:"account-preview__prop-value"},En={class:"account-preview__actions"},Ln=j({__name:"AccountPreview",props:{account:{type:[Object,null],default:null,required:!0},loading:{type:Boolean,default:!1}},setup(t){const l=z(null),u=t,v=qt(),d=Y({clanAccount:null,isFavorite:!0,clan:null,detailsLoading:!1}),_=M(()=>{var k;return(k=d.clanAccount)==null?void 0:k.clan});Be(()=>{var o,n;A(),((o=u.account)==null?void 0:o.account_id)&&$((n=u.account)==null?void 0:n.account_id)});async function $(k){try{const{data:o}=await oe.clan.getAccountInfo({account_id:k,extra:"clan"});d.clanAccount=o?o[k]:null}catch(o){q(o,{title:"Получение данных клана"})}}async function b(){var k;d.detailsLoading=!0,await((k=l.value)==null?void 0:k.open()),d.detailsLoading=!1}async function A(){if(!u.account)return;const k=await W.indexedDB.accountsFavorites.get(u.account.account_id);d.isFavorite=k?k==null?void 0:k.isFavorite:!1}async function e(){u.account&&(d.isFavorite=!d.isFavorite,await W.indexedDB.accountsFavorites.set(u.account.account_id,{id:u.account.account_id,isFavorite:d.isFavorite}))}function s(){e()}async function h(){var o,n,a,p;await zt(`${(o=u.account)==null?void 0:o.nickname}/${(n=u.account)==null?void 0:n.account_id}`)?v.add({type:"success",title:"Скопировано",message:`${(a=u.account)==null?void 0:a.nickname}/${(p=u.account)==null?void 0:p.account_id}`,duration:3e3}):v.add({type:"error",message:"При копировании что-то пошло не так",duration:3e3})}return(k,o)=>{var x;const n=Ft,a=tt,p=we,S=ne,m=de,C=$n;return f(),w("div",An,[t.account?(f(),w("div",Rn,[i("div",Tn,[y(n,{large:"",rating:t.account.statistics.rating},null,8,["rating"])]),i("div",Cn,[i("div",Sn,[i("span",In,R(t.account.nickname),1)]),r(d).clanAccount&&r(_)?(f(),V(a,{key:0,class:"account-preview__clan link",title:"Перейти к клану",to:{name:"clan-id",params:{id:r(_).clan_id}}},{default:T(()=>[i("span",Dn," ["+R(r(_).tag)+"] "+R(r(_).name),1)]),_:1},8,["to"])):P("",!0),i("div",Pn,[i("div",Bn,[On,i("span",xn,R(k.$formatter.date.toRelativeTime(t.account.last_battle_time*1e3)),1)]),r(d).clanAccount?(f(),w("div",Mn,[Un,i("span",Vn,R(k.$formatter.clan.role((x=r(d).clanAccount)==null?void 0:x.role)),1)])):P("",!0)])]),i("div",En,[y(S,{"is-text":"",class:"account-preview__actions-btn",title:"Копировать (nickname/ID)",onClick:h},{default:T(()=>[y(p,{name:"content-copy"})]),_:1}),y(S,{"is-text":"",class:"account-preview__actions-btn",title:"Добавить в избранные",onClick:s},{default:T(()=>[r(d).isFavorite?(f(),V(p,{key:0,name:"star"})):(f(),V(p,{key:1,name:"star-border"}))]),_:1}),y(S,{"is-text":"",disabled:r(d).detailsLoading,class:"account-preview__actions-btn",title:"Дополнительная информация",onClick:b},{default:T(()=>[y(p,{name:"info"})]),_:1},8,["disabled"])])])):P("",!0),y(m,{loading:t.loading},null,8,["loading"]),y(C,{ref_key:"accountPreviewDetailsRef",ref:l,account:t.account,"clan-account":r(d).clanAccount},null,8,["account","clan-account"])])}}}),Fn=window.setInterval,qn={class:"session-panel"},Nn={class:"session-panel__inner"},jn={class:"session-panel__item"},Hn={class:"session-panel__buttons"},Gn={key:0,class:"session-panel__item session-panel__item--time"},zn={class:"session-panel__time"},Kn=i("span",{class:"session-panel__time-title"}," Время начала ",-1),Wn=i("div",{style:{margin:"0 0 1em"}}," Вы уверены, что хотите сбросить сессию? ",-1),Xn={style:{"text-align":"right"}},Fe=60,Jn=j({__name:"SessionPanel",props:ke({updateAt:{type:Number,required:!0,default:0},hideAutoUpdate:{type:[Boolean],default:!1},loading:{type:Boolean,required:!0,default:!1}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:ke(["reset","update","session-active"],["update:modelValue"]),setup(t,{emit:l}){const u=ue(t,"modelValue"),v=t,d=Wt(),_=z(null),$=Y({autoUpdateChecked:!1,autoUpdateInterval:Fe,autoUpdateCounter:Fe,autoUpdateTimer:0}),b=M(()=>{const k=B.date.toDateTime(v.updateAt),o=B.date.toDaysPassed(v.updateAt,Date.now(),!0);return`${k} (${o})`});Et(()=>{clearInterval($.autoUpdateTimer)});const A=l;function e(){var k;(k=_.value)==null||k.doOpen()}function s(k){var o;k&&A("reset"),(o=_.value)==null||o.doClose()}function h(){if($.autoUpdateChecked=!$.autoUpdateChecked,$.autoUpdateCounter=$.autoUpdateInterval,!$.autoUpdateChecked){clearInterval($.autoUpdateTimer);return}const k=()=>{if(clearInterval($.autoUpdateTimer),$.autoUpdateTimer=Fn(k,1e3),$.autoUpdateCounter>0){$.autoUpdateCounter--;return}$.autoUpdateCounter=$.autoUpdateInterval,A("update")};A("update"),k()}return(k,o)=>{const n=le,a=we,p=ne,S=de,m=_e;return f(),w("div",qn,[i("div",Nn,[i("div",jn,[i("div",Hn,[y(n,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=C=>u.value=C),class:"session-panel__btn",title:"Просмотр статистики за сессию"},{default:T(()=>[I(" Сессия ")]),_:1},8,["modelValue"]),t.hideAutoUpdate===!1?(f(),V(p,{key:0,class:"session-panel__btn",title:"Автоматическое обновление данных",onClick:h},{before:T(()=>[y(a,{name:"refresh-auto"})]),default:T(()=>[r(d).isTablet?P("",!0):(f(),w(G,{key:0},[I(" Обновление ")],64)),I(" "+R(r($).autoUpdateCounter)+" сек. ",1)]),_:1})):P("",!0),y(p,{class:"session-panel__btn",title:"Сброс данных сессии",onClick:e},{default:T(()=>[y(a,{name:"close"})]),_:1})])]),r(b)?(f(),w("div",Gn,[i("span",zn,[Kn,I(" "+R(r(b)),1)])])):P("",!0)]),y(S,{loading:t.loading},null,8,["loading"]),y(m,{ref_key:"confirmDialogRef",ref:_,title:"Сброс сессии"},{default:T(()=>[Wn,i("div",Xn,[y(p,{align:"center",width:"80px",onClick:o[1]||(o[1]=C=>s(!0))},{default:T(()=>[I(" Да ")]),_:1}),y(p,{align:"center",width:"80px",onClick:o[2]||(o[2]=C=>s(!1))},{default:T(()=>[I(" Нет ")]),_:1})])]),_:1},512)])}}}),Qn={class:"accounts-metrics"},Yn={class:"accounts-metrics__filters"},Zn={class:"accounts-metrics__filters-item"},es={class:"accounts-metrics__filters-item"},ts={class:"accounts-metrics__plates"},as=j({__name:"AccountsMetrics",props:{metrics:{type:Array,required:!0,default:()=>[]},filters:{type:Object,required:!0,default:()=>({})},loading:{type:Boolean,default:!1}},emits:["filters","is-open"],setup(t,{emit:l}){const u=["battles","winRate","damagePerBattle","winsInPlatoon","battlesPerDay","tanksWithMaster"],v=t,d=Y({isOpen:!1}),_=M(()=>d.isOpen?v.metrics:v.metrics.filter(A=>u.includes(A.key))),$=l;function b(){const A=v.filters.battleMode==="random"?"rating":"random";$("filters",{...v.filters,battleMode:A})}return(A,e)=>{const s=le,h=at;return f(),w("div",Qn,[i("div",Yn,[i("div",Zn,[y(s,{"model-value":t.filters.battleMode==="rating",onChange:b},{default:T(()=>[I(" Рейтинг ")]),_:1},8,["model-value"])]),i("div",es,[y(s,{modelValue:r(d).isOpen,"onUpdate:modelValue":e[0]||(e[0]=k=>r(d).isOpen=k)},{default:T(()=>[I(" Все показатели ")]),_:1},8,["modelValue"])])]),i("div",ts,[y(h,{loading:t.loading,items:r(_)},null,8,["loading","items"])])])}}}),ns=["onClick"],ss={class:"achievements-list__item-inner"},os={class:"achievements-list__item-img-wrapper"},is={key:0,class:"achievements-list__item-count"},cs={key:0,class:"achievements-list__item-series"},ls={key:1,class:"achievements-list__item-details"},rs=j({__name:"AchievementsList",props:{achievements:{type:Array,default:()=>[]},hideName:{type:[Boolean,String],default:!1}},emits:["medal-click"],setup(t,{emit:l}){const u=l;function v(d){u("medal-click",d)}return(d,_)=>{const $=Oe;return f(),w("div",{class:J(["achievements-list",[t.hideName?"achievements-list--small":""]])},[t.achievements.length?(f(),V(Ye,{key:0,tag:"ul",class:"achievements-list__list",name:"achievements-list__item-"},{default:T(()=>[(f(!0),w(G,null,Q(t.achievements,b=>(f(),w("li",{key:b.key,class:J(["achievements-list__item",[!b.count&&!b.series?"achievements-list__item--no-count":""]])},[i("button",{class:"achievements-list__item-btn",onClick:A=>v(b)},[i("span",ss,[i("span",os,[y($,{class:"achievements-list__item-img",src:b.image,alt:b.key,"data-name":b.name},null,8,["src","alt","data-name"])]),b.count||b.series?(f(),w("span",is,[I(R(b.count)+" ",1),b.series?(f(),w("span",cs," / "+R(b.series),1)):P("",!0)])):P("",!0),t.hideName?P("",!0):(f(),w("span",ls,R(b.name),1))])],8,ns)],2))),128))]),_:1})):P("",!0)],2)}}}),us={key:0,class:"achievements-block__details"},ds={class:"achievements-block__details-header"},_s={class:"achievements-block__details-name"},ms={class:"achievements-block__details-body"},fs=["textContent"],ps=["textContent"],vs={class:"achievements-block__details-footer"},hs=j({__name:"AchievementsDetails",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t,{expose:l}){const u=ue(t,"modelValue"),v=z(null),d=z(!1);function _(){d.value=!1}function $(){var b;(b=v.value)==null||b.doOpen()}return l({open:$}),(b,A)=>{const e=Oe,s=ne,h=_e;return f(),V(h,{ref_key:"detailsRef",ref:v,width:"640px",onOpen:_},{footer:T(()=>[i("div",vs,[y(s,{onClick:A[0]||(A[0]=k=>{var o;return(o=r(v))==null?void 0:o.doClose()})},{default:T(()=>[I(" Закрыть ")]),_:1})])]),default:T(()=>{var k;return[u.value?(f(),w("div",us,[i("div",ds,[y(e,{class:"achievements-block__details-img",src:u.value.image,alt:u.value.key},null,8,["src","alt"]),i("span",_s,R((k=u.value)==null?void 0:k.name),1),i("div",ms,[u.value.description?(f(),w("div",{key:0,textContent:R(u.value.description)},null,8,fs)):P("",!0),u.value.condition?(f(),w("div",{key:1,textContent:R(u.value.condition)},null,8,ps)):P("",!0)])])])):P("",!0)]}),_:1},512)}}}),ks={key:0,class:"achievements-block__inner"},gs={class:"achievements-block__filter"},ys={class:"achievements-block__filter-item"},ws={class:"achievements-block__filter-item"},bs={class:"achievements-block__filter-item"},$s={class:"achievements-block__section-title"},As={key:1,class:"achievements-block__empty"},Rs={key:1,class:"achievements-block__empty"},ot=j({__name:"AchievementsBlock",props:{achievements:{type:Object,required:!0,default:()=>({})},achievementsInfo:{type:Object,required:!0,default:()=>({})},filters:{type:Object,required:!0,default:()=>nt.makeAccountFilters()}},emits:["filters-changed"],setup(t,{emit:l}){const u=["markOfMastery","markOfMasteryI","markOfMasteryII","markOfMasteryIII","heroesOfRassenay","medalLafayettePool","medalRadleyWalters","warrior","medalKolobanov","mainGun","sniper","camper","medalBrothersInArms","medalCrucialContribution"],v=["battle","epic","title","commemorative","step","platoon"],d=t,_=z(),$=z(),b=Y({currentMedal:null,showAll:!1}),A=M(()=>{const n=Object.keys(d.achievements.achievements),a=Object.keys(d.achievements.achievements);return n.length||a.length}),e=M(()=>{if(d.filters.achievementsShow==="important"){const a=[];return Object.keys(d.achievements.achievements).forEach(p=>{const S=ie.achievementsMedal({key:p,achievements:d.achievements,encyclopedia:d.achievementsInfo});a.push(S)}),u.reduce((p,S)=>{const m=a.find(C=>C.key===S);return m?[...p,m]:p},[])}const n=Object.keys(d.achievementsInfo);return d.filters.achievementsShow==="deserved"?n.map(a=>ie.achievementsMedal({key:a,achievements:d.achievements,encyclopedia:d.achievementsInfo})).filter(a=>d.achievements.achievements[a.key]||d.achievements.max_series[a.key]).sort((a,p)=>a.key.localeCompare(p.key)):n.map(a=>ie.achievementsMedal({key:a,achievements:d.achievements,encyclopedia:d.achievementsInfo})).toSorted((a,p)=>a.key.localeCompare(p.key))}),s=M(()=>{const n={};return e.value.forEach(a=>{n[a.section]||(n[a.section]={name:a.section,items:[]}),n[a.section].items.push(a)}),Object.values(n).sort((a,p)=>v.indexOf(a.name)-v.indexOf(p.name))}),h=l;function k({key:n}){var a;b.currentMedal=e.value.find(p=>p.key===n)??null,(a=$.value)==null||a.open()}function o(n){h("filters-changed",{...d.filters,achievementsShow:n})}return(n,a)=>{const p=le,S=rs,m=hs;return f(),w("div",{ref_key:"mainRef",ref:_,class:"achievements-block"},[r(A)?(f(),w("div",ks,[i("div",gs,[i("div",ys,[y(p,{"model-value":t.filters.achievementsShow==="important",onChange:a[0]||(a[0]=C=>o("important"))},{default:T(()=>[I(" Значимые ")]),_:1},8,["model-value"])]),i("div",ws,[y(p,{"model-value":t.filters.achievementsShow==="deserved",onChange:a[1]||(a[1]=C=>o("deserved"))},{default:T(()=>[I(" Заслуженные ")]),_:1},8,["model-value"])]),i("div",bs,[y(p,{"model-value":t.filters.achievementsShow===null,onChange:a[2]||(a[2]=C=>o(null))},{default:T(()=>[I(" Все ")]),_:1},8,["model-value"])])]),r(e).length?(f(),w(G,{key:0},[t.filters.achievementsShow==="important"?(f(),V(S,{key:0,achievements:r(e),"hide-name":!0,onMedalClick:k},null,8,["achievements"])):(f(!0),w(G,{key:1},Q(r(s),C=>(f(),w("div",{key:C.name,class:"achievements-block__section"},[i("div",$s,R(n.$formatter.achievements.section(C.name)),1),y(S,{achievements:C.items,"hide-count":r(b).showAll,onMedalClick:k},null,8,["achievements","hide-count"])]))),128))],64)):(f(),w("div",As," Нет значимых достижений ")),y(m,{ref_key:"detailsRef",ref:$,modelValue:r(b).currentMedal,"onUpdate:modelValue":a[3]||(a[3]=C=>r(b).currentMedal=C)},null,8,["modelValue"])])):(f(),w("div",Rs," Нет достижений "))],512)}}}),be=j({__name:"TankType",props:ke({size:{type:Number,default:24},isPremium:{type:Boolean,default:!1},isCollectible:{type:[Boolean,String],default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const l={lightTank:te(()=>ae(()=>import("./light-tank.0FpbGRyM.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),mediumTank:te(()=>ae(()=>import("./medium-tank.C8Xfa10G.js"),__vite__mapDeps([5,1,2,3,4]),import.meta.url)),heavyTank:te(()=>ae(()=>import("./heavy-tank.NLDMsSXw.js"),__vite__mapDeps([6,1,2,3,4]),import.meta.url)),"AT-SPG":te(()=>ae(()=>import("./at-spg.Cr195pSX.js"),__vite__mapDeps([7,1,2,3,4]),import.meta.url))},u=ue(t,"modelValue"),v=M(()=>["AT-SPG","heavyTank","lightTank","mediumTank"].includes(u.value)?u.value:(console.warn("Not valid tank type - ",u.value),"span"));return(d,_)=>(f(),V(Ze(l[r(v)]),{filled:!0,"font-controlled":!1,class:J(["tank-type",[t.isPremium?"tank-type--is-premium":"",t.isCollectible?"tank-type--is-collectible":""]]),width:t.size,height:t.size},null,8,["class","width","height"]))}}),Ts=["src","alt"],it=j({__name:"TankNation",props:ke({size:{type:[Number,String],default:24}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const l=ue(t,"modelValue");return(u,v)=>(f(),w("img",{style:et({width:`${t.size}px`,height:`${t.size}px`}),src:`/img/nations/nation-${l.value}.svg`,alt:l.value,class:"tank-nation"},null,12,Ts))}}),Cs={class:"account-infographics"},Ss={class:"account-infographics__filters"},Is={class:"account-infographics__filters-chips"},Ds={class:"account-infographics__chart-list"},Ps={class:"account-infographics__chart-label"},Bs={class:"account-infographics__line-icon"},Os={key:2},xs={key:"battles",class:"account-infographics__line-value"},Ms={key:"damagePerBattle",class:"account-infographics__line-value"},Us=j({__name:"AccountInfographics",props:{tanks:{type:Array,default:()=>[],required:!0}},setup(t){const l=t,u=z("battles"),v=[{value:"battles",label:B.stat.accountProp("battles")},{value:"winRate",label:B.stat.accountProp("winRate")},{value:"damagePerBattle",label:B.stat.accountProp("damagePerBattle")}],d=M(()=>[{label:"По нации",key:"nation",value:_("nation")},{label:"По уровню",key:"tier",value:_("tier")},{label:"По типу",key:"type",value:_("type")}]);function _(b){var e;const A={};if(!((e=l.tanks)!=null&&e.length))return A;l.tanks.forEach(s=>{const h=s[b];s.tier&&(h in A||(A[h]={key:h,battles:0,winRate:0,damagePerBattle:0,lineHeight:0}),A[h].battles+=s.all.battles,A[h].winRate+=s.all.wins,A[h].damagePerBattle+=s.all.damage_dealt)});for(const s in A){const h=A[s].battles;A[s].winRate=h?A[s].winRate/(h/100):0,A[s].damagePerBattle=h?A[s].damagePerBattle/h:0}for(const s in A){const k=Math.min(...Object.values(A).map(n=>n[u.value])),o=Math.max(...Object.values(A).map(n=>n[u.value]))-k/1.1;A[s].lineHeight=(A[s][u.value]-k/1.1)/(o/100)}return A}function $(b){u.value=b}return(b,A)=>{const e=le,s=be,h=it,k=xe;return f(),w("div",Cs,[i("div",Ss,[i("div",Is,[(f(),w(G,null,Q(v,o=>y(e,{key:o.value,"model-value":o.value===r(u),onChange:n=>$(o.value)},{default:T(()=>[I(R(o.label),1)]),_:2},1032,["model-value","onChange"])),64))])]),i("div",Ds,[(f(!0),w(G,null,Q(r(d),o=>(f(),w("div",{key:o.key,class:J(["account-infographics__chart",[`account-infographics__chart--${o.key}`]])},[i("span",Ps,R(o.label),1),(f(!0),w(G,null,Q(o.value,n=>(f(),w("div",{key:n.key,class:"account-infographics__line"},[i("span",Bs,[o.key==="type"?(f(),V(s,{key:0,modelValue:n.key,"onUpdate:modelValue":a=>n.key=a},null,8,["modelValue","onUpdate:modelValue"])):o.key==="nation"?(f(),V(h,{key:1,modelValue:n.key,"onUpdate:modelValue":a=>n.key=a,size:"22"},null,8,["modelValue","onUpdate:modelValue"])):o.key==="tier"?(f(),w("span",Os,R(b.$formatter.encyclopedia.tier(n.key)),1)):(f(),w(G,{key:3},[I(R(n.key),1)],64))]),y(Ye,{tag:"span",name:"account-infographics__line-value-",class:"account-infographics__line-progress",style:et({"--chart-line-width":n.lineHeight/100})},{default:T(()=>[r(u)==="battles"?(f(),w("span",xs,R(b.$formatter.number.toInteger(n.battles)),1)):P("",!0),r(u)==="winRate"?(f(),V(k,{key:"winRate",modelValue:n.winRate,"onUpdate:modelValue":a=>n.winRate=a,class:"account-infographics__line-value"},null,8,["modelValue","onUpdate:modelValue"])):P("",!0),r(u)==="damagePerBattle"?(f(),w("span",Ms,R(b.$formatter.number.toInteger(n.damagePerBattle)),1)):P("",!0)]),_:2},1032,["style"])]))),128))],2))),128))])])}}}),Vs=j({__name:"MarkOfMastery",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){const l={1:te(()=>ae(()=>import("./3.XhRRpd5g.js"),__vite__mapDeps([8,1,2,3,4]),import.meta.url)),2:te(()=>ae(()=>import("./2.vmKmz7-z.js"),__vite__mapDeps([9,1,2,3,4]),import.meta.url)),3:te(()=>ae(()=>import("./1.Bn0oN55v.js"),__vite__mapDeps([10,1,2,3,4]),import.meta.url)),4:te(()=>ae(()=>import("./М.Ctku0SIs.js"),__vite__mapDeps([11,1,2,3,4]),import.meta.url))},u=ue(t,"modelValue");return(v,d)=>(f(),V(Ze(u.value?l[u.value]:"span"),{filled:!0,"font-controlled":!1,class:J(["mark-of-mastery",[u.value?"mark-of-mastery--"+u.value:""]])},null,8,["class"]))}}),Es={class:"account-tanks-table"},Ls={key:0,class:"account-tanks-table__total"},Fs={class:"account-tanks-table__total-value"},qs={class:"account-tanks-table__table"},Ns=["title"],js={class:"account-tanks-table__name-text"},Hs={key:0,class:"account-tanks-table__diff"},Gs={key:0,class:"account-tanks-table__diff"},zs={key:0,class:"account-tanks-table__diff"},Ks={key:0,class:"account-tanks-table__diff"},Ws={key:0,class:"account-tanks-table__diff"},Xs={key:0,class:"account-tanks-table__diff"},Js={key:0,class:"account-tanks-table__diff"},Qs={key:0,class:"account-tanks-table__diff"},Ys={class:"account-tanks-table__mark"},Zs={key:0,class:"account-tanks-table__diff"},eo={class:"account-tanks-table__diff"},ct=j({__name:"AccountTanksTable",props:{tanks:{type:Array,default:()=>[],required:!0},tanksDiff:{type:[Array,null],default:null,required:!0},noCount:{type:[Boolean,String],default:!1},height:{type:String,default:void 0},maxHeight:{type:String,default:void 0},sort:{type:Object,default:null},defaultSort:{type:Object,default:null},showDiff:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["row-click"],setup(t,{expose:l,emit:u}){const v=t,d=z(null),_=u,$=[{key:"type",label:"Тип",width:60,sortable:!0},{key:"name",label:"Название",sortable:!0},{key:"tier",label:"I-X",sortable:!0},{key:"battles",label:"Бои",sortable:!0,sortMethod(s,h){return s.all.battles-h.all.battles},formatter:s=>B.number.toInteger(s)},{key:"winRate",label:"Победы",sortable:!0,sortMethod(s,h){const k=s,o=h;return k.all.winRate-o.all.winRate},formatter:s=>B.number.toFloatPercent(s)},{key:"damagePerBattle",label:"Урон",sortable:!0,sortMethod(s,h){return s.all.damagePerBattle-h.all.damagePerBattle},formatter:s=>B.number.toInteger(s)},{key:"xpPerBattle",label:"Опыт",sortable:!0,sortMethod(s,h){return s.all.xpPerBattle-h.all.xpPerBattle},formatter:s=>B.number.toInteger(s)},{key:"fragPerBattle",label:"Уничт.",tooltip:"Уничтожено За Бой",sortable:!0,sortMethod(s,h){return s.all.fragPerBattle-h.all.fragPerBattle},formatter:s=>B.number.toFloatNumber(s)},{key:"hitRate",label:"Точн.",tooltip:"Точность стрельбы",sortable:!0,sortMethod(s,h){return s.all.hitRate-h.all.hitRate},formatter:s=>B.number.toPercent(s)},{key:"surviveRate",label:"Выж.",tooltip:"Выживаемость",sortable:!0,sortMethod(s,h){return s.all.surviveRate-h.all.surviveRate},formatter:s=>B.number.toPercent(s)},{key:"spottedPerBattle",label:"Обн.",tooltip:"Обнаружено за бой",sortable:!0,sortMethod(s,h){return s.all.spottedPerBattle-h.all.spottedPerBattle},formatter:s=>B.number.toFloatNumber(s)},{key:"mark_of_mastery",label:"M",tooltip:"Знак классности",sortable:!0,sortMethod(s,h){const k=s.markOfMastery.count+s.markOfMastery.value*1e4,o=h.markOfMastery.count+h.markOfMastery.value*1e4;return k-o},formatter:s=>B.stat.markOfMastery(Number(s))},{key:"last_battle_time",label:"Последний бой",sortable:!0}],b=M(()=>{let s={};return v.tanks.forEach((h,k)=>{k?s=L.sum(s,h.all):s=h.all}),L.tank(s)}),A={1:"markOfMasteryIII",2:"markOfMasteryII",3:"markOfMasteryI",4:"markOfMastery"},e=M(()=>v.tanks.map(s=>{var n;const h=(n=v.tanksDiff)==null?void 0:n.find(a=>a.tank_id===s.tank_id),k=s.achievements.achievements[A[s.mark_of_mastery]]??0,o=(h==null?void 0:h.achievements.achievements[A[s.mark_of_mastery]])??0;return{...s,diff:(h==null?void 0:h.all)??null,markOfMastery:{value:s.mark_of_mastery,count:k,diff:B.number.toInteger(o,!0)||"---"}}}));return l({sortItems(){var s;(s=d.value)==null||s.sortItems()}}),(s,h)=>{const k=be,o=ne,n=xe,a=Vs,p=st,S=de;return f(),w("div",Es,[("toFlag"in s?s.toFlag:r(Nt))(t.noCount)?P("",!0):(f(),w("div",Ls,[I(" Кол-во: "),i("span",Fs,R(t.tanks.length||0),1)])),i("div",qs,[y(p,{ref_key:"tableRef",ref:d,headers:$,data:r(e),summary:r(b),"default-sort":t.defaultSort,"scroll-auto-disabling":"","no-wrap":"","row-key":"tank_id",height:t.height,"max-height":t.maxHeight},{index:T(({index:m})=>[I(R(m+1),1)]),type:T(({row:m})=>[i("div",{class:"account-tanks-table__type",title:m.is_premium?"Премиум танк":""},[y(k,{modelValue:m.type,"onUpdate:modelValue":C=>m.type=C,"is-premium":m.is_premium,"is-collectible":m.is_collectible},null,8,["modelValue","onUpdate:modelValue","is-premium","is-collectible"])],8,Ns)]),name:T(({row:m})=>[y(o,{class:"account-tanks-table__name","is-text":"",onClick:C=>_("row-click",m.tank_id)},{default:T(()=>[i("span",js,R(m.name??`Tank ID: ${m.tank_id}`),1)]),_:2},1032,["onClick"])]),battles:T(({row:m})=>{var C;return[I(R(m.all.battles)+" ",1),t.showDiff?(f(),w("div",Hs,R(s.$formatter.number.toInteger((C=m.diff)==null?void 0:C.battles,!0)),1)):P("",!0)]}),winRate:T(({row:m})=>{var C;return[y(n,{"model-value":m.all.winRate,class:"account-tanks-table__win-rate"},null,8,["model-value"]),t.showDiff?(f(),w("div",Gs,R(s.$formatter.number.toFloatPercent((C=m.diff)==null?void 0:C.winRate,!0)),1)):P("",!0)]}),damagePerBattle:T(({row:m})=>{var C;return[I(R(m.all.damagePerBattle)+" ",1),t.showDiff?(f(),w("div",zs,R(s.$formatter.number.toInteger((C=m.diff)==null?void 0:C.damagePerBattle,!0)),1)):P("",!0)]}),xpPerBattle:T(({row:m})=>{var C;return[I(R(m.all.xpPerBattle)+" ",1),t.showDiff?(f(),w("div",Ks,R(s.$formatter.number.toInteger((C=m.diff)==null?void 0:C.xpPerBattle,!0)),1)):P("",!0)]}),fragPerBattle:T(({row:m})=>{var C;return[I(R(m.all.fragPerBattle)+" ",1),t.showDiff?(f(),w("div",Ws,R(s.$formatter.number.toInteger((C=m.diff)==null?void 0:C.fragPerBattle,!0)),1)):P("",!0)]}),hitRate:T(({row:m})=>{var C;return[I(R(s.$formatter.number.toFloatPercent(m.all.hitRate))+" ",1),t.showDiff?(f(),w("div",Xs,R(s.$formatter.number.toFloatNumber((C=m.diff)==null?void 0:C.hitRate,!0)),1)):P("",!0)]}),surviveRate:T(({row:m})=>{var C;return[I(R(s.$formatter.number.toFloatPercent(m.all.surviveRate))+" ",1),t.showDiff?(f(),w("div",Js,R(s.$formatter.number.toFloatNumber((C=m.diff)==null?void 0:C.surviveRate,!0)),1)):P("",!0)]}),spottedPerBattle:T(({row:m})=>{var C;return[I(R(m.all.spottedPerBattle)+" ",1),t.showDiff?(f(),w("div",Qs,R(s.$formatter.number.toInteger((C=m.diff)==null?void 0:C.spottedPerBattle,!0)),1)):P("",!0)]}),mark_of_mastery:T(({row:m})=>[i("div",Ys,[m.markOfMastery.value&&m.markOfMastery.count?(f(),V(a,{key:0,"model-value":m.markOfMastery.value,title:"Знак классности",width:"20",height:"20"},null,8,["model-value"])):P("",!0),I(" "+R(m.markOfMastery.count||"---"),1)]),t.showDiff?(f(),w("div",Zs,R(m.markOfMastery.diff),1)):P("",!0)]),last_battle_time:T(({row:m})=>[I(R(s.$formatter.date.toRelativeTime(m.last_battle_time*1e3)||"---")+" ",1),i("div",eo,R(s.$formatter.date.toDateTime(m.last_battle_time*1e3)||"---"),1)]),_:1},8,["data","summary","default-sort","height","max-height"]),y(S,{loading:t.loading},null,8,["loading"])])])}}}),to={class:"account-daily-stat"},ao={class:"account-daily-stat__count"},no=i("span",{class:"account-daily-stat__count-title"}," Кол-во: ",-1),so={class:"account-daily-stat__table"},oo={style:{display:"flex","justify-content":"flex-end"}},io=j({__name:"AccountDailyStat",props:{accountId:{type:[Number,String],default:0,required:!0},vehicles:{type:Object,default:()=>({}),required:!0}},emits:["sort"],setup(t,{emit:l}){const u=t,v=z(null),d=Y({loading:0,summary:{},items:[],currentItem:null,accounts:[],tanks:[]}),_={order:"desc",prop:"last_battle_time"},$=[{key:"index",label:"#"},{key:"date",label:"Дата"},{key:"tanks",label:"Танков"},{key:"tier",label:"I-X",formatter:o=>X(o)?B.number.toFloatNumber(o):"---"},{key:"battles",label:"Бои",formatter:o=>X(o)?B.number.toInteger(o):"---"},{key:"winRate",label:"Победы",formatter:o=>X(o)?B.number.toFloatPercent(o):"---"},{key:"damagePerBattle",label:"Урон",formatter:o=>X(o)?B.number.toInteger(o):"---"},{key:"xpPerBattle",label:"Опыт",formatter:o=>X(o)?B.number.toInteger(o):"---"},{key:"fragPerBattle",label:"Уничт.",tooltip:"Уничтожено За Бой",formatter:o=>X(o)?B.number.toFloatNumber(o):"---"},{key:"hitRate",label:"Точн.",tooltip:"Точность стрельбы",formatter:o=>X(o)?B.number.toFloatPercent(o):"---"},{key:"surviveRate",label:"Выж.",tooltip:"Выживаемость",formatter:o=>X(o)?B.number.toFloatPercent(o):"---"},{key:"spottedPerBattle",label:"Обн.",tooltip:"Обнаружено за бой",formatter:o=>X(o)?B.number.toFloatNumber(o):"---"}],b=M(()=>d.currentItem?d.currentItem.tanks.map(o=>{var n;return ie.accountTank(o,((n=u.vehicles)==null?void 0:n[o.tank_id])??null,null)}):[]);Be(async()=>{u.accountId&&(await e(u.accountId),s())});const A=l;async function e(o){const n=new Date,a=new Date;n.setDate(n.getDate()-90);const p={id:o,dateStart:n.toISOString(),dateEnd:a.toISOString()};try{const[S,m]=await Promise.all([ge.stat.accounts.getDiff(p),ge.stat.tanks.getDiff(p)]);d.tanks=m.data,d.accounts=S.data}catch(S){q(S,{title:"Получение дневной статистики"})}}function s(){let o=null;d.accounts.forEach(n=>{var m;const a=L.accountAll(n.raw.statistics.all),p=(m=d.tanks.find(C=>{const x=B.date.toDate(C.timestamp),F=B.date.toDate(n.timestamp);return x===F}))==null?void 0:m.raw,S=()=>{const C=(p==null?void 0:p.length)??0;return((p==null?void 0:p.reduce((x,F)=>{var E;return x+((E=u.vehicles[F.tank_id])==null?void 0:E.tier)||0},0))??0)/C};d.items.push({id:n.id,date:B.date.toDate(n.timestamp),battles:a.battles,winRate:a.winRate,damagePerBattle:a.damagePerBattle,xpPerBattle:a.xpPerBattle,fragPerBattle:a.fragPerBattle,hitRate:a.hitRate,surviveRate:a.surviveRate,spottedPerBattle:a.spottedPerBattle,tanks:p||[],tier:S()}),o=o?L.sum(o,a):a}),d.summary=o?L.accountAll(o):{}}async function h(o){var n;d.currentItem=o,await Ie(),(n=v.value)==null||n.doOpen()}function k(){var o;d.currentItem=null,(o=v.value)==null||o.doClose()}return(o,n)=>{var F;const a=ne,p=xe,S=st,m=de,C=ct,x=_e;return f(),w("div",to,[i("div",ao,[no,I(" "+R(r(d).items.length),1)]),i("div",so,[y(S,{headers:$,data:r(d).items,summary:r(d).summary,"scroll-auto-disabling":"","no-wrap":"","row-key":"timestamp","max-height":"375px",onSort:n[0]||(n[0]=E=>A("sort",E))},{index:T(({index:E})=>[I(R(E+1),1)]),date:T(({row:E})=>[y(a,{"is-text":"",onClick:U=>h(E)},{default:T(()=>[I(R(E.date),1)]),_:2},1032,["onClick"])]),tanks:T(({row:E})=>[I(R(E.tanks?o.$formatter.number.toInteger(E.tanks.length):"---"),1)]),winRate:T(({row:E})=>[y(p,{modelValue:E.winRate,"onUpdate:modelValue":U=>E.winRate=U,class:"account-daily-stat__win-rate"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["data","summary"])]),y(m,{loading:r(d).loading>0},null,8,["loading"]),y(x,{ref_key:"tanksDetailsRef",ref:v,width:"1280px",title:"Статистика за "+((F=r(d).currentItem)==null?void 0:F.date),onClosed:n[1]||(n[1]=E=>r(d).currentItem=null)},{footer:T(()=>[i("div",oo,[y(a,{onClick:k},{default:T(()=>[I(" Закрыть ")]),_:1})])]),default:T(()=>[r(d).currentItem?(f(),V(C,{key:0,tanks:r(b),"default-sort":_,"max-height":"calc(100vh - 200px)"},null,8,["tanks"])):P("",!0)]),_:1},8,["title"])])}}});var co="__lodash_hash_undefined__";function lo(t){return this.__data__.set(t,co),this}var ro=lo;function uo(t){return this.__data__.has(t)}var _o=uo,mo=Qt,fo=ro,po=_o;function ye(t){var l=-1,u=t==null?0:t.length;for(this.__data__=new mo;++l<u;)this.add(t[l])}ye.prototype.add=ye.prototype.push=fo;ye.prototype.has=po;var vo=ye;function ho(t,l){for(var u=-1,v=t==null?0:t.length;++u<v;)if(l(t[u],u,t))return!0;return!1}var ko=ho;function go(t,l){return t.has(l)}var yo=go,wo=vo,bo=ko,$o=yo,Ao=1,Ro=2;function To(t,l,u,v,d,_){var $=u&Ao,b=t.length,A=l.length;if(b!=A&&!($&&A>b))return!1;var e=_.get(t),s=_.get(l);if(e&&s)return e==l&&s==t;var h=-1,k=!0,o=u&Ro?new wo:void 0;for(_.set(t,l),_.set(l,t);++h<b;){var n=t[h],a=l[h];if(v)var p=$?v(a,n,h,l,t,_):v(n,a,h,t,l,_);if(p!==void 0){if(p)continue;k=!1;break}if(o){if(!bo(l,function(S,m){if(!$o(o,m)&&(n===S||d(n,S,u,v,_)))return o.push(m)})){k=!1;break}}else if(!(n===a||d(n,a,u,v,_))){k=!1;break}}return _.delete(t),_.delete(l),k}var lt=To;function Co(t){var l=-1,u=Array(t.size);return t.forEach(function(v,d){u[++l]=[d,v]}),u}var So=Co;function Io(t){var l=-1,u=Array(t.size);return t.forEach(function(v){u[++l]=v}),u}var Do=Io,qe=jt,Ne=Yt,Po=oa,Bo=lt,Oo=So,xo=Do,Mo=1,Uo=2,Vo="[object Boolean]",Eo="[object Date]",Lo="[object Error]",Fo="[object Map]",qo="[object Number]",No="[object RegExp]",jo="[object Set]",Ho="[object String]",Go="[object Symbol]",zo="[object ArrayBuffer]",Ko="[object DataView]",je=qe?qe.prototype:void 0,Ce=je?je.valueOf:void 0;function Wo(t,l,u,v,d,_,$){switch(u){case Ko:if(t.byteLength!=l.byteLength||t.byteOffset!=l.byteOffset)return!1;t=t.buffer,l=l.buffer;case zo:return!(t.byteLength!=l.byteLength||!_(new Ne(t),new Ne(l)));case Vo:case Eo:case qo:return Po(+t,+l);case Lo:return t.name==l.name&&t.message==l.message;case No:case Ho:return t==l+"";case Fo:var b=Oo;case jo:var A=v&Mo;if(b||(b=xo),t.size!=l.size&&!A)return!1;var e=$.get(t);if(e)return e==l;v|=Uo,$.set(t,l);var s=Bo(b(t),b(l),v,d,_,$);return $.delete(t),s;case Go:if(Ce)return Ce.call(t)==Ce.call(l)}return!1}var Xo=Wo,He=Zt,Jo=1,Qo=Object.prototype,Yo=Qo.hasOwnProperty;function Zo(t,l,u,v,d,_){var $=u&Jo,b=He(t),A=b.length,e=He(l),s=e.length;if(A!=s&&!$)return!1;for(var h=A;h--;){var k=b[h];if(!($?k in l:Yo.call(l,k)))return!1}var o=_.get(t),n=_.get(l);if(o&&n)return o==l&&n==t;var a=!0;_.set(t,l),_.set(l,t);for(var p=$;++h<A;){k=b[h];var S=t[k],m=l[k];if(v)var C=$?v(m,S,k,l,t,_):v(S,m,k,t,l,_);if(!(C===void 0?S===m||d(S,m,u,v,_):C)){a=!1;break}p||(p=k=="constructor")}if(a&&!p){var x=t.constructor,F=l.constructor;x!=F&&"constructor"in t&&"constructor"in l&&!(typeof x=="function"&&x instanceof x&&typeof F=="function"&&F instanceof F)&&(a=!1)}return _.delete(t),_.delete(l),a}var ei=Zo,Se=ea,ti=lt,ai=Xo,ni=ei,Ge=ta,ze=sa,Ke=aa,si=na,oi=1,We="[object Arguments]",Xe="[object Array]",he="[object Object]",ii=Object.prototype,Je=ii.hasOwnProperty;function ci(t,l,u,v,d,_){var $=ze(t),b=ze(l),A=$?Xe:Ge(t),e=b?Xe:Ge(l);A=A==We?he:A,e=e==We?he:e;var s=A==he,h=e==he,k=A==e;if(k&&Ke(t)){if(!Ke(l))return!1;$=!0,s=!1}if(k&&!s)return _||(_=new Se),$||si(t)?ti(t,l,u,v,d,_):ai(t,l,A,u,v,d,_);if(!(u&oi)){var o=s&&Je.call(t,"__wrapped__"),n=h&&Je.call(l,"__wrapped__");if(o||n){var a=o?t.value():t,p=n?l.value():l;return _||(_=new Se),d(a,p,u,v,_)}}return k?(_||(_=new Se),ni(t,l,u,v,d,_)):!1}var li=ci,ri=li,Qe=Ht;function rt(t,l,u,v,d){return t===l?!0:t==null||l==null||!Qe(t)&&!Qe(l)?t!==t&&l!==l:ri(t,l,u,v,rt,d)}var ui=rt,di=ui;function _i(t,l){return di(t,l)}var mi=_i;const fi=Gt(mi),pi={class:"account-tanks-filters"},vi={class:"account-tanks-filters__inner"},hi={class:"account-tanks-filters__list"},ki={style:{"font-weight":"500",width:"24px","text-align":"center"}},gi={key:0,class:"account-tanks-filters__item"},yi={class:"account-tanks-filters__item"},wi={class:"account-tanks-filters__item"},bi=j({__name:"AccountTanksFilters",props:{defaultFilters:{type:Object,default:null,required:!0},filters:{type:Object,default:null,required:!0},isPrivate:{type:[Boolean,String],default:!1,required:!0}},emits:["change","clear"],setup(t,{emit:l}){const u=t,v=["ussr","germany","usa","uk","japan","china","france","european","other"],d=[1,2,3,4,5,6,7,8,9,10].map(a=>({value:a,label:B.encyclopedia.tier(a)})),_=["lightTank","mediumTank","heavyTank","AT-SPG"],$=[{value:null,label:"Премиум: показать"},{value:!0,label:"Премиум: только"},{value:!1,label:"Премиум: спрятать"}],b=[{value:null,label:"В ангаре: все"},{value:1,label:"В ангаре: есть"},{value:0,label:"В ангаре: нет"}],A=M(()=>!fi(u.filters,u.defaultFilters)),e=l;function s(a){let p=u.filters.tankNation;p.includes(a)?p=p.filter(S=>S!==a):p.push(a),e("change",{...u.filters,tankNation:p})}function h(a){let p=u.filters.tankTire;p.includes(a)?p=p.filter(S=>S!==a):p.push(a),e("change",{...u.filters,tankTire:p})}function k(a){let p=u.filters.tankType;p.includes(a)?p=p.filter(S=>S!==a):p.push(a),e("change",{...u.filters,tankType:p})}function o(a){e("change",{...u.filters,tankInGarage:a})}function n(a){e("change",{...u.filters,tankIsPremium:a})}return(a,p)=>{const S=it,m=le,C=be,x=Kt,F=we,E=ne;return f(),w("div",pi,[i("div",vi,[i("ul",hi,[i("li",{class:J(["account-tanks-filters__item",["account-tanks-filters__item--overflow"]])},[(f(),w(G,null,Q(v,U=>y(m,{key:U,"model-value":t.filters.tankNation.includes(U),class:"account-tanks-filters__btn",title:a.$formatter.encyclopedia.nation(U),onChange:Z=>s(U)},{default:T(()=>[y(S,{"model-value":U},null,8,["model-value"])]),_:2},1032,["model-value","title","onChange"])),64))]),i("li",{class:J(["account-tanks-filters__item",["account-tanks-filters__item--overflow"]])},[(f(),w(G,null,Q(_,U=>y(m,{key:U,"model-value":t.filters.tankType.includes(U),class:"account-tanks-filters__btn",title:"Тип",onChange:Z=>k(U)},{default:T(()=>[y(C,{"model-value":U},{default:T(()=>[I(" /> ")]),_:2},1032,["model-value"])]),_:2},1032,["model-value","onChange"])),64))]),i("li",{class:J(["account-tanks-filters__item",["account-tanks-filters__item--overflow"]])},[(f(!0),w(G,null,Q(r(d),U=>(f(),V(m,{key:U.value,"model-value":t.filters.tankTire.includes(U.value),class:"account-tanks-filters__btn",title:"Уровень "+U,onChange:Z=>h(U.value)},{default:T(()=>[i("span",ki,R(U.label),1)]),_:2},1032,["model-value","title","onChange"]))),128))]),t.isPrivate?(f(),w("li",gi,[y(x,{"model-value":t.filters.tankInGarage,options:b,onChange:o},null,8,["model-value"])])):P("",!0),i("li",yi,[y(x,{"model-value":t.filters.tankIsPremium,options:$,onChange:n},null,8,["model-value"])]),i("li",wi,[y(E,{title:"Очистить фильтры",disabled:!r(A),onClick:p[0]||(p[0]=U=>e("clear"))},{default:T(()=>[y(F,{name:"clear"})]),_:1},8,["disabled"])])])])])}}}),$i={key:0,class:"account-tank"},Ai={class:"account-tank__header"},Ri={class:"account-tank__img-wrapper"},Ti={class:"account-tank__tier"},Ci={class:"account-tank__props"},Si={class:"account-tank__prop"},Ii=i("span",{class:"account-tank__prop-name"}," Нация: ",-1),Di={class:"account-tank__prop"},Pi=i("span",{class:"account-tank__prop-name"}," Последний бой: ",-1),Bi=i("h4",null,"Статистика",-1),Oi=i("h4",null,"Достижения",-1),xi=j({__name:"AccountTank",props:{tank:{type:Object,default:()=>({}),required:!0},tankDiff:{type:Object,default:null,required:!0},achievementsInfo:{type:Object,default:()=>({}),required:!0}},setup(t){const l=["battles","winRate","damagePerBattle","surviveRate","fragPerBattle","winsInPlatoon"],u=t,v=Y({showAllMetrics:!1,filters:Jt()}),d=M(()=>{const $=se.tank({tank:u.tank,tankDiff:u.tankDiff});return v.showAllMetrics?$:$.filter(b=>l.includes(b.key))});function _($){v.filters=$}return($,b)=>{var o;const A=Oe,e=be,s=le,h=at,k=ot;return t.tank?(f(),w("div",$i,[i("div",Ai,[i("div",Ri,[y(A,{class:"account-tank__img account-tank__img--nation",alt:"tank.nation",src:`/img/nations/nation-${t.tank.nation}.svg`},null,8,["src"]),y(A,{class:"account-tank__img account-tank__img--tank",alt:t.tank.name,src:(o=t.tank.images)==null?void 0:o.preview},null,8,["alt","src"]),y(e,{size:28,class:"account-tank__type","model-value":t.tank.type,"is-premium":t.tank.is_premium,"is-collectible":t.tank.is_collectible},null,8,["model-value","is-premium","is-collectible"]),i("div",Ti,R($.$formatter.encyclopedia.tier(t.tank.tier)),1)]),i("div",Ci,[i("div",Si,[Ii,I(" "+R($.$formatter.encyclopedia.nation(t.tank.nation)),1)]),i("div",Di,[Pi,I(" "+R($.$formatter.date.toDateTime(t.tank.last_battle_time*1e3)),1)])])]),Bi,y(s,{modelValue:r(v).showAllMetrics,"onUpdate:modelValue":b[0]||(b[0]=n=>r(v).showAllMetrics=n),class:"account-tank__show-all-metrics"},{default:T(()=>[I(" Все показатели ")]),_:1},8,["modelValue"]),y(h,{items:r(d)},null,8,["items"]),Oi,y(k,{achievements:t.tank.achievements,"achievements-info":t.achievementsInfo,filters:r(v).filters,onFiltersChanged:_},null,8,["achievements","achievements-info","filters"])])):P("",!0)}}}),Mi={key:0,class:"account-view"},Ui={class:"account-view__private"},Vi={key:1,class:"account-view--no-data"},Ei=i("div",{class:"content-area"},[i("p",null,"Нет данных."),i("p",null,"Возможно аккаунт удалён.")],-1),Li=[Ei],Fi={style:{display:"flex","justify-content":"flex-end"}},lc=j({__name:"AccountView",setup(t){const l=z(null),u=z(null),v=nt.makeAccountFilters({tankInGarage:1,tankIsPremium:null}),d=Lt(),_=ia(),$=ca(),b={order:"desc",prop:"last_battle_time"},A=Y(ee(b)),e=Y({tanks:[],tanksDiff:[],tanksSessions:[],tanksSnapshot:[],tanksTableItems:[],sessionUpdateAt:0,sessionActive:!1,currentTank:null,currentTankDiff:null,loading:0,filters:ee(v),accountRaw:null,accountRawSnapshot:null,accountAchievementsRaw:null,accountAchievementsRawSnapshot:null,tanksRaw:null,tanksRawSnapshot:null,tanksAchievementsRaw:null,tanksAchievementsRawSnapshot:null}),s=M(()=>$.vehicles),h=M(()=>$.achievements),k=M(()=>{var c;return _.accountId===((c=e.accountRaw)==null?void 0:c.account_id)}),o=M(()=>Number(d.params.id)||_.accountId),n=M(()=>!e.accountAchievementsRaw||!e.accountAchievementsRawSnapshot||!h.value?null:L.accountAchievementsDiff(e.accountAchievementsRaw,e.accountAchievementsRawSnapshot,h.value)),a=M(()=>e.sessionActive?n.value:e.accountAchievementsRaw),p=M(()=>{if(!e.accountRaw)return null;const c=e.accountRaw.statistics.all,g=e.accountRaw.statistics.rating;return{...e.accountRaw,statistics:{all:L.accountAll(c),rating:g?L.accountRating(g):null}}}),S=M(()=>{if(!e.accountRaw||!e.accountRawSnapshot)return null;const c=e.accountRaw.statistics.all,g=e.accountRaw.statistics.rating,D=e.accountRawSnapshot.statistics.all,O=e.accountRawSnapshot.statistics.rating;return{...e.accountRaw,statistics:{all:L.accountAll(L.diff(c,D)),rating:g&&O?L.accountRating(L.diff(g,O)):null}}}),m=M(()=>{if(!e.accountRaw||!e.accountRawSnapshot)return null;const c=e.accountRaw.statistics.all,g=e.accountRaw.statistics.rating,D=e.accountRawSnapshot.statistics.all,O=e.accountRawSnapshot.statistics.rating,H=L.diff(L.accountAll(c),L.accountAll(D)),N=g&&O?L.diff(L.accountRating(g),L.accountRating(O)):null;return{...e.accountRaw,statistics:{all:H,rating:N}}}),C=M(()=>{var c,g,D,O;return!p.value||!S.value||!a.value?se.account():e.sessionActive?se.account({stat:(c=S.value)==null?void 0:c.statistics.all,achievements:n.value,tanks:e.tanksSessions,createAt:new Date(e.sessionUpdateAt).valueOf()}):se.account({stat:(g=p.value)==null?void 0:g.statistics.all,statDiff:(D=m.value)==null?void 0:D.statistics.all,achievements:e.accountAchievementsRaw,achievementsDiff:n.value,tanks:e.tanks,tanksDiff:e.tanksDiff.filter(H=>H.all.battles),createAt:((O=p.value)==null?void 0:O.created_at)*1e3,createAtSnapshot:new Date(e.sessionUpdateAt).valueOf()})}),x=M(()=>{var c,g,D;return!p.value||!S.value?se.accountRating():e.sessionActive?se.accountRating({stat:(c=S.value)==null?void 0:c.statistics.rating}):se.accountRating({stat:(g=S.value)==null?void 0:g.statistics.rating,diff:(D=m.value)==null?void 0:D.statistics.rating})}),F=M(()=>e.filters.battleMode==="random"?C.value:x.value);Ee(()=>e.sessionActive,()=>{me(e.filters)}),Ee(()=>e.filters,async()=>{var c;Me(e.filters),await Ie(),(c=l.value)==null||c.sortItems()}),Be(async()=>{await $e()});function E(){var c;return((c=e.tanksRaw)==null?void 0:c.map(g=>{var O,H;const D=(O=e.tanksAchievementsRaw)==null?void 0:O.find(N=>N.tank_id===g.tank_id);return ie.accountTank(g,((H=s.value)==null?void 0:H[g.tank_id])??null,D??null)}))??[]}function U(){var c;return((c=e.tanksRawSnapshot)==null?void 0:c.map(g=>{var O,H;const D=(O=e.tanksAchievementsRawSnapshot)==null?void 0:O.find(N=>N.tank_id===g.tank_id);return ie.accountTank(g,((H=s.value)==null?void 0:H[g.tank_id])??null,D??null)}))??[]}function Z(c,g=!1){var ce,fe,pe;const D=((ce=e.tanksAchievementsRaw)==null?void 0:ce.find(re=>re.tank_id===c.tank_id))??null,O=((fe=e.tanksAchievementsRawSnapshot)==null?void 0:fe.find(re=>re.tank_id===c.tank_id))??null,H=D&&O?L.tankAchievementsDiff(D,O):null,N=((pe=s.value)==null?void 0:pe[c.tank_id])??null;return ie.accountTank(c,N,g?D:H)}function K(){var c;return((c=e.tanksRaw)==null?void 0:c.reduce((g,D)=>{var N;const O=(N=e.tanksRawSnapshot)==null?void 0:N.find(ce=>ce.tank_id===D.tank_id);if(!O)return g.push(Z(D,!0)),g;if(D.all.battles===O.all.battles)return g;const H=D.battle_life_time-O.battle_life_time;return g.push(Z({...D,battle_life_time:H,all:L.diff(D.all,O.all)})),g},[]))??[]}function ut(){return e.tanks.map(c=>{const g=e.tanksSnapshot.find(O=>c.tank_id===O.tank_id);if(!g)return c;const D=c.battle_life_time-g.battle_life_time;return{...c,all:L.diff(c.all,g.all),battle_life_time:D,achievements:L.tankAchievementsDiff(c.achievements,g.achievements)}})}function dt(){e.tanks=E(),e.tanksSnapshot=U(),e.tanksSessions=K(),e.tanksDiff=ut()}async function _t(c){e.loading++;try{const{data:g}=await oe.tanks.getAchievements({account_id:c});e.tanksAchievementsRaw=g[c]??null}catch(g){q(g,{title:"Получение достижений по технике игрока"})}e.loading--}async function mt(c){e.loading++;try{const{data:g}=await oe.account.getAchievements({account_id:c});e.accountAchievementsRaw=g[c]??null}catch(g){q(g,{title:"Получение достижений по аккаунту игрока"})}e.loading--}async function ft(c){e.loading++;try{const{data:g}=await oe.account.getInfo({account_id:c,extra:"statistics.rating"});e.accountRaw=(g==null?void 0:g[c])??null}catch(g){q(g,{title:"Получение данных аккаунта"})}e.loading--}async function pt(c){s.value||await ht(),await vt(c)}async function vt(c){e.loading++;try{const{data:g}=await oe.tanks.getStats({account_id:c});e.tanksRaw=g?g[c]:null}catch(g){q(g,{title:"Получение статистики по технике игрока"})}e.loading--}async function ht(){if(!s.value){e.loading++;try{await $.getTanksVehicles()}catch(c){q(c,{title:"Получение данных описания техники"})}e.loading--}}async function kt(){if(!h.value){e.loading++;try{await $.getAchievements()}catch(c){q(c,{title:"Получение описания достижений"})}e.loading--}}async function $e(c=!1){var g;o.value&&(await Promise.all([kt(),ft(o.value),pt(o.value),_t(o.value),mt(o.value)]),c||await St(),(c||!e.accountRawSnapshot)&&await It(),dt(),Me(e.filters),await Ie(),(g=l.value)==null||g.sortItems())}function Me(c){let g=e.sessionActive?e.tanksSessions:e.tanks;c.tankInGarage!==null&&(g=g.filter(D=>typeof D.in_garage!="boolean"?!0:D.in_garage===(c.tankInGarage===1))),c.tankNation.length&&(g=g.filter(D=>c.tankNation.includes(D.nation))),c.tankTire.length&&(g=g.filter(D=>c.tankTire.includes(D.tier))),g=g.filter(D=>{const O=c.tankIsPremium;return O===!0?D.is_premium:O===!1?!D.is_premium:!0}),c.tankType.length&&(g=g.filter(D=>c.tankType.includes(D.type))),e.tanksTableItems=g}function me(c){e.filters=ee(c)}function gt(){e.filters=ee(v)}async function yt(){if(e.accountRaw){e.loading++;try{const c=await W.indexedDB.accountsInfo.get(e.accountRaw.account_id);e.accountRawSnapshot=(c==null?void 0:c.data)??null,e.sessionUpdateAt=(c==null?void 0:c.timestamp)??0}catch(c){q(c,{title:"Загрузка локальных данных аккаунта"})}e.loading--}}async function wt(){if(e.accountRaw){e.loading++;try{await W.indexedDB.accountsInfo.set(e.accountRaw.account_id,ve(e.accountRaw)),e.accountRawSnapshot=ee(e.accountRaw),e.sessionUpdateAt=Date.now()}catch(c){q(c,{title:"Сохранение локальных данных аккаунта"})}e.loading--}}async function bt(){if(e.accountRaw){e.loading++;try{const c=await W.indexedDB.accountsAchievements.get(e.accountRaw.account_id);e.accountAchievementsRawSnapshot=(c==null?void 0:c.data)??null,e.sessionUpdateAt=(c==null?void 0:c.timestamp)??0}catch(c){q(c,{title:"Загрузка локальных данных достижений аккаунта"})}e.loading--}}async function $t(){if(!(!e.accountRaw||!e.accountAchievementsRaw)){e.loading++;try{await W.indexedDB.accountsAchievements.set(e.accountRaw.account_id,ve(e.accountAchievementsRaw)),e.accountAchievementsRawSnapshot=ee(e.accountAchievementsRaw)}catch(c){q(c,{title:"Сохранение локальных данных достижений аккаунта"})}e.loading--}}async function At(){if(e.accountRaw){e.loading++;try{const c=await W.indexedDB.tanksStat.get(e.accountRaw.account_id);e.tanksRawSnapshot=(c==null?void 0:c.data)??null}catch(c){q(c,{title:"Загрузка локальных данных техники"})}e.loading--}}async function Rt(){if(!(!e.accountRaw||!e.tanksRaw)){e.loading++;try{await W.indexedDB.tanksStat.set(e.accountRaw.account_id,ve(e.tanksRaw)),e.tanksRawSnapshot=ee(e.tanksRaw),e.sessionUpdateAt=Date.now()}catch(c){q(c,{title:"Сохранение локальных данных техники"})}e.loading--}}async function Tt(){if(e.accountRaw){e.loading++;try{const c=await W.indexedDB.tanksAchievements.get(e.accountRaw.account_id);e.tanksAchievementsRawSnapshot=(c==null?void 0:c.data)??null}catch(c){q(c,{title:"Загрузка локальных данных достижений техники"})}e.loading--}}async function Ct(){if(!(!e.accountRaw||!e.tanksAchievementsRaw)){e.loading++;try{await W.indexedDB.tanksAchievements.set(e.accountRaw.account_id,ve(e.tanksAchievementsRaw)),e.tanksAchievementsRawSnapshot=ee(e.tanksAchievementsRaw),e.sessionUpdateAt=Date.now()}catch(c){q(c,{title:"Сохранение локальных данных достижений техники"})}e.loading--}}async function St(){await Promise.all([yt(),bt(),At(),Tt()])}async function It(){await Promise.all([wt(),$t(),Rt(),Ct()])}async function Dt(){await $e(!0)}function Pt(){$e()}function Bt(c){var g;e.sessionActive?(e.currentTank=e.tanksSessions.find(D=>c===D.tank_id)??null,e.currentTankDiff=null):(e.currentTank=e.tanks.find(D=>c===D.tank_id)??null,e.currentTankDiff=e.tanksDiff.find(D=>c===D.tank_id)??null),(g=u.value)==null||g.doOpen()}return(c,g)=>{var Ue;const D=xa,O=Ln,H=Jn,N=Xt,ce=as,fe=ot,pe=Us,re=io,Ot=bi,xt=ct,Mt=xi,Ut=ne,Vt=_e;return f(),w(G,null,[r(e).accountRaw?(f(),w("div",Mi,[y(N,{identity:"preview"},{default:T(()=>[i("div",Ui,[r(e).accountRaw.private?(f(),V(D,{key:0,resources:r(e).accountRaw.private},null,8,["resources"])):P("",!0)]),y(O,{loading:r(e).loading>0,class:"account-view__preview",account:r(e).accountRaw},null,8,["loading","account"]),y(H,{modelValue:r(e).sessionActive,"onUpdate:modelValue":g[0]||(g[0]=Ae=>r(e).sessionActive=Ae),class:"account-view__session",loading:r(e).loading>0,"update-at":r(e).sessionUpdateAt,onReset:Dt,onUpdate:Pt},null,8,["modelValue","loading","update-at"])]),_:1}),y(N,{title:"Статистика",identity:"statistic"},{default:T(()=>[y(ce,{filters:r(e).filters,metrics:r(F),loading:r(e).loading>0,onFilters:me},null,8,["filters","metrics","loading"])]),_:1}),Re(y(N,{title:"Достижения",identity:"achievements"},{default:T(()=>[r(a)?(f(),V(fe,{key:0,filters:r(e).filters,"achievements-info":r(h),achievements:r(a),onFiltersChanged:me},null,8,["filters","achievements-info","achievements"])):P("",!0)]),_:1},512),[[Te,r(e).filters.battleMode==="random"]]),!r(e).sessionActive&&r(e).filters.battleMode==="random"?(f(),V(N,{key:0,title:"Инфографика",identity:"tanksBattles"},{default:T(()=>[y(pe,{tanks:r(e).tanks},null,8,["tanks"])]),_:1})):P("",!0),r(e).sessionActive?P("",!0):Re((f(),V(N,{key:1,title:"Статистика по дням",identity:"dailyStat"},{default:T(()=>[r(s)?(f(),V(re,{key:0,vehicles:r(s),"account-id":r(e).accountRaw.account_id},null,8,["vehicles","account-id"])):P("",!0)]),_:1},512)),[[Te,r(e).filters.battleMode==="random"]]),Re(y(N,{title:"Техника",identity:"tanks"},{default:T(()=>[y(Ot,{class:"account-view__filters",filters:r(e).filters,"default-filters":r(v),"is-private":r(k),onChange:me,onClear:gt},null,8,["filters","default-filters","is-private"]),y(xt,{ref_key:"tableRef",ref:l,sort:r(A),loading:r(e).loading>0,"default-sort":b,tanks:r(e).tanksTableItems,"tanks-diff":r(e).tanksDiff,"achievements-info":r(h),"show-diff":!r(e).sessionActive,height:"calc(100vh - 112px)",onRowClick:Bt},null,8,["sort","loading","tanks","tanks-diff","achievements-info","show-diff"])]),_:1},512),[[Te,r(e).filters.battleMode==="random"]])])):(f(),w("div",Vi,Li)),y(Vt,{ref_key:"tankDetailsRef",ref:u,width:"1100px",title:(Ue=r(e).currentTank)==null?void 0:Ue.name,onClosed:g[2]||(g[2]=Ae=>r(e).currentTank=null)},{footer:T(()=>[i("div",Fi,[y(Ut,{onClick:g[1]||(g[1]=Ae=>{var Ve;return(Ve=r(u))==null?void 0:Ve.doClose()})},{default:T(()=>[I(" Закрыть ")]),_:1})])]),default:T(()=>[r(h)&&r(e).currentTank?(f(),V(Mt,{key:0,tank:r(e).currentTank,"tank-diff":r(e).currentTankDiff,"achievements-info":r(h)},null,8,["tank","tank-diff","achievements-info"])):P("",!0)]),_:1},8,["title"])],64)}}});export{lc as _};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./light-tank.0FpbGRyM.js","./nuxt-icon.C5s37704.js","./_plugin-vue_export-helper.DlAUqK2U.js","./entry.D9s_uxMW.js","./nuxt-icon.MfBulapQ.css","./medium-tank.C8Xfa10G.js","./heavy-tank.NLDMsSXw.js","./at-spg.Cr195pSX.js","./3.XhRRpd5g.js","./2.vmKmz7-z.js","./1.Bn0oN55v.js","./М.Ctku0SIs.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
