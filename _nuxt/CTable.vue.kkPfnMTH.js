import{t as k,d as V,_ as L}from"./disableScroll.CgQQwGmz.js";import{f as x,r as M,n as R,R as W,q as G,y as Q,o as d,c as u,G as v,m as _,a as y,F as A,A as C,k as j,C as S,K as $,Q as U,d as N,t as T,b as q}from"./entry.DxBPLwvI.js";function J(o,w,l){const h=[],a={...o};if(typeof a.target=="string"){const n=document.querySelectorAll(a.target);Array.prototype.forEach.call(n,b=>{h.push(b)})}else Array.isArray(a.target)&&a.target.forEach(n=>{h.push(n)});const f=new IntersectionObserver(n=>{n.forEach(b=>{const{target:g,isIntersecting:m}=b;a.visibleClassName&&g.classList[m?"add":"remove"](a.visibleClassName),a.hiddenSelector&&g.classList[m?"remove":"add"](a.hiddenSelector),typeof l=="function"&&l(b),o.once&&m&&f.unobserve(g)})},w);return h.forEach(n=>f.observe(n)),f}const P={key:0,class:"c-table__header"},X={class:"c-table__table"},Y={class:"c-table__head"},Z={class:"c-table__head-row"},ee={class:"c-table__sort"},te=["title","onClick"],se={key:0,class:"c-table__sort-icons"},re={key:0,class:"c-table__summary"},ae={class:"c-table__body"},oe=["onClick"],ie={key:0,class:"c-table__no-data"},le={key:1,class:"c-table__footer"},de=x({__name:"CTable",props:{data:{type:Array,required:!0,default:()=>[]},headers:{type:Array,required:!0,default:()=>[]},summary:{type:Object,default:void 0},defaultSort:{type:Object,default:void 0},noWrap:Boolean,scrollAutoDisabling:Boolean,scrollToTop:Boolean,isFixed:Boolean,height:{type:String,default:void 0},rowKey:{type:String,default:void 0},maxHeight:{type:String,default:void 0},minHeight:{type:String,default:void 0}},emits:["sort","row-click"],setup(o,{emit:w}){var I,O;const l=o,h=M(),a=R({order:((I=l.defaultSort)==null?void 0:I.order)??"asc",prop:((O=l.defaultSort)==null?void 0:O.prop)??""}),f=M([]);W(()=>{var c;const{data:e,headers:s,defaultSort:r}=l;if(!e)return;f.value=e;const t=s==null?void 0:s.find(i=>i.key===(r==null?void 0:r.prop));t&&F(t),k(l.scrollToTop)&&((c=h.value)==null||c.scrollTo({top:0}))});let n=null;function b(){n=J({target:".c-table__scroll",visibleClassName:"c-table__scroll--in-view"},{rootMargin:"0%",threshold:1},e=>{const s=e.target;e.isIntersecting?V(!1,s):(V(!0,s),s.scrollTo({top:0}))})}function g(){n==null||n.disconnect()}G(()=>{k(l.scrollAutoDisabling)&&b()}),Q(()=>{k(l.scrollAutoDisabling)&&g()});const m=e=>({textAlign:e.align,width:Number(e.width)?`${e.width}px`:"auto"}),B=(e="default")=>!!U()[e];function F(e){const{prop:s,order:r}=a;typeof e.sortMethod=="function"?f.value.sort((t,c)=>{var i,p;return r==="desc"?((i=e.sortMethod)==null?void 0:i.call(e,c,t))||0:((p=e.sortMethod)==null?void 0:p.call(e,t,c))||0}):e.sortable===!0&&f.value.sort((t,c)=>{const i=(r==="desc"?c:t)[s],p=(r==="desc"?t:c)[s];return String(i).localeCompare(String(p),void 0,{numeric:!0,sensitivity:"base"})})}const E=w;function z(e){if(!e.sortable)return;let s=e.key,r=a.order;a.prop!==s&&(r=""),r?r==="asc"?r="desc":(r="",s=""):r="asc",a.order=r,a.prop=s,r&&F(e),E("sort",{...a,column:e})}function D(e,s){return typeof e.formatter=="function"?e.formatter(s):s}function H(e,s){return a.order===e&&a.prop===s}function K(e){return typeof l.summary!="object"||!Object.keys(l.summary).includes(e.key)?"":typeof e.formatter=="function"?e.formatter(l.summary[e.key]):l.summary[e.key]}return(e,s)=>{const r=L;return d(),u("div",{class:S(["c-table",[o.noWrap?"c-table--no-wrap":""]]),style:$({height:o.height,maxHeight:o.maxHeight,minHeight:o.minHeight,tableLayout:("toFlag"in e?e.toFlag:j(k))(o.isFixed)?"fixed":"auto"})},[B("header")?(d(),u("div",P,[v(e.$slots,"header")])):_("",!0),y("div",{ref_key:"tableScrollRef",ref:h,class:"c-table__scroll"},[y("table",X,[y("thead",Y,[y("tr",Z,[(d(!0),u(A,null,C(o.headers,t=>(d(),u("th",{key:t.key,style:$(m(t)),class:"c-table__cell c-table__cell--header"},[y("div",ee,[y("button",{title:t.tooltip,class:S(["c-table__sort-btn",[t.sortable?"c-table__sort-btn--has-sort":""]]),onClick:c=>z(t)},[v(e.$slots,`${t.key}-header`,{},()=>[N(T(t.label),1)])],10,te),t.sortable?(d(),u("span",se,[q(r,{size:"16",name:"arrow-up",class:S(["c-table__sort-icon",[H("asc",t.key)?"is-active":""]])},null,8,["class"]),q(r,{size:"16",name:"arrow-down",class:S(["c-table__sort-icon",[H("desc",t.key)?"is-active":""]])},null,8,["class"])])):_("",!0)]),o.summary?(d(),u("div",re,[v(e.$slots,`${t.key}-summary`,{},()=>[N(T(K(t)),1)])])):_("",!0)],4))),128))])]),y("tbody",ae,[(d(!0),u(A,null,C(j(f),(t,c)=>(d(),u("tr",{key:String(o.rowKey?t[o.rowKey]:c),class:"c-table__row",onClick:i=>E("row-click",t)},[(d(!0),u(A,null,C(o.headers,i=>(d(),u("td",{key:i.key,class:"c-table__cell",style:$(m(i))},[t?v(e.$slots,`${i.key}`,{key:0,row:t,data:t[i.key],index:c},()=>[N(T(D(i,t[i.key])),1)]):_("",!0)],4))),128))],8,oe))),128))])]),Array.isArray(o.data)&&o.data.length?_("",!0):(d(),u("div",ie," Нет данных "))],512),B("footer")?(d(),u("div",le,[v(e.$slots,"footer")])):_("",!0)],6)}}});export{de as _};
