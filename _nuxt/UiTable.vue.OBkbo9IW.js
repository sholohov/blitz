import{t as v,d as I,_ as R}from"./disableScroll.hpPPipax.js";import{f as U,r as V,n as W,L as G,q as J,y as P,o as u,c as d,G as _,m as g,a as m,K as S,k as L,F as C,A as $,C as w,M as Q,d as x,t as M,b as O}from"./entry.DWOI7LAu.js";function X(r){const b=[],c={root:null,threshold:0,rootMargin:"0px 0px 0px 0px",...r};if(typeof c.target=="string"){const n=document.querySelectorAll(c.target);Array.prototype.forEach.call(n,l=>{b.push(l)})}else Array.isArray(c.target)?c.target.forEach(n=>{b.push(n)}):b.push(c.target);const s=new IntersectionObserver(n=>{n.forEach(l=>{const{target:y,isIntersecting:h}=l;c.visibleClassName&&y.classList[h?"add":"remove"](c.visibleClassName),c.hiddenSelector&&y.classList[h?"remove":"add"](c.hiddenSelector),typeof r.callback=="function"&&r.callback(l),r.once&&h&&s.unobserve(y)})},{root:r.root,rootMargin:r.rootMargin,threshold:r.threshold});return b.forEach(n=>s.observe(n)),s}const Y={key:0,class:"ui-table__header"},Z={class:"ui-table__head"},ee={class:"ui-table__head-row"},te={class:"ui-table__sort"},re=["title","onClick"],ae={key:0,class:"ui-table__sort-icons"},se={key:0,class:"ui-table__summary"},oe={class:"ui-table__body"},le=["onClick"],ie={key:0,class:"ui-table__no-data"},ne={key:1,class:"ui-table__footer"},ce=U({__name:"UiTable",props:{data:{type:Array,required:!0,default:()=>[]},headers:{type:Array,required:!0,default:()=>[]},summary:{type:Object,default:void 0},defaultSort:{type:Object,default:void 0},noWrap:Boolean,scrollAutoDisabling:Boolean,scrollToTop:Boolean,isFixed:Boolean,height:{type:String,default:void 0},rowKey:{type:String,default:void 0},maxHeight:{type:String,default:void 0},minHeight:{type:String,default:void 0}},emits:["sort","row-click"],setup(r,{expose:b,emit:c}){var E,H;const s=r,n=V(),l=W({order:((E=s.defaultSort)==null?void 0:E.order)??"",prop:((H=s.defaultSort)==null?void 0:H.prop)??""}),y=V([]);G(()=>{var e;y.value=s.data,A(),v(s.scrollToTop)&&((e=n.value)==null||e.scrollTo({top:0}))});let h=null;function j(){n.value&&(h=X({target:[n.value],visibleClassName:"ui-table__scroll--in-view",threshold:1,callback(e){const o=e.target;e.isIntersecting?I(!1,o):(I(!0,o),o.scrollTo({top:0}))}}))}J(()=>{v(s.scrollAutoDisabling)&&j()}),P(()=>{v(s.scrollAutoDisabling)&&(h==null||h.disconnect())});const N=e=>({textAlign:e.align,width:Number(e.width)?`${e.width}px`:"auto"}),T=(e="default")=>!!Q()[e];function A(){var t;let e=l.order,o=l.prop;e===""&&s.defaultSort&&(e=s.defaultSort.order,o=s.defaultSort.prop);const a=(t=s.headers)==null?void 0:t.find(f=>f.key===o);a&&(typeof a.sortMethod=="function"?y.value.sort((f,i)=>{var k,p;return e==="desc"?((k=a.sortMethod)==null?void 0:k.call(a,i,f))||0:((p=a.sortMethod)==null?void 0:p.call(a,f,i))||0}):a.sortable===!0&&y.value.sort((f,i)=>{const k=(e==="desc"?i:f)[o],p=(e==="desc"?f:i)[o];return String(k).localeCompare(String(p),void 0,{numeric:!0,sensitivity:"base"})}))}const B=c;function q(e){let o=e.key,a=l.order;l.prop!==o&&(a=""),a?a==="asc"?a="desc":(a="",o=""):a="asc",l.order=a,l.prop=o}function z(e){e.sortable&&(q(e),A(),B("sort",{...l,column:e}))}function D(e,o){return typeof e.formatter=="function"?e.formatter(o):o}function F(e,o){return l.order===e&&l.prop===o}function K(e){return typeof s.summary!="object"||!Object.keys(s.summary).includes(e.key)?"":typeof e.formatter=="function"?e.formatter(s.summary[e.key]):s.summary[e.key]}return b({sortItems:A}),(e,o)=>{const a=R;return u(),d("div",{class:w(["ui-table",[r.noWrap?"ui-table--no-wrap":""]]),style:S({height:r.height,maxHeight:r.maxHeight,minHeight:r.minHeight})},[T("header")?(u(),d("div",Y,[_(e.$slots,"header")])):g("",!0),m("div",{ref_key:"tableScrollRef",ref:n,class:"ui-table__scroll"},[m("table",{class:"ui-table__table",style:S({tableLayout:("toFlag"in e?e.toFlag:L(v))(r.isFixed)?"fixed":"auto"})},[m("thead",Z,[m("tr",ee,[(u(!0),d(C,null,$(r.headers,t=>(u(),d("th",{key:t.key,style:S(N(t)),class:"ui-table__cell ui-table__cell--header"},[m("div",te,[m("button",{title:t.tooltip,class:w(["ui-table__sort-btn",[t.sortable?"ui-table__sort-btn--has-sort":""]]),onClick:f=>z(t)},[_(e.$slots,`${t.key}-header`,{},()=>[x(M(t.label),1)])],10,re),t.sortable?(u(),d("span",ae,[O(a,{size:"16",name:"arrow-up",class:w(["ui-table__sort-icon",[F("asc",t.key)?"is-active":""]])},null,8,["class"]),O(a,{size:"16",name:"arrow-down",class:w(["ui-table__sort-icon",[F("desc",t.key)?"is-active":""]])},null,8,["class"])])):g("",!0)]),r.summary?(u(),d("div",se,[_(e.$slots,`${t.key}-summary`,{},()=>[x(M(K(t)),1)])])):g("",!0)],4))),128))])]),m("tbody",oe,[(u(!0),d(C,null,$(L(y),(t,f)=>(u(),d("tr",{key:String(r.rowKey?t[r.rowKey]:f),class:"ui-table__row",onClick:i=>B("row-click",t)},[(u(!0),d(C,null,$(r.headers,i=>(u(),d("td",{key:i.key,class:"ui-table__cell",style:S(N(i))},[t?_(e.$slots,`${i.key}`,{key:0,row:t,data:t[i.key],index:f},()=>[x(M(D(i,t[i.key])),1)]):g("",!0)],4))),128))],8,le))),128))])],4),Array.isArray(r.data)&&r.data.length?g("",!0):(u(),d("div",ie," Нет данных "))],512),T("footer")?(u(),d("div",ne,[_(e.$slots,"footer")])):g("",!0)],6)}}});export{ce as _,X as i};
