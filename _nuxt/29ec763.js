(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{696:function(e,t,n){var content=n(750);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(68).default)("1520657c",content,!0,{sourceMap:!1})},731:function(e,t,n){"use strict";n.r(t);n(37),n(72);var r=n(13),o=n(32),c=n(33),l=n(35),f=n(36),h=n(23),d=n(20),v=(n(43),n(3),n(1),n(50),n(51),n(15)),m=n(114),y=n(94),w=n(53),x=n(105),_=n(152);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var o=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var R=function(e,t,n,desc){var r,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(d.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(c=(o<3?r(c):o>3?r(t,n,c):r(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c},O=function(e){Object(l.a)(m,e);var t,n,f,h,d,v=k(m);function m(){var e;return Object(o.a)(this,m),(e=v.apply(this,arguments)).user=x.a.user(),e.notify=x.a.notify(),e}return Object(c.a)(m,[{key:"logged",get:function(){return 0!==this.user.accountId}},{key:"isTablet",get:function(){return x.a.breakpoints().isTablet||this.$device.isTablet||this.$device.isMobile}},{key:"login",value:(d=Object(r.a)(regeneratorRuntime.mark((function e(){var t,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.auth.login({redirect_uri:location.href,nofollow:1});case 3:t=e.sent,(data=t.data)&&(window.location.href=data.location),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),this.notify.add({type:"error",title:"Вход в аккаунт",message:e.t0 instanceof Error?null===e.t0||void 0===e.t0?void 0:e.t0.message:"Неизвестная ошибка"});case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return d.apply(this,arguments)})},{key:"logoutOriginal",value:(h=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.auth.logout(t);case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0),this.notify.add({type:"error",title:"Вход из аккаунта",message:e.t0 instanceof Error?null===e.t0||void 0===e.t0?void 0:e.t0.message:"Неизвестная ошибка"});case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e){return h.apply(this,arguments)})},{key:"logoutSelf",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.b.auth.logout(t);case 3:w.a.storage.removeUser(),this.user.resetUser(),location.assign("/"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),this.notify.add({type:"error",title:"Вход из аккаунта",message:e.t0 instanceof Error?null===e.t0||void 0===e.t0?void 0:e.t0.message:"Неизвестная ошибка"});case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return f.apply(this,arguments)})},{key:"logout",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.logoutOriginal(t);case 2:return e.next=4,this.logoutSelf(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"handleLogoutConfirm",value:function(e){var t=w.a.storage.getUser();t&&(e&&this.logout(t.access_token),this.logoutConfirmRef.doClose())}},{key:"handleSwitcher",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w.a.storage.getUser()){e.next=6;break}return e.next=4,this.login();case 4:e.next=8;break;case 6:return e.next=8,this.logoutConfirmRef.doOpen();case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),m}(v.Vue);R([Object(v.Ref)("logoutConfirm")],O.prototype,"logoutConfirmRef",void 0);var C=O=R([Object(v.Component)({components:{CDialog:_.default,CButton:m.default,login:function(){return Promise.resolve().then(n.t.bind(null,563,7))},logout:function(){return Promise.resolve().then(n.t.bind(null,564,7))}}})],O),j=(n(749),n(34)),component=Object(j.a)(C,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"login-switcher"},[e.isTablet?e._e():t("div",{staticClass:"login-switcher__username"},[t("span",{staticClass:"login-switcher__username-text"},[e._v("\n      "+e._s(e.user.name)+"\n    ")])]),e._v(" "),t("CButton",{staticClass:"login-switcher__btn",attrs:{"is-text":"","is-square":"",align:"center",title:e.logged?"Выйти":"Войти"},on:{click:e.handleSwitcher}},[t(e.logged?"logout":"login",{tag:"component"})],1),e._v(" "),t("CDialog",{ref:"logoutConfirm",attrs:{title:"Выход из аккаунта","append-to-body":""}},[t("div",{staticStyle:{margin:"0 0 1em"}},[e._v("\n      Вы уверены, что хотите выйти из аккаунта?\n    ")]),e._v(" "),t("div",{staticStyle:{"text-align":"right"}},[t("CButton",{attrs:{align:"center",width:"80px"},on:{click:function(t){return e.handleLogoutConfirm(!0)}}},[e._v("\n        Да\n      ")]),e._v(" "),t("CButton",{attrs:{align:"center",width:"80px"},on:{click:function(t){return e.handleLogoutConfirm(!1)}}},[e._v("\n        Нет\n      ")])],1)])],1)}),[],!1,null,null,null);t.default=component.exports},749:function(e,t,n){"use strict";n(696)},750:function(e,t,n){var r=n(67)((function(i){return i[1]}));r.push([e.i,".login-switcher{align-items:center;display:flex;position:relative}.login-switcher__username{align-self:center;display:inline-flex;max-width:200px;padding:0 8px;position:relative}.login-switcher__username-text{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}",""]),r.locals={},e.exports=r}}]);