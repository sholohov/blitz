import{_ as ct}from"./UiImage.vue.DS0P_sJE.js";import{f as H,o as u,c as f,a,F as O,A as E,t as m,d as w,m as R,s as U,n as P,i as G,q as Y,k as o,b as k,C as Q,w as L,j as F,r as ut,y as _t,u as mt,g as dt,h as pt}from"./entry.BCxoBdpj.js";import{_ as z}from"./UiSelect.vue.D2eRQWvm.js";import{a as M,_ as Z}from"./request.DYurK6w5.js";import{h as N}from"./disableScroll.BMhynJqB.js";import{_ as gt}from"./UiInput.vue.ZQG53_VX.js";import{_ as ht}from"./WinRate.vue.BzptdZEm.js";import{_ as ft}from"./RoleIcon.vue.DflSzQ8H.js";import{_ as bt}from"./nuxt-link.vBf0PoaZ.js";import{n as nt}from"./notEmpty.BxBPJGBn.js";import{s as K}from"./index.Bti3NMCI.js";import{_ as yt,b as vt,g as $t}from"./UiDialog.vue.BESQZ_pt.js";import{d as Tt,t as wt}from"./debounce.B4CGx-ur.js";import{_ as kt}from"./UiTable.vue.BVfjirGu.js";import{e as St,i as Ct,_ as It}from"./isArrayLike.B41ObuhJ.js";import{_ as st}from"./ClanEmblem.vue.CnbRVmgc.js";import{_ as At}from"./UiTabs.vue.Cpb-amAa.js";import{_ as xt}from"./PageContent.vue.CjVF284l.js";import"./image-broken.I0tdFF4R.js";import"./nuxt-icon.j5VLktT_.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";import"./index.R4QztNYD.js";import"./MainSearch.vue.DriJ0O-h.js";import"./user.BXGQUIUO.js";import"./index.BxyEh5Dy.js";import"./index.54BYZypU.js";import"./ContentBox.vue.B2lu2vIZ.js";import"./leader.CagW_mQj.js";import"./client-only.Dbbbis-5.js";import"./dark-mode.1dmeuvir.js";import"./light-mode.Bx25YAGu.js";const Ot={key:0,class:"tournaments-stages"},Rt={class:"tournaments-stages__inner"},Gt={class:"tournaments-stages__list"},qt={class:"tournaments-stages__title"},Dt={class:"tournaments-stages__params"},Lt={class:"tournaments-stages__param"},Et=a("span",{class:"tournaments-stages__param-title"}," Дата ",-1),Mt={class:"tournaments-stages__param"},Nt=a("span",{class:"tournaments-stages__param-title"}," Система ",-1),jt={class:"tournaments-stages__param"},Ut=a("span",{class:"tournaments-stages__param-title"}," Уровень ",-1),Ft={class:"tournaments-stages__param"},Pt=a("span",{class:"tournaments-stages__param-title"}," Условие ",-1),Vt=H({__name:"TournamentsStages",props:{stages:{type:Array,default:()=>[]}},setup(_){function s(t){const n=U.encyclopedia.tier(t.min_tier),r=U.encyclopedia.tier(t.max_tier);return n===r?n:`${n} - ${r}`}return(t,n)=>_.stages.length?(u(),f("div",Ot,[a("div",Rt,[a("ul",Gt,[(u(!0),f(O,null,E(_.stages,r=>(u(),f("li",{key:r.stage_id,class:"tournaments-stages__stage"},[a("div",qt,m(r.title),1),a("div",Dt,[a("div",Lt,[Et,r.start_at?(u(),f(O,{key:0},[w(m(t.$formatter.date.toDateTime(r.start_at*1e3)),1)],64)):(u(),f(O,{key:1},[w(" --- ")],64))]),a("div",Mt,[Nt,w(" "+m(t.$formatter.tournament.stageType(r.type)),1)]),a("div",jt,[Ut,w(" "+m(s(r)),1)]),a("div",Ft,[Pt,w(" до "+m(r.victory_limit)+" побед ",1)])])]))),128))])])])):R("",!0)}}),Bt={class:"tournaments-matches"},Ht={class:"tournaments-matches__filters"},Wt={class:"tournaments-matches__filters-item"},Xt={class:"tournaments-matches__filters-item"},Yt={class:"tournaments-matches__list"},Jt={class:"tournaments-matches__round"},Kt={class:"tournaments-matches__teams"},Qt={class:"tournaments-matches__score"},Zt={class:"tournaments-matches__date"},zt=H({__name:"TournamentsMatches",props:{stages:{type:Array,default:()=>[],required:!0},tournamentId:{type:Object,default:()=>({}),required:!0}},setup(_){const s=_,t=P({loading:0,matches:[],selectedStage:null,selectedGroup:null}),n=P({page:1,pageSize:25,total:0}),r=G(()=>s.stages.map(i=>({label:i.title,value:i}))),v=G(()=>t.selectedStage?t.selectedStage.groups.map(i=>({label:`Группа ${i.group_order}`,value:i})):[]);Y(()=>{var i;t.selectedStage=C(),t.selectedGroup=((i=t.selectedStage)==null?void 0:i.groups[0])??null,g()});function C(){const i=s.stages.findLast(b=>b.state==="complete");return s.stages.findLast(b=>b.state==="schedule_ready")??i??s.stages[0]}function g(){!t.selectedStage||!t.selectedGroup||$(s.tournamentId,t.selectedStage.stage_id,t.selectedGroup.group_id)}async function $(i,c,b){t.loading++;try{const{data:y,meta:h}=await M.tournaments.getMatches({tournament_id:i,stage_id:c,group_id:b,limit:n.pageSize,page_no:n.page});n.total=h.total,t.matches=y}catch(y){N(y,{title:"Получение списка матчей"})}t.loading--}function I(i){t.selectedStage=i,t.selectedGroup=i.groups[0],n.page=1,g()}function A(i){t.selectedGroup=i,n.page=1,g()}return(i,c)=>{var y;const b=z;return u(),f("div",Bt,[a("div",Ht,[a("div",Wt,[w(" Этап ("+m(o(n).total??0)+") ",1),k(b,{value:o(t).selectedStage,"id-key":"stage_id",style:{width:"250px"},options:o(r),onChange:I},null,8,["value","options"])]),a("div",Xt,[w(" Группа ("+m(((y=o(t).selectedStage)==null?void 0:y.groups.length)??0)+") ",1),k(b,{value:o(t).selectedGroup,"id-key":"group_id",style:{width:"170px"},options:o(v),onChange:A},null,8,["value","options"])])]),a("div",Yt,[(u(!0),f(O,null,E(o(t).matches,h=>(u(),f("div",{key:h.id,class:"tournaments-matches__match"},[a("div",Jt," round: "+m(h.round),1),a("div",Kt,[(u(),f(O,null,E([1,2],x=>a("div",{key:x,class:Q(["tournaments-matches__team",["tournaments-matches__team--"]])},[w(m(h[`team_${x}_id`])+" ",1),a("span",Qt,m(h[`team_${x}_score`]||0),1)])),64))]),a("span",Zt,m(i.$formatter.date.toDateTime(h.start_time*1e3)),1)]))),128))])])}}}),te={class:"tournament-team"},ee={class:"tournament-team__inner"},ae={class:"tournament-team__props-list"},ne={class:"tournament-team__props"},se=a("span",{class:"tournament-team__props-title"},"Статус",-1),oe={class:"tournament-team__props"},ie=a("span",{class:"tournament-team__props-title"},"Ср. побед",-1),le={class:"tournament-team__props"},re=a("span",{class:"tournament-team__props-title"},"Ср. боёв",-1),ce={class:"tournament-team__player-list"},ue={key:0,class:"tournament-team__details"},_e={class:"tournament-team__player-name"},me={class:"tournament-team__player-stat"},de={class:"tournament-team__stat-item"},pe={key:1,class:"tournament-team__empty"},ge=H({__name:"TournamentTeam",props:{tournament:{type:Object,default:()=>({}),required:!0},team:{type:Object,default:()=>({}),required:!0}},setup(_){const s=_,t=P({loading:0,players:[],statisticsAll:null});Y(()=>{const g=s.tournament.max_players_count;t.players=Array(g).fill(v({})),C()});async function n(g){t.loading++;try{const{data:$}=await M.clan.getAccountInfo({extra:"clan",account_id:g.join(",")});return Object.values($).filter(nt)}catch($){return N($,{title:"Поучение списка клановых аккаунтов"}),[]}finally{t.loading--}}async function r(g){t.loading++;try{const{data:$}=await M.account.getInfo({extra:"statistics.rating",account_id:g.join(",")});return Object.values($).filter(nt)}catch($){return N($,{title:"Поучение списка аккаунтов"}),[]}finally{t.loading--}}function v(g){var A,i,c,b,y,h,x,d;const $=(A=g.account)==null?void 0:A.statistics.all,I=(i=g.account)==null?void 0:i.statistics.rating;return{id:((c=g.player)==null?void 0:c.account_id)??0,name:((b=g.player)==null?void 0:b.name)??"",isOwner:((y=g.player)==null?void 0:y.role)==="owner",clan:(h=g.clanAccount)!=null&&h.clan?{id:g.clanAccount.clan_id,tag:((x=g.clanAccount.clan)==null?void 0:x.tag)??"",name:((d=g.clanAccount.clan)==null?void 0:d.name)??""}:null,statistic:{all:$?K.accountAll($):null,rating:I?K.accountRating(I):null}}}async function C(){const g=s.team.players.map(c=>c.account_id),[$,I]=await Promise.all([r(g),n(g)]),A=$.reduce((c,b,y)=>y===0?$[0].statistics:K.sumFull(c,b.statistics),{});t.statisticsAll=K.accountAll(A.all,$.length);const i=s.tournament.max_players_count;t.players=Array(i).fill({}).map((c,b)=>{const y=s.team.players[b],h=$.find(d=>d.account_id===(y==null?void 0:y.account_id)),x=I.find(d=>d.account_id===(y==null?void 0:y.account_id));return v({player:y,account:h,clanAccount:x})}).sort(c=>c.isOwner?1:0)}return(g,$)=>{var b,y;const I=ht,A=ft,i=bt,c=Z;return u(),f("div",te,[a("div",ee,[a("div",ae,[a("div",ne,[se,w(" "+m(g.$formatter.tournament.teamStatusDetails(_.team.status)),1)]),a("div",oe,[ie,k(I,{"model-value":((b=o(t).statisticsAll)==null?void 0:b.winRate)||0},null,8,["model-value"])]),a("div",le,[re,w(" "+m(g.$formatter.number.toInteger(((y=o(t).statisticsAll)==null?void 0:y.battles)||0)),1)])]),a("ul",ce,[(u(!0),f(O,null,E(o(t).players,(h,x)=>{var d;return u(),f("li",{key:h.id||x,class:"tournament-team__player"},[k(A,{width:"18",height:"18",class:"tournament-team__player-role",role:h.isOwner?"commander":"private"},null,8,["role"]),h.id?(u(),f("div",ue,[a("div",_e,[k(i,{class:"tournament-team__player-link link",to:{name:"account-id",params:{id:h.id}}},{default:L(()=>[w(m(h.name),1)]),_:2},1032,["to"]),h.clan?(u(),F(i,{key:0,class:"tournament-team__player-link link",to:{name:"clan-id",params:{id:h.clan.id}}},{default:L(()=>{var S;return[w(m(`[${(S=h.clan)==null?void 0:S.tag}]`),1)]}),_:2},1032,["to"])):R("",!0)]),a("span",me,[h.statistic.all?(u(),F(I,{key:0,class:"tournament-team__stat-item","model-value":h.statistic.all.winRate},null,8,["model-value"])):R("",!0),a("span",de,m((d=h.statistic.all)==null?void 0:d.battles),1)])])):(u(),f("span",pe," Место свободно "))])}),128))]),k(c,{"backdrop-light":"",loading:o(t).loading>0},null,8,["loading"])])])}}}),he={class:"tournaments-teams"},fe={class:"tournaments-teams__filters"},be={class:"tournaments-teams__filters-item"},ye={class:"tournaments-teams__filters-item"},ve={class:"tournaments-teams__count"},$e=a("div",{class:"tournaments-teams__count-title"}," Кол-во: ",-1),Te={class:"tournaments-teams__list"},we=["onClick"],ke={class:"tournaments-teams__team-description"},Se={class:"tournaments-teams__team-name"},Ce={class:"tournaments-teams__team-owner"},Ie={class:"tournaments-teams__team-owner-text"},Ae={class:"tournaments-teams__team-count"},xe=H({__name:"TournamentsTeams",props:{tournament:{type:Object,default:()=>({}),required:!0}},setup(_){const s=[null,"confirmed","forming","disqualified"],t=_,n=ut(null),r=P({loading:0,teams:[],currentTeam:null}),v=P({page:1,total:0,pageSize:50}),C=P({status:"confirmed",search:""}),g=s.map(d=>({label:d?U.tournament.teamStatus(d):"Все",value:d})),$=G(()=>v.total>v.page*v.pageSize);Y(()=>{window.addEventListener("scroll",b)}),_t(()=>{window.removeEventListener("scroll",b)});function I(d){var S;return(S=d.players.find(q=>q.role==="owner"))==null?void 0:S.name}const A=Tt(i,1e3,{leading:!0});async function i(){await c()}async function c(){r.loading++;try{const{data:d,meta:S}=await M.tournaments.getTeams({tournament_id:t.tournament.tournament_id,limit:v.pageSize,page_no:v.page,...C});v.total=S.total,r.teams.push(...d)}catch(d){N(d,{title:"Получение списка команд"})}r.loading--}function b(){if(!r.teams.length)return;const{scrollTop:d,scrollHeight:S,clientHeight:q}=document.documentElement;r.loading===0&&$.value&&$.value&&d+q>=S-100&&(v.page+=1,c())}function y(){v.page=1,r.teams=[],i()}async function h(d=""){C.search=d=d.trim(),!(d.length<2&&d!=="")&&(v.page=1,r.teams=[],await A())}function x(d){var S;r.currentTeam=d,(S=n.value)==null||S.doOpen()}return(d,S)=>{var p;const q=z,W=gt,B=Z,e=ge,l=yt;return u(),f("div",he,[a("div",fe,[a("div",be,[w(" Статус "),k(q,{"model-value":o(C).status,style:{width:"220px"},options:o(g),onChange:y},null,8,["model-value","options"])]),a("div",ye,[w(" Поиск "),k(W,{"model-value":o(C).search,type:"search",placeholder:"Введите название команды",style:{width:"300px"},onInput:h},null,8,["model-value"])])]),a("div",ve,[$e,w(" "+m(o(v).total||0),1)]),a("div",Te,[(u(!0),f(O,null,E(o(r).teams,T=>(u(),f("button",{key:T.team_id,class:"tournaments-teams__team",onClick:D=>x(T)},[a("span",{class:Q(["tournaments-teams__status",[T.status?`tournaments-teams__status--${T.status}`:""]])},null,2),a("span",ke,[a("span",Se,m(T.title),1),a("span",Ce,[a("span",Ie,m(I(T)),1)])]),a("span",Ae,m(T.players.length)+" / "+m(_.tournament.max_players_count),1)],8,we))),128)),k(B,{loading:o(r).loading>0},null,8,["loading"])]),k(l,{ref_key:"teamDialogRef",ref:n,width:"500px","append-to-body":"",title:(p=o(r).currentTeam)==null?void 0:p.title},{default:L(()=>[o(r).currentTeam?(u(),F(e,{key:0,tournament:_.tournament,team:o(r).currentTeam},null,8,["tournament","team"])):R("",!0)]),_:1},8,["title"])])}}});function Oe(_,s,t){var n=-1,r=_.length;s<0&&(s=-s>r?0:r+s),t=t>r?r:t,t<0&&(t+=r),r=s>t?0:t-s>>>0,s>>>=0;for(var v=Array(r);++n<r;)v[n]=_[n+s];return v}var Re=Oe,Ge=St,qe=Ct,De=It,Le=vt;function Ee(_,s,t){if(!Le(t))return!1;var n=typeof s;return(n=="number"?qe(t)&&De(s,t.length):n=="string"&&s in t)?Ge(t[s],_):!1}var Me=Ee,Ne=wt,ot=1/0,je=17976931348623157e292;function Ue(_){if(!_)return _===0?_:0;if(_=Ne(_),_===ot||_===-ot){var s=_<0?-1:1;return s*je}return _===_?_:0}var Fe=Ue,Pe=Fe;function Ve(_){var s=Pe(_),t=s%1;return s===s?t?s-t:s:0}var Be=Ve,He=Re,We=Me,Xe=Be,Ye=Math.ceil,Je=Math.max;function Ke(_,s,t){(t?We(_,s,t):s===void 0)?s=1:s=Je(Xe(s),0);var n=_==null?0:_.length;if(!n||s<1)return[];for(var r=0,v=0,C=Array(Ye(n/s));r<n;)C[v++]=He(_,r,r+=s);return C}var Qe=Ke;const Ze=$t(Qe),ze={class:"tournaments-tables"},ta={class:"tournaments-tables__filters"},ea={class:"tournaments-tables__filters-item"},aa={class:"tournaments-tables__filters-item"},na={class:"tournaments-tables__stage-state"},sa=a("span",{class:"tournaments-tables__stage-state-label"}," Состояние этапа ",-1),oa={key:0,class:"tournaments-tables__table-scroll"},ia={key:0,class:"tournaments-tables__table-round-title"},la=["onClick"],ra={class:"tournaments-tables__table-team-details"},ca={class:"tournaments-tables__table-team-title"},ua={class:"tournaments-tables__table-team-score"},_a={class:"tournaments-tables__table-team-details"},ma={class:"tournaments-tables__table-team-title"},da=H({__name:"TournamentsTables",props:{tournamentId:{type:[String,Number],default:"",required:!0},stages:{type:Array,default:()=>[],required:!0}},setup(_){const s=_,t=P({loading:0,standings:[],tables:[],matches:[],selectedStage:null,selectedGroup:null,tableOne:[],tableTwo:[],highlightTeamId:null,total:0,standingsTotal:0}),n=G(()=>t.tables.filter(e=>{var l;return e.group_id===((l=t.selectedGroup)==null?void 0:l.group_id)})),r=G(()=>n.value.map(e=>{const l=t.standings.find(p=>e.team_id===p.team_id&&p.group_id===e.group_id);return{...e,wins:(l==null?void 0:l.wins)??0,draws:(l==null?void 0:l.draws)??0,losses:(l==null?void 0:l.losses)??0}})),v=[{key:"position",label:"#",width:40,align:"center"},{key:"name",label:"Команда"},{key:"matches_played",label:"Бои",width:60,align:"center"},{key:"wins",label:"Победы",width:60,align:"center"},{key:"draws",label:"Ничьи",width:60,align:"center"},{key:"losses",label:"Пораж.",width:60,align:"center"},{key:"team_points",label:"Очки",width:60,align:"center"}],C=G(()=>s.stages.map(e=>({label:e.title,value:e,disabled:!["complete","schedule_ready"].includes(e.state)}))),g=G(()=>t.selectedStage?t.selectedStage.groups.map(e=>({label:`Группа ${e.group_order}`,value:e})):[]),$=G(()=>{var e;switch((e=t.selectedStage)==null?void 0:e.state){case"draft":return"Проект создан";case"groups_ready":return"Группы сформированы";case"schedule_ready":return"График построен";case"complete":return"Этап завершён";default:return"..."}});Y(async()=>{var e;t.selectedStage=c(),t.selectedGroup=((e=t.selectedStage)==null?void 0:e.groups[0])??null,await b(),A()});function I(e){var p;const l=(p=t.selectedStage)==null?void 0:p.type;if(l==="SE"){if(e===1)return"Финал";if(e===2)return"Полуфинал";if(e===3)return"Четвертьфинал";if(e===-1)return"Матч за третье место"}if(l==="DE"){if(e===3)return"Верхняя сетка | Четвертьфинал";if(e===2)return"Верхняя сетка | Полуфинал";if(e===1)return"Верхняя сетка | Финал";if(e===0)return"Гранд-Финал";if(e===-1)return"Нижняя сетка | Финал";if(e===-2)return"Нижняя сетка | Полуфинал";if(e===-3)return"Нижняя сетка | Четвертьфинал"}return""}function A(){t.tableOne=[[],[],[],[]],t.tableTwo=[[],[],[],[]],t.matches.forEach(e=>{const l=t.tables.find(D=>D.team_id===e.team_1_id),p=t.tables.find(D=>D.team_id===e.team_2_id);if(!l||!p)return;const T={...e,teams:[l,p]};e.round===3&&t.tableOne[0].push(T),e.round===2&&t.tableOne[1].push(T),e.round===1&&t.tableOne[2].push(T),e.round===-3&&t.tableTwo[0].push(T),e.round===-2&&t.tableTwo[1].push(T),e.round===-1&&t.tableTwo[2].push(T),e.round===0&&t.tableTwo[3].push(T)})}function i(e,l){return l.team_id===e.winner_team_id}function c(){const e=s.stages.findLast(p=>p.state==="schedule_ready"),l=s.stages.findLast(p=>p.state==="complete");return e??l??s.stages[0]}async function b(){var p,T,D;const e=(p=t.selectedStage)==null?void 0:p.stage_id,l=(T=t.selectedGroup)==null?void 0:T.group_id;!e||!l||(await d({tournament_id:s.tournamentId,group_id:l,stage_id:e}),((D=t.selectedStage)==null?void 0:D.type)==="RR"?await h({tournament_id:s.tournamentId,team_id:n.value.map(J=>J.team_id).join(",")}):await y({tournament_id:s.tournamentId,group_id:l,stage_id:e}))}async function y(e){t.loading++;try{const{data:l}=await M.tournaments.getMatches({...e,limit:25});t.matches=l}catch(l){N(l,{title:"Получение матчей"})}t.loading--}async function h(e){const l=Ze(String(e.team_id).split(","),10);for(const p of l)await x({...e,team_id:p.join(",")})}async function x(e){t.loading++;try{const{data:l,meta:p}=await M.tournaments.getStandings({...e,limit:25});t.standings.push(...l),t.standingsTotal=p.total}catch(l){N(l,{title:"Получение результатов команд"})}t.loading--}async function d(e){let l=1;const p=25,T=async()=>{await S({...e,page_no:l,limit:p}),t.total>l*p&&(l++,await T())};await T()}async function S(e){t.loading++;try{const{data:l,meta:p}=await M.tournaments.getTables(e);t.tables.push(...l),t.total=p.total}catch(l){N(l,{title:"Получение турнирной сетки"})}t.loading--}async function q(e){t.selectedStage=e,t.selectedGroup=e.groups[0],t.tableOne=[[],[],[],[]],t.tableTwo=[[],[],[],[]],t.standings=[],t.tables=[],t.matches=[],await b(),t.selectedStage.type!=="RR"&&A()}async function W(e){t.selectedGroup=e,t.selectedStage&&(t.selectedStage.type==="RR"?(t.standings=[],await h({tournament_id:s.tournamentId,team_id:n.value.map(l=>l.team_id).join(",")})):(t.tableOne=[[],[],[],[]],t.tableTwo=[[],[],[],[]],t.matches=[],await y({tournament_id:s.tournamentId,group_id:e.group_id,stage_id:t.selectedStage.stage_id}),A()))}function B(e){t.highlightTeamId=e.team_id}return(e,l)=>{var J,tt;const p=z,T=kt,D=Z;return u(),f("div",ze,[a("div",ta,[a("div",ea,[w(" Этап ("+m(o(t).total??0)+") ",1),k(p,{"model-value":o(t).selectedStage,"id-key":"stage_id",style:{width:"250px"},options:o(C),disabled:!o(C).length,onChange:q},null,8,["model-value","options","disabled"])]),a("div",aa,[w(" Группа ("+m(((J=o(t).selectedStage)==null?void 0:J.groups.length)??"---")+") ",1),k(p,{"model-value":o(t).selectedGroup,"id-key":"group_id",style:{width:"170px"},disabled:!o(g).length,options:o(g),onChange:W},null,8,["model-value","disabled","options"])])]),a("div",na,[sa,w(" "+m(o($)),1)]),((tt=o(t).selectedStage)==null?void 0:tt.type)!=="RR"?(u(),f("div",oa,[(u(!0),f(O,null,E([o(t).tableOne,o(t).tableTwo],(V,et)=>(u(),f("div",{key:et,class:Q(["tournaments-tables__table",[`tournaments-tables__table--${et?"bottom":"top"}`]])},[(u(!0),f(O,null,E(V,(it,lt)=>(u(),f("div",{key:lt,class:"tournaments-tables__table-round"},[(u(!0),f(O,null,E(it,(X,rt)=>(u(),f("div",{key:X.id,class:"tournaments-tables__table-battle"},[rt===0?(u(),f("div",ia,m(I(X.round)),1)):R("",!0),(u(!0),f(O,null,E(X.teams,(j,at)=>(u(),f("button",{key:at,class:Q(["tournaments-tables__table-team",[i(X,j)?"tournaments-tables__table-team--is-winner":"",j.team_id===o(t).highlightTeamId?"tournaments-tables__table-team--is-highlight":""]]),onClick:xa=>B(j)},[a("span",ra,[k(st,{class:"tournaments-tables__table-team-clan-emblem",alt:j.clan_label,emblem:j.clan_emblem_preset_id},null,8,["alt","emblem"]),a("span",ca,[j.clan_label?(u(),f(O,{key:0},[w(" ["+m(j.clan_label)+"] ",1)],64)):R("",!0),w(" "+m(j.title),1)])]),a("span",ua,m(X[`team_${at+1}_score`]??"-"),1)],10,la))),128))]))),128))]))),128))],2))),128))])):(u(),F(T,{key:1,"no-wrap":"","scroll-auto-disabling":"","row-key":"account_id",height:"calc(100vh - 112px)",headers:v,data:o(r)},{name:L(({row:V})=>[a("div",_a,[k(st,{class:"tournaments-tables__table-team-clan-emblem",alt:V.clan_label,emblem:V.clan_emblem_preset_id},null,8,["alt","emblem"]),a("span",ma,[V.clan_label?(u(),f(O,{key:0},[w(" ["+m(V.clan_label)+"] ",1)],64)):R("",!0),w(" "+m(V.title),1)])])]),_:1},8,["data"])),k(D,{loading:o(t).loading>0},null,8,["loading"])])}}}),pa={key:0,class:"tournaments-info-page__inner"},ga={class:"tournaments-info-page__header"},ha={class:"tournaments-info-page__details"},fa={class:"tournaments-info-page__title"},ba={class:"tournaments-info-page__props"},ya={class:"tournaments-info-page__prop"},va={class:"tournaments-info-page__prop-title"},$a={class:"tournaments-info-page__props"},Ta={class:"tournaments-info-page__prop"},wa=a("div",{class:"tournaments-info-page__prop-title"}," Команд ",-1),ka={class:"tournaments-info-page__body"},Sa=["textContent"],Ca={class:"tournaments-info-page__body"},Ia={class:"tournaments-info-page__body"},Aa={class:"tournaments-info-page__body"},rn=H({__name:"[id]",setup(_){mt({title:"Турнир"});const s=dt(),t=pt(),n=P({loading:0,tournament:null,stages:[],activeTab:"info"}),r=G(()=>{var c,b;const i=[{label:"Описание",name:"info"},{label:"Команды",name:"teams",disabled:((c=n.tournament)==null?void 0:c.status)==="upcoming"}];return n.stages.length&&i.push({label:"Сетка",name:"tables",disabled:!["running","finished","complete"].includes(((b=n.tournament)==null?void 0:b.status)??"")}),i}),v=G(()=>{var i;switch((i=n.tournament)==null?void 0:i.status){case"upcoming":return{title:"Начало регистрации",date:U.date.toDateTime(n.tournament.registration_start_at*1e3)};case"registration_started":return{title:"Окончание регистрации",date:U.date.toDateTime(n.tournament.registration_end_at*1e3)};case"registration_finished":return{title:"Начало мачей",date:U.date.toDateTime(n.tournament.matches_start_at*1e3)};case"running":return{title:"Завершение",date:U.date.toDateTime(n.tournament.end_at*1e3)};case"finished":case"complete":return{title:"Завершен",date:U.date.toDateTime(n.tournament.end_at*1e3)}}return{title:"---",date:"---"}});Y(async()=>{var c;const i=(c=s.query)==null?void 0:c.activeTab;I(i||r.value[0].name),await C()});async function C(){const i=s.params.id;i&&await Promise.all([g(i),$(i)])}async function g(i){n.loading++;try{const{data:c}=await M.tournaments.getInfo({tournament_id:i});n.tournament=c[i]??null}catch(c){N(c,{title:"Получение информации турнира"})}n.loading--}async function $(i){n.loading++;try{const{data:c}=await M.tournaments.getStages({tournament_id:i});n.stages=c??[]}catch(c){N(c,{title:"Получение этапов турнира"})}n.loading--}function I(i){var c;n.activeTab=i,((c=s.query)==null?void 0:c.activeTab)!==i&&t.replace({query:{...s.query,activeTab:i}})}function A({name:i}){I(i)}return(i,c)=>{const b=ct,y=Vt,h=zt,x=xe,d=da,S=At,q=Z,W=xt;return u(),F(W,{class:"tournaments-info-page"},{default:L(()=>{var B,e,l,p;return[o(n).tournament?(u(),f("div",pa,[a("div",ga,[k(b,{src:o(n).tournament.logo.original,alt:"Tournament IMG",class:"tournaments-info-page__img"},null,8,["src"]),a("div",ha,[a("h1",fa,m((B=o(n).tournament)==null?void 0:B.title),1),a("div",ba,[a("div",ya,[a("div",va,m(o(v).title),1),w(" "+m(o(v).date),1)])]),a("div",$a,[a("div",Ta,[wa,w(" "+m(((e=o(n).tournament)==null?void 0:e.teams.confirmed)||0)+" / "+m(((l=o(n).tournament)==null?void 0:l.teams.total)||0)+" / "+m(((p=o(n).tournament)==null?void 0:p.teams.max)||0),1)])])])]),k(S,{modelValue:o(n).activeTab,"onUpdate:modelValue":c[0]||(c[0]=T=>o(n).activeTab=T),tabs:o(r),onTabClick:A},{info:L(()=>[a("div",ka,[o(n).stages.length?(u(),F(y,{key:0,stages:o(n).stages,class:"tournaments-info-page__stages","tournament-id":o(n).tournament.tournament_id},null,8,["stages","tournament-id"])):R("",!0),a("div",{class:"tournaments-info-page__description",textContent:m(o(n).tournament.description)},null,8,Sa)])]),matches:L(()=>[a("div",Ca,[o(n).stages.length?(u(),F(h,{key:0,stages:o(n).stages,"tournament-id":o(n).tournament.tournament_id},null,8,["stages","tournament-id"])):R("",!0)])]),teams:L(()=>[a("div",Ia,[k(x,{tournament:o(n).tournament},null,8,["tournament"])])]),tables:L(()=>[a("div",Aa,[o(n).stages.length?(u(),F(d,{key:0,"tournament-id":o(n).tournament.tournament_id,stages:o(n).stages},null,8,["tournament-id","stages"])):R("",!0)])]),_:1},8,["modelValue","tabs"])])):R("",!0),k(q,{loading:o(n).loading>0},null,8,["loading"])]}),_:1})}}});export{rn as default};
