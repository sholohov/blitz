(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{684:function(t,e,n){var content=n(729);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(68).default)("634d5d6a",content,!0,{sourceMap:!1})},694:function(t,e,n){"use strict";n.r(e);n(72);var r=n(13),c=n(32),o=n(33),l=n(35),d=n(36),_=n(23),v=n(20),f=(n(43),n(3),n(1),n(7),n(153),n(89),n(5),n(15)),w=n(152),h=n(94),m=n(105),y=n(114),x=n(115),C=n(227);function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(_.a)(t);if(e){var c=Object(_.a)(this).constructor;n=Reflect.construct(r,arguments,c)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var R=function(t,e,n,desc){var r,c=arguments.length,o=c<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(v.a)(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(o=(c<3?r(o):c>3?r(e,n,o):r(e,n))||o);return c>3&&o&&Object.defineProperty(e,n,o),o},j=function(t,e){var n,r;if((null==t||!t.raw)&&t.timestamp)return C.a.date.toLocaleDate(t.timestamp);var c=e?e.raw?1e3*e.raw.joined_at:e.timestamp:Date.now(),o=t.raw?1e3*(null===(n=t.raw)||void 0===n?void 0:n.joined_at):t.timestamp,l=C.a.date.toLocaleDate(t.raw?1e3*(null===(r=t.raw)||void 0===r?void 0:r.joined_at):null==t?void 0:t.timestamp),d=C.a.date.toDaysPassed(c,o,!0);return"".concat(l," (").concat(d,")")},O=function(t){Object(l.a)(y,t);var e,n,d,_,v,f,w=k(y);function y(){var t;return Object(c.a)(this,y),(t=w.apply(this,arguments)).notify=m.a.notify(),t.user=null,t.clan=null,t.clanHistory=[],t.loading=0,t.isOpened=!1,t}return Object(o.a)(y,[{key:"fetchClanInfo",value:(f=Object(r.a)(regeneratorRuntime.mark((function t(e){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading++,t.prev=1,t.next=4,h.a.clan.getInfo({clan_id:e});case 4:n=t.sent,data=n.data,this.clan=data?data[e]:null,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),this.notify.add({type:"error",message:"Получение данных клана"}),console.error(t.t0);case 13:this.loading--;case 14:case"end":return t.stop()}}),t,this,[[1,9]])}))),function(t){return f.apply(this,arguments)})},{key:"getUserInfo",value:(v=Object(r.a)(regeneratorRuntime.mark((function t(e){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading++,t.prev=1,t.next=4,h.b.user.get(e);case 4:n=t.sent,data=n.data,this.user=data,t.next=15;break;case 9:if(t.prev=9,t.t0=t.catch(1),console.error(t.t0),!h.b.isResponse(t.t0)||404!==t.t0.status){t.next=14;break}return t.abrupt("return");case 14:this.notify.add({type:"error",title:"Получение данных пользователя",message:t.t0 instanceof Error?t.t0.message:"Неизвестная ошибка"});case 15:return t.prev=15,this.loading--,t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[1,9,15,18]])}))),function(t){return v.apply(this,arguments)})},{key:"getClans",value:(_=Object(r.a)(regeneratorRuntime.mark((function t(e){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading++,t.prev=1,t.next=4,h.a.clan.getInfo({clan_id:e.join(","),fields:"clan_id,name,tag"});case 4:return n=t.sent,data=n.data,t.abrupt("return",null!=data?data:null);case 9:return t.prev=9,t.t0=t.catch(1),this.notify.add({type:"error",title:"Получение данных кланов",message:t.t0 instanceof Error?t.t0.message:"Неизвестная ошибка"}),t.abrupt("return",null);case 13:return t.prev=13,this.loading--,t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[1,9,13,16]])}))),function(t){return _.apply(this,arguments)})},{key:"buildClanHistory",value:function(t,e){this.clanHistory=t.map((function(n,r){var c,o=n.raw,l=n.timestamp,d=o&&e?e[o.clan_id]:null;return{key:l,date:j(n,t[r-1]),info:d&&o?"[".concat(d.tag,"] ").concat(C.a.clan.role(o.role)):"Не в клане",clanId:null!==(c=null==o?void 0:o.clan_id)&&void 0!==c?c:null}}))}},{key:"clansAccounts",value:(d=Object(r.a)(regeneratorRuntime.mark((function t(e){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading++,t.prev=1,t.next=4,h.b.stat.clansAccounts.getList({id:e});case 4:return n=t.sent,data=n.data,t.abrupt("return",null!=data?data:[]);case 9:if(t.prev=9,t.t0=t.catch(1),console.error(t.t0),!h.b.isResponse(t.t0)||404!==t.t0.status){t.next=14;break}return t.abrupt("return",[]);case 14:return this.notify.add({type:"error",title:"Получение данных пользователя",message:t.t0 instanceof Error?t.t0.message:"Неизвестная ошибка"}),t.abrupt("return",[]);case 16:return t.prev=16,this.loading--,t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[1,9,16,19]])}))),function(t){return d.apply(this,arguments)})},{key:"loadData",value:(n=Object(r.a)(regeneratorRuntime.mark((function t(){var e,n,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isOpened){t.next=2;break}return t.abrupt("return");case 2:if(this.isOpened=!0,null===(e=this.clanAccount)||void 0===e||!e.clan_id){t.next=6;break}return t.next=6,this.fetchClanInfo(this.clanAccount.clan_id);case 6:return t.next=8,this.getUserInfo(this.account.account_id);case 8:if(this.user){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,this.clansAccounts(this.account.account_id);case 12:if(!(n=t.sent).length){t.next=19;break}return r=n.filter((function(t){var e=t.raw;return null==e?void 0:e.clan_id})).map((function(t){var e=t.raw;return null==e?void 0:e.clan_id})),t.next=17,this.getClans(r);case 17:c=t.sent,this.buildClanHistory(n,c);case 19:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"close",value:function(){this.detailedDialogRef.doClose()}},{key:"open",value:(e=Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadData();case 2:return t.next=4,this.detailedDialogRef.doOpen();case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),y}(f.Vue);R([Object(f.Prop)({required:!0})],O.prototype,"account",void 0),R([Object(f.Prop)({required:!0})],O.prototype,"clanAccount",void 0),R([Object(f.Ref)()],O.prototype,"detailedDialogRef",void 0);var D=O=R([Object(f.Component)({components:{SvgIcon:x.default,CButton:y.default,CDialog:w.default}})],O),I=(n(728),n(34)),component=Object(I.a)(D,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("CDialog",{ref:"detailedDialogRef",staticClass:"account-preview-details",attrs:{title:"Дополнительная информация",width:"600px"},scopedSlots:t._u([{key:"footer",fn:function(){return[e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("span"),t._v(" "),e("CButton",{on:{click:t.close}},[t._v("\n        Закрыть\n      ")])],1)]},proxy:!0}])},[e("div",{staticClass:"account-preview-details__body"},[e("div",{staticClass:"account-preview-details__section"},[e("h5",{staticClass:"account-preview-details__props-title"},[e("SvgIcon",{staticClass:"account-preview-details__prop-title-icon",attrs:{"icon-name":"sports-esports"}}),t._v("\n        Аккаунт игрока\n      ")],1),t._v(" "),e("div",{staticClass:"account-preview-details__props"},[e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Дата создания\n          ")]),t._v("\n          "+t._s(t.$formatter.date.toLocaleDate(1e3*t.account.created_at))+"\n        ")]),t._v(" "),e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Дата обновления\n          ")]),t._v("\n          "+t._s(t.$formatter.date.toLocaleDate(1e3*t.account.updated_at))+"\n        ")])])]),t._v(" "),t.user?e("div",{staticClass:"account-preview-details__section"},[e("h5",{staticClass:"account-preview-details__props-title"},[e("SvgIcon",{staticClass:"account-preview-details__prop-title-icon",attrs:{"icon-name":"person"}}),t._v("\n        Пользователь ресурса\n      ")],1),t._v(" "),e("div",{staticClass:"account-preview-details__props"},[e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Зарегистрирован\n          ")]),t._v("\n          "+t._s(t.$formatter.date.toLocaleDate(t.user.createAt))+"\n        ")]),t._v(" "),e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Последний визит\n          ")]),t._v("\n          "+t._s(t.$formatter.date.toLocaleDate(t.user.visitedAt))+"\n        ")])])]):t._e(),t._v(" "),e("div",{staticClass:"account-preview-details__section"},[e("h5",{staticClass:"account-preview-details__props-title"},[e("SvgIcon",{staticClass:"account-preview-details__prop-title-icon",attrs:{"icon-name":"groups"}}),t._v("\n        Клан игрока\n      ")],1),t._v(" "),t.clan&&t.clanAccount?e("div",{staticClass:"account-preview-details__props"},[e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Командир\n          ")]),t._v(" "),t.clan.leader_id?e("nuxt-link",{staticClass:"account-preview-details__clan-history-link link",attrs:{to:{name:"account-id",params:{id:t.clan.leader_id}}}},[t._v("\n            "+t._s(t.clan.leader_name)+"\n          ")]):t._e()],1),t._v(" "),e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Участников\n          ")]),t._v("\n          "+t._s(t.$formatter.number.toInteger(t.clan.members_count))+"\n        ")]),t._v(" "),e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Создан\n          ")]),t._v("\n          "+t._s(t.$formatter.date.toLocaleDate(1e3*t.clan.created_at))+"\n        ")]),t._v(" "),e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Роль\n          ")]),t._v("\n          "+t._s(t.$formatter.clan.role(t.clanAccount.role))+"\n        ")]),t._v(" "),e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Вступил\n          ")]),t._v("\n          "+t._s(t.$formatter.date.toLocaleDate(1e3*t.clanAccount.joined_at))+"\n        ")])]):e("div",{staticClass:"account-preview-details__props"},[e("div",{staticClass:"account-preview-details__prop"},[t._v("\n          Не состоит в клане\n        ")])])]),t._v(" "),t.user?e("div",{staticClass:"account-preview-details__section"},[e("h5",{staticClass:"account-preview-details__props-title"},[e("SvgIcon",{staticClass:"account-preview-details__prop-title-icon",attrs:{"icon-name":"history"}}),t._v("\n        Клановая история\n      ")],1),t._v(" "),e("div",{staticClass:"account-preview-details__props"},[e("div",{staticClass:"account-preview-details__prop"},[e("span",{staticClass:"account-preview-details__prop-title"},[t._v("\n            Данные собираются со дня регистрации на сайте.\n          ")]),t._v(" "),t.clanHistory.length?e("div",{staticClass:"account-preview-details__clan-history"},t._l(t.clanHistory,(function(n){return e("div",{key:n.key,staticClass:"account-preview-details__clan-history-item"},[e("span",{staticClass:"account-preview-details__clan-history-date"},[t._v("\n                "+t._s(n.date)+"\n              ")]),t._v(" "),n.clanId?e("nuxt-link",{staticClass:"account-preview-details__clan-history-link link",attrs:{to:{name:"clan-id",params:{id:n.clanId}}}},[t._v("\n                "+t._s(n.info)+"\n              ")]):e("span",{staticClass:"account-preview-details__clan-history-link"},[t._v("\n                "+t._s(n.info)+"\n              ")])],1)})),0):[t._v("\n            Данные собираются.\n          ")]],2)])]):t._e()]),t._v(" "),e("ContentLoader",{attrs:{"backdrop-light":"",loading:t.loading>0}})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{SvgIcon:n(115).default,ContentLoader:n(226).default})},728:function(t,e,n){"use strict";n(684)},729:function(t,e,n){var r=n(67)((function(i){return i[1]}));r.push([t.i,".account-preview-details__body{padding:20px 0}.account-preview-details__section+.account-preview-details__section{border-top:1px solid var(--border-color-light);margin:20px 0 0;padding:20px 0 0}.account-preview-details__props-title{font-weight:500;margin:0 0 14px}.account-preview-details__props-subtitle,.account-preview-details__props-title{align-items:flex-start;color:var(--color-text-light);display:flex;font-size:14px;line-height:1.5}.account-preview-details__props-subtitle{margin:0;width:100%}.account-preview-details__prop-title-icon{color:var(--color-text);flex:none;margin:-2px 8px 0 0}.account-preview-details__props{align-items:center;display:flex;flex-wrap:wrap;gap:20px 30px}.account-preview-details__prop{display:flex;flex-direction:column;min-width:0}.account-preview-details__prop--row{width:100%}.account-preview-details__prop-title{color:var(--color-text-light);font-size:12px;max-width:350px}.account-preview-details__clan-history{display:table;margin:6px 0;white-space:nowrap;width:100%}@media only screen and (max-width:480px){.account-preview-details__clan-history{display:flex;flex-direction:column}}.account-preview-details__clan-history-item{display:table-row}@media only screen and (max-width:480px){.account-preview-details__clan-history-item{display:flex;flex-direction:column;margin:6px 0}}.account-preview-details__clan-history-date{display:table-cell;font-size:12px;padding:0 10px 0 0}.account-preview-details__clan-history-link:not(.link){color:var(--color-text-light);display:table-cell;overflow:hidden;text-overflow:ellipsis}",""]),r.locals={},t.exports=r}}]);