import{_ as H}from"./ContentLoader.vue.5R4WWV0u.js";import{f as J,o as R,c as F,b as G,w as O,F as Q,A as U,a as K,t as x,K as X,d as Y,m as Z,T as tt,s as e}from"./entry.C5iIeEMf.js";import{c as w}from"./WinRate.vue.8iAWDvYD.js";import{s as u}from"./index.1j3v_9h4.js";const et=t=>{try{const l=document.createElement("textarea");return l.value=t,l.style.top="0",l.style.left="0",l.style.position="fixed",document.body.appendChild(l),l.focus(),l.select(),document.execCommand("copy"),document.body.removeChild(l),!0}catch{return!1}},gt=async t=>{if(!navigator.clipboard)return et(t);try{return await navigator.clipboard.writeText(t),!0}catch(l){return console.error(l),!1}},at={class:"metrics-plates"},lt={class:"metrics-plates__item-label"},nt={key:0,class:"metrics-plates__item-diff"},yt=J({__name:"MetricsPlates",props:{items:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,default:!1}},setup(t){return(l,n)=>{const a=H;return R(),F("div",at,[G(tt,{tag:"ul",class:"metrics-plates__list"},{default:O(()=>[(R(!0),F(Q,null,U(t.items,r=>(R(),F("li",{key:r.key,class:"metrics-plates__item"},[K("span",lt,x(r.label),1),K("b",{class:"metrics-plates__item-value",style:X({color:r.color?`var(--color-${r.color})`:null})},[Y(x(r.value)+" ",1),r.diff?(R(),F("span",nt,x(r.diff),1)):Z("",!0)],4),G(a,{loading:t.loading},null,8,["loading"])]))),128))]),_:1})])}}}),W=(t,l)=>{if(!(!t||!l))return t.reduce((n,a)=>n+a.battle_life_time,0)/l.battles},rt=t=>{var b,f,d,m,v,P,g,y,k,_,s,D,I,p,N,T,C,M,A,L,$,S,V,E,j,q;const l=[{label:"",key:"battles",value:((b=t.stat)==null?void 0:b.battles)||0,diff:e.number.toInteger((f=t.statDiff)==null?void 0:f.battles,!0)},{label:"",key:"winRate",value:e.number.toFloatPercent(((d=t.stat)==null?void 0:d.winRate)||0),diff:e.number.toFloatPercent((m=t.statDiff)==null?void 0:m.winRate,!0),color:w.winRate(((v=t.stat)==null?void 0:v.winRate)||0)},{label:"",key:"damagePerBattle",value:((P=t.stat)==null?void 0:P.damagePerBattle)||0,diff:e.number.toInteger((g=t.statDiff)==null?void 0:g.damagePerBattle,!0)}],n=t.achievements?u.winsInPlatoon({wins:((y=t.stat)==null?void 0:y.wins)??0,achievements:t.achievements}):void 0,a=t.achievementsDiff?u.winsInPlatoon({wins:((k=t.statDiff)==null?void 0:k.wins)??0,achievements:t.achievementsDiff})-(n||0):void 0;l.push({label:"",key:"winsInPlatoon",value:e.number.toFloatPercent(n||0),diff:e.number.toFloatPercent(a,!0)});const r=u.battlesPerDay({battles:((_=t.stat)==null?void 0:_.battles)||0,createAt:t.createAt||0}),i=u.battlesPerDay({battles:((s=t.statDiff)==null?void 0:s.battles)||0,createAt:t.createAtDiff||0});l.push({label:"",key:"battlesPerDay",value:r,diff:t.statDiff?e.number.toInteger(i-r,!0):""}),l.push({label:"",key:"tanksWithMaster",value:`${u.totalMasters(t.tanks)} / ${t.tanks.length}`,diff:t.tanksDiff?`${u.totalMasters(t.tanksDiff||[])} / ${((D=t.tanksDiff)==null?void 0:D.length)||0}`:""}),l.push({label:"",key:"fragPerBattle",value:e.number.toFloatNumber(((I=t.stat)==null?void 0:I.fragPerBattle)||0),diff:e.number.toFloatNumber((p=t.statDiff)==null?void 0:p.fragPerBattle,!0)},{label:"",key:"surviveRate",value:e.number.toFloatPercent(((N=t.stat)==null?void 0:N.surviveRate)||0),diff:e.number.toFloatPercent((T=t.statDiff)==null?void 0:T.surviveRate,!0)},{label:"",key:"hitRate",value:e.number.toFloatPercent(((C=t.stat)==null?void 0:C.hitRate)||0),diff:e.number.toFloatPercent((M=t.statDiff)==null?void 0:M.hitRate,!0)},{label:"",key:"spottedPerBattle",value:e.number.toFloatNumber(((A=t.stat)==null?void 0:A.spottedPerBattle)||0),diff:e.number.toFloatNumber((L=t.statDiff)==null?void 0:L.spottedPerBattle,!0)},{label:"",key:"xpPerBattle",value:e.number.toInteger((($=t.stat)==null?void 0:$.xpPerBattle)||0),diff:e.number.toInteger((S=t.statDiff)==null?void 0:S.xpPerBattle,!0)},{label:"",key:"max_frags",value:((V=t.stat)==null?void 0:V.max_frags)||0,diff:e.number.toInteger((E=t.statDiff)==null?void 0:E.max_frags,!0)},{label:"",key:"max_xp",value:((j=t.stat)==null?void 0:j.max_xp)||0,diff:e.number.toInteger((q=t.statDiff)==null?void 0:q.max_xp,!0)});const o=W(t.tanks,t.stat)??0,c=W(t.tanksDiff,t.statDiff)??null,B=(c||0)-o;return l.push({key:"battle_life_time",label:"Время жизни в минутах",value:e.number.toFloatNumber(o/60||0),diff:c?e.number.toFloatNumber(B/60||0,!0):void 0}),l.forEach(h=>{h.label=e.stat.accountProp(h.key)}),l.filter(h=>{var z;return t.plates?(z=t.plates)==null?void 0:z.includes(h.key):!0})},ot=(t=[],l)=>{const n=t.length;let a;l&&n&&(a=u.accountAll(l.all,n));const r=Math.floor(t.reduce((i,o)=>Math.floor(i+u.battlesPerDay({createAt:o.created_at*1e3,battles:o.statistics.all.battles})),0)/n);return[{key:"battles",label:"Боёв",value:(a==null?void 0:a.battles)||0},{key:"winRate",label:"Побед",value:e.number.toFloatPercent((a==null?void 0:a.winRate)||0),color:w.winRate((a==null?void 0:a.winRate)||0)},{key:"damagePerBattle",label:"Урон",value:(a==null?void 0:a.damagePerBattle)||0},{key:"activity",label:"Боёв в день",value:e.number.toInteger(r)}]},ut=t=>{const l=u.tank(t.tank.all),n=t.tankSession?u.tank(t.tankSession.all):null,a=n?u.diff(l,n):null,r=[{key:"battles",label:e.stat.accountProp("battles"),value:e.number.toInteger(l.battles||0),diff:e.number.toInteger((a==null?void 0:a.battles)||0,!0)},{key:"winRate",label:e.stat.accountProp("winRate"),value:e.number.toFloatPercent(l.winRate||0),diff:e.number.toFloatPercent((a==null?void 0:a.winRate)||0,!0),color:w.winRate(l.winRate||0)},{key:"damagePerBattle",label:e.stat.accountProp("damagePerBattle"),value:e.number.toInteger(l.damagePerBattle||0),diff:e.number.toInteger((a==null?void 0:a.damagePerBattle)||0,!0)},{key:"fragPerBattle",label:e.stat.accountProp("fragPerBattle"),value:e.number.toFloatNumber(l.fragPerBattle||0),diff:e.number.toFloatNumber((a==null?void 0:a.fragPerBattle)||0,!0)},{key:"surviveRate",label:e.stat.accountProp("surviveRate"),value:e.number.toFloatPercent(l.surviveRate||0),diff:e.number.toFloatPercent((a==null?void 0:a.surviveRate)||0,!0)},{key:"hitRate",label:e.stat.accountProp("hitRate"),value:e.number.toFloatPercent(l.hitRate||0),diff:e.number.toFloatPercent((a==null?void 0:a.hitRate)||0,!0)},{key:"spottedPerBattle",label:e.stat.accountProp("spottedPerBattle"),value:e.number.toFloatNumber(l.spottedPerBattle||0),diff:e.number.toFloatNumber((a==null?void 0:a.spottedPerBattle)||0,!0)},{key:"xpPerBattle",label:e.stat.accountProp("xpPerBattle"),value:e.number.toInteger(l.xpPerBattle||0),diff:e.number.toInteger((a==null?void 0:a.xpPerBattle)||0,!0)},{key:"max_frags",label:e.stat.accountProp("max_frags"),value:e.number.toInteger(l.max_frags||0),diff:e.number.toInteger((n==null?void 0:n.max_frags)||0)},{key:"max_xp",label:e.stat.accountProp("max_xp"),value:e.number.toInteger(l.max_xp||0),diff:e.number.toInteger((n==null?void 0:n.max_xp)||0)}];return r.push({key:"winsInPlatoon",label:e.stat.accountProp("winsInPlatoon"),value:e.number.toFloatPercent(u.winsInPlatoon({wins:t.tank.all.wins,achievements:t.tank.achievements})||0)}),r.push({key:"lifeTime",label:e.stat.accountProp("lifeTime"),value:e.number.toFloatNumber(t.tank.battle_life_time/l.battles/60||0)}),r.filter(i=>{var o;return t.plates?(o=t.plates)==null?void 0:o.includes(i.key):!0})},it=(t={})=>{var n,a,r,i,o,c,B,b,f,d,m,v,P,g,y,k,_;const l=[{key:"battles",label:"Боёв",value:((n=t.stat)==null?void 0:n.battles)||0,diff:e.number.toInteger((a=t.diff)==null?void 0:a.battles,!0)},{key:"winRate",label:"Побед",value:e.number.toFloatPercent(((r=t.stat)==null?void 0:r.winRate)||0),diff:e.number.toFloatPercent((i=t.diff)==null?void 0:i.winRate,!0),color:w.winRate(((o=t.stat)==null?void 0:o.winRate)||0)},{key:"damagePerBattle",label:"Урон",value:((c=t.stat)==null?void 0:c.damagePerBattle)||0,diff:e.number.toInteger((B=t.diff)==null?void 0:B.damagePerBattle,!0)},{key:"fragPerBattle",label:"Уничтожено",value:e.number.toFloatNumber(((b=t.stat)==null?void 0:b.fragPerBattle)||0),diff:e.number.toFloatNumber((f=t.diff)==null?void 0:f.fragPerBattle,!0)},{key:"surviveRate",label:"Выживаемость",value:e.number.toFloatPercent(((d=t.stat)==null?void 0:d.surviveRate)||0),diff:e.number.toFloatPercent((m=t.diff)==null?void 0:m.surviveRate,!0)},{key:"hitRate",label:"Меткость",value:e.number.toFloatPercent(((v=t.stat)==null?void 0:v.hitRate)||0),diff:e.number.toFloatPercent((P=t.diff)==null?void 0:P.hitRate,!0)},{key:"spottedPerBattle",label:"Обнаружено",value:e.number.toFloatNumber(((g=t.stat)==null?void 0:g.spottedPerBattle)||0),diff:e.number.toFloatNumber((y=t.diff)==null?void 0:y.spottedPerBattle,!0)}];if((k=t.stat)!=null&&k.mm_rating){const s=(t.stat.mm_rating||0)*10+3e3;l.push({key:"mm_rating",label:"Рейтинг",value:e.number.toInteger(s)})}else{const s=10-(((_=t.stat)==null?void 0:_.calibration_battles_left)||0);l.push({key:"calibration_battles_left",label:s<10?"Калибровочные бои":"Рейтинг",value:s<10?`${e.number.toInteger(s)}/10`:"---"})}return l},kt={account:rt,accountRating:it,tank:ut,clan:ot},st=(t,l)=>{const{prop:n,order:a}=l;return a?t.toSorted((r,i)=>{const o=(a==="desc"?i:r)[n],c=(a==="desc"?r:i)[n];return String(o).localeCompare(String(c),void 0,{numeric:!0,sensitivity:"base"})}):t},ct=t=>{t.sort((l,n)=>l.joined_at-n.joined_at)},bt=t=>{t.sort((l,n)=>{const a={recruit:0,private:1,executive_officer:2,commander:3};return a[n.role]-a[l.role]})},ft=t=>{ct(t),bt(t)},_t={smart:st,clanMembersDefault:ft};export{yt as _,gt as c,kt as m,_t as s};
