import{_ as ct}from"./Bn1JX7hh.js";import{d as H,o as u,m as b,n,F as O,D as E,v as _,t as w,g as R,p as U,k as P,c as G,l as Y,q as M,s as N,f as o,h as S,I as Q,w as L,e as F,r as ut,B as mt,ac as _t,as as dt,at as pt,au as gt,ak as ft,u as ht,a as bt,b as yt}from"./CjZrE5Wh.js";import{_ as z}from"./CI6zNOZI.js";import{_ as vt}from"./BtCZQDp8.js";import{_ as Z}from"./Cb74_AAG.js";import{_ as $t}from"./Z7RafptJ.js";import{_ as Tt}from"./C0geJmxB.js";import{_ as wt}from"./DVWFMday.js";import{n as nt}from"./BxBPJGBn.js";import{s as K}from"./lVSEt-VN.js";import{_ as kt}from"./Zt_43PKh.js";import{d as St,t as It}from"./gCGvA3p7.js";import{_ as Ct}from"./Bx2A0I5R.js";import{_ as st}from"./Ce3nYSQl.js";import{_ as At}from"./CDh3vM25.js";import{_ as xt}from"./UsgrnhQW.js";import"./i0sd772w.js";import"./BBnSm2t4.js";import"./DlAUqK2U.js";import"./CVTThTqB.js";import"./DBvd0WFK.js";import"./DD4asW33.js";import"./eaCJGG-n.js";import"./08N2mJ2P.js";import"./BPrNtVlW.js";import"./f3e3m13b.js";import"./wGjzNOYn.js";import"./DSeEFkux.js";import"./BRok-xIX.js";import"./DMYS3RtA.js";import"./Qj2LaeAt.js";const Ot={key:0,class:"tournaments-stages"},Rt={class:"tournaments-stages__inner"},Gt={class:"tournaments-stages__list"},Dt={class:"tournaments-stages__title"},qt={class:"tournaments-stages__params"},Lt={class:"tournaments-stages__param"},Et={class:"tournaments-stages__param"},Mt={class:"tournaments-stages__param"},Nt={class:"tournaments-stages__param"},jt=H({__name:"TournamentsStages",props:{stages:{type:Array,default:()=>[]}},setup(m){function s(t){const e=U.encyclopedia.tier(t.min_tier),r=U.encyclopedia.tier(t.max_tier);return e===r?e:`${e} - ${r}`}return(t,e)=>m.stages.length?(u(),b("div",Ot,[n("div",Rt,[n("ul",Gt,[(u(!0),b(O,null,E(m.stages,r=>(u(),b("li",{key:r.stage_id,class:"tournaments-stages__stage"},[n("div",Dt,_(r.title),1),n("div",qt,[n("div",Lt,[e[0]||(e[0]=n("span",{class:"tournaments-stages__param-title"}," Дата ",-1)),r.start_at?(u(),b(O,{key:0},[w(_(t.$formatter.date.toDateTime(r.start_at*1e3)),1)],64)):(u(),b(O,{key:1},[w(" --- ")],64))]),n("div",Et,[e[1]||(e[1]=n("span",{class:"tournaments-stages__param-title"}," Система ",-1)),w(" "+_(t.$formatter.tournament.stageType(r.type)),1)]),n("div",Mt,[e[2]||(e[2]=n("span",{class:"tournaments-stages__param-title"}," Уровень ",-1)),w(" "+_(s(r)),1)]),n("div",Nt,[e[3]||(e[3]=n("span",{class:"tournaments-stages__param-title"}," Условие ",-1)),w(" до "+_(r.victory_limit)+" побед ",1)])])]))),128))])])])):R("",!0)}}),Ut={class:"tournaments-matches"},Ft={class:"tournaments-matches__filters"},Pt={class:"tournaments-matches__filters-item"},Vt={class:"tournaments-matches__filters-item"},Bt={class:"tournaments-matches__list"},Ht={class:"tournaments-matches__round"},Wt={class:"tournaments-matches__teams"},Xt={class:"tournaments-matches__score"},Yt={class:"tournaments-matches__date"},Jt=H({__name:"TournamentsMatches",props:{stages:{type:Array,default:()=>[],required:!0},tournamentId:{type:Object,default:()=>({}),required:!0}},setup(m){const s=m,t=P({loading:0,matches:[],selectedStage:null,selectedGroup:null}),e=P({page:1,pageSize:25,total:0}),r=G(()=>s.stages.map(i=>({label:i.title,value:i}))),$=G(()=>t.selectedStage?t.selectedStage.groups.map(i=>({label:`Группа ${i.group_order}`,value:i})):[]);Y(()=>{var i;t.selectedStage=I(),t.selectedGroup=((i=t.selectedStage)==null?void 0:i.groups[0])??null,g()});function I(){const i=s.stages.findLast(y=>y.state==="complete");return s.stages.findLast(y=>y.state==="schedule_ready")??i??s.stages[0]}function g(){!t.selectedStage||!t.selectedGroup||f(s.tournamentId,t.selectedStage.stage_id,t.selectedGroup.group_id)}async function f(i,c,y){t.loading++;try{const{data:v,meta:h}=await M.tournaments.getMatches({tournament_id:i,stage_id:c,group_id:y,limit:e.pageSize,page_no:e.page});e.total=h.total,t.matches=v}catch(v){N(v,{title:"Получение списка матчей"})}t.loading--}function C(i){t.selectedStage=i,t.selectedGroup=i.groups[0],e.page=1,g()}function A(i){t.selectedGroup=i,e.page=1,g()}return(i,c)=>{var v;const y=z;return u(),b("div",Ut,[n("div",Ft,[n("div",Pt,[w(" Этап ("+_(o(e).total??0)+") ",1),S(y,{value:o(t).selectedStage,"id-key":"stage_id",style:{width:"250px"},options:o(r),onChange:C},null,8,["value","options"])]),n("div",Vt,[w(" Группа ("+_(((v=o(t).selectedStage)==null?void 0:v.groups.length)??0)+") ",1),S(y,{value:o(t).selectedGroup,"id-key":"group_id",style:{width:"170px"},options:o($),onChange:A},null,8,["value","options"])])]),n("div",Bt,[(u(!0),b(O,null,E(o(t).matches,h=>(u(),b("div",{key:h.id,class:"tournaments-matches__match"},[n("div",Ht," round: "+_(h.round),1),n("div",Wt,[(u(),b(O,null,E([1,2],x=>n("div",{key:x,class:Q(["tournaments-matches__team",["tournaments-matches__team--"]])},[w(_(h[`team_${x}_id`])+" ",1),n("span",Xt,_(h[`team_${x}_score`]||0),1)])),64))]),n("span",Yt,_(i.$formatter.date.toDateTime(h.start_time*1e3)),1)]))),128))])])}}}),Kt={class:"tournament-team"},Qt={class:"tournament-team__inner"},Zt={class:"tournament-team__props-list"},zt={class:"tournament-team__props"},te={class:"tournament-team__props"},ee={class:"tournament-team__props"},ae={class:"tournament-team__player-list"},ne={key:0,class:"tournament-team__details"},se={class:"tournament-team__player-name"},oe={class:"tournament-team__player-stat"},ie={class:"tournament-team__stat-item"},le={key:1,class:"tournament-team__empty"},re=H({__name:"TournamentTeam",props:{tournament:{type:Object,default:()=>({}),required:!0},team:{type:Object,default:()=>({}),required:!0}},setup(m){const s=m,t=P({loading:0,players:[],statisticsAll:null});Y(()=>{const g=s.tournament.max_players_count;t.players=Array(g).fill($({})),I()});async function e(g){t.loading++;try{const{data:f}=await M.clan.getAccountInfo({extra:"clan",account_id:g.join(",")});return Object.values(f).filter(nt)}catch(f){return N(f,{title:"Поучение списка клановых аккаунтов"}),[]}finally{t.loading--}}async function r(g){t.loading++;try{const{data:f}=await M.account.getInfo({extra:"statistics.rating",account_id:g.join(",")});return Object.values(f).filter(nt)}catch(f){return N(f,{title:"Поучение списка аккаунтов"}),[]}finally{t.loading--}}function $(g){var A,i,c,y,v,h,x,d;const f=(A=g.account)==null?void 0:A.statistics.all,C=(i=g.account)==null?void 0:i.statistics.rating;return{id:((c=g.player)==null?void 0:c.account_id)??0,name:((y=g.player)==null?void 0:y.name)??"",isOwner:((v=g.player)==null?void 0:v.role)==="owner",clan:(h=g.clanAccount)!=null&&h.clan?{id:g.clanAccount.clan_id,tag:((x=g.clanAccount.clan)==null?void 0:x.tag)??"",name:((d=g.clanAccount.clan)==null?void 0:d.name)??""}:null,statistic:{all:f?K.accountAll(f):null,rating:C?K.accountRating(C):null}}}async function I(){const g=s.team.players.map(c=>c.account_id),[f,C]=await Promise.all([r(g),e(g)]),A=f.reduce((c,y,v)=>v===0?f[0].statistics:K.sumFull(c,y.statistics),{});t.statisticsAll=K.accountAll(A.all,f.length);const i=s.tournament.max_players_count;t.players=Array(i).fill({}).map((c,y)=>{const v=s.team.players[y],h=f.find(d=>d.account_id===(v==null?void 0:v.account_id)),x=C.find(d=>d.account_id===(v==null?void 0:v.account_id));return $({player:v,account:h,clanAccount:x})}).sort(c=>c.isOwner?1:0)}return(g,f)=>{var y,v;const C=$t,A=Tt,i=wt,c=Z;return u(),b("div",Kt,[n("div",Qt,[n("div",Zt,[n("div",zt,[f[0]||(f[0]=n("span",{class:"tournament-team__props-title"},"Статус",-1)),w(" "+_(g.$formatter.tournament.teamStatusDetails(m.team.status)),1)]),n("div",te,[f[1]||(f[1]=n("span",{class:"tournament-team__props-title"},"Ср. побед",-1)),S(C,{"win-rate":((y=o(t).statisticsAll)==null?void 0:y.winRate)||0},null,8,["win-rate"])]),n("div",ee,[f[2]||(f[2]=n("span",{class:"tournament-team__props-title"},"Ср. боёв",-1)),w(" "+_(g.$formatter.number.toInteger(((v=o(t).statisticsAll)==null?void 0:v.battles)||0)),1)])]),n("ul",ae,[(u(!0),b(O,null,E(o(t).players,(h,x)=>{var d;return u(),b("li",{key:h.id||x,class:"tournament-team__player"},[S(A,{width:"18",height:"18",class:"tournament-team__player-role",role:h.isOwner?"commander":"private"},null,8,["role"]),h.id?(u(),b("div",ne,[n("div",se,[S(i,{class:"tournament-team__player-link link",to:{name:"account-id",params:{id:h.id}}},{default:L(()=>[w(_(h.name),1)]),_:2},1032,["to"]),h.clan?(u(),F(i,{key:0,class:"tournament-team__player-link link",to:{name:"clan-id",params:{id:h.clan.id}}},{default:L(()=>{var k;return[w(_(`[${(k=h.clan)==null?void 0:k.tag}]`),1)]}),_:2},1032,["to"])):R("",!0)]),n("span",oe,[h.statistic.all?(u(),F(C,{key:0,class:"tournament-team__stat-item","win-rate":h.statistic.all.winRate},null,8,["win-rate"])):R("",!0),n("span",ie,_((d=h.statistic.all)==null?void 0:d.battles),1)])])):(u(),b("span",le," Место свободно "))])}),128))]),S(c,{"backdrop-light":"",loading:o(t).loading>0},null,8,["loading"])])])}}}),ce={class:"tournaments-teams"},ue={class:"tournaments-teams__filters"},me={class:"tournaments-teams__filters-item"},_e={class:"tournaments-teams__filters-item"},de={class:"tournaments-teams__count"},pe={class:"tournaments-teams__list"},ge=["onClick"],fe={class:"tournaments-teams__team-description"},he={class:"tournaments-teams__team-name"},be={class:"tournaments-teams__team-owner"},ye={class:"tournaments-teams__team-owner-text"},ve={class:"tournaments-teams__team-count"},$e=H({__name:"TournamentsTeams",props:{tournament:{type:Object,default:()=>({}),required:!0}},setup(m){const s=[null,"confirmed","forming","disqualified"],t=m,e=ut(null),r=P({loading:0,teams:[],currentTeam:null}),$=P({page:1,total:0,pageSize:50}),I=P({status:"confirmed",search:""}),g=s.map(d=>({label:d?U.tournament.teamStatus(d):"Все",value:d})),f=G(()=>$.total>$.page*$.pageSize);Y(()=>{window.addEventListener("scroll",y)}),mt(()=>{window.removeEventListener("scroll",y)});function C(d){var k;return(k=d.players.find(D=>D.role==="owner"))==null?void 0:k.name}const A=St(i,1e3,{leading:!0});async function i(){await c()}async function c(){r.loading++;try{const{data:d,meta:k}=await M.tournaments.getTeams({tournament_id:t.tournament.tournament_id,limit:$.pageSize,page_no:$.page,...I});$.total=k.total,r.teams.push(...d)}catch(d){N(d,{title:"Получение списка команд"})}r.loading--}function y(){if(!r.teams.length)return;const{scrollTop:d,scrollHeight:k,clientHeight:D}=document.documentElement;r.loading===0&&f.value&&f.value&&d+D>=k-100&&($.page+=1,c())}function v(){$.page=1,r.teams=[],i()}async function h(d=""){I.search=d=d.trim(),!(d.length<2&&d!=="")&&($.page=1,r.teams=[],await A())}function x(d){var k;r.currentTeam=d,(k=e.value)==null||k.doOpen()}return(d,k)=>{var p;const D=z,W=vt,B=Z,a=re,l=kt;return u(),b("div",ce,[n("div",ue,[n("div",me,[k[0]||(k[0]=w(" Статус ")),S(D,{"model-value":o(I).status,style:{width:"220px"},options:o(g),onChange:v},null,8,["model-value","options"])]),n("div",_e,[k[1]||(k[1]=w(" Поиск ")),S(W,{"model-value":o(I).search,type:"search",placeholder:"Введите название команды",style:{width:"300px"},onInput:h},null,8,["model-value"])])]),n("div",de,[k[2]||(k[2]=n("div",{class:"tournaments-teams__count-title"}," Кол-во: ",-1)),w(" "+_(o($).total||0),1)]),n("div",pe,[(u(!0),b(O,null,E(o(r).teams,T=>(u(),b("button",{key:T.team_id,class:"tournaments-teams__team",onClick:q=>x(T)},[n("span",{class:Q(["tournaments-teams__status",[T.status?`tournaments-teams__status--${T.status}`:""]])},null,2),n("span",fe,[n("span",he,_(T.title),1),n("span",be,[n("span",ye,_(C(T)),1)])]),n("span",ve,_(T.players.length)+" / "+_(m.tournament.max_players_count),1)],8,ge))),128)),S(B,{loading:o(r).loading>0},null,8,["loading"])]),S(l,{ref_key:"teamDialogRef",ref:e,width:"500px",title:(p=o(r).currentTeam)==null?void 0:p.title},{default:L(()=>[o(r).currentTeam?(u(),F(a,{key:0,tournament:m.tournament,team:o(r).currentTeam},null,8,["tournament","team"])):R("",!0)]),_:1},8,["title"])])}}});function Te(m,s,t){var e=-1,r=m.length;s<0&&(s=-s>r?0:r+s),t=t>r?r:t,t<0&&(t+=r),r=s>t?0:t-s>>>0,s>>>=0;for(var $=Array(r);++e<r;)$[e]=m[e+s];return $}var we=Te,ke=_t,Se=dt,Ie=pt,Ce=gt;function Ae(m,s,t){if(!Ce(t))return!1;var e=typeof s;return(e=="number"?Se(t)&&Ie(s,t.length):e=="string"&&s in t)?ke(t[s],m):!1}var xe=Ae,Oe=It,ot=1/0,Re=17976931348623157e292;function Ge(m){if(!m)return m===0?m:0;if(m=Oe(m),m===ot||m===-ot){var s=m<0?-1:1;return s*Re}return m===m?m:0}var De=Ge,qe=De;function Le(m){var s=qe(m),t=s%1;return s===s?t?s-t:s:0}var Ee=Le,Me=we,Ne=xe,je=Ee,Ue=Math.ceil,Fe=Math.max;function Pe(m,s,t){(t?Ne(m,s,t):s===void 0)?s=1:s=Fe(je(s),0);var e=m==null?0:m.length;if(!e||s<1)return[];for(var r=0,$=0,I=Array(Ue(e/s));r<e;)I[$++]=Me(m,r,r+=s);return I}var Ve=Pe;const Be=ft(Ve),He={class:"tournaments-tables"},We={class:"tournaments-tables__filters"},Xe={class:"tournaments-tables__filters-item"},Ye={class:"tournaments-tables__filters-item"},Je={class:"tournaments-tables__stage-state"},Ke={key:0,class:"tournaments-tables__table-scroll"},Qe={key:0,class:"tournaments-tables__table-round-title"},Ze=["onClick"],ze={class:"tournaments-tables__table-team-details"},ta={class:"tournaments-tables__table-team-title"},ea={class:"tournaments-tables__table-team-score"},aa={class:"tournaments-tables__table-team-details"},na={class:"tournaments-tables__table-team-title"},sa=H({__name:"TournamentsTables",props:{tournamentId:{type:[String,Number],default:"",required:!0},stages:{type:Array,default:()=>[],required:!0}},setup(m){const s=m,t=P({loading:0,standings:[],tables:[],matches:[],selectedStage:null,selectedGroup:null,tableOne:[],tableTwo:[],highlightTeamId:null,total:0,standingsTotal:0}),e=G(()=>t.tables.filter(a=>{var l;return a.group_id===((l=t.selectedGroup)==null?void 0:l.group_id)})),r=G(()=>e.value.map(a=>{const l=t.standings.find(p=>a.team_id===p.team_id&&p.group_id===a.group_id);return{...a,wins:(l==null?void 0:l.wins)??0,draws:(l==null?void 0:l.draws)??0,losses:(l==null?void 0:l.losses)??0}})),$=[{key:"position",label:"#",width:40,align:"center"},{key:"name",label:"Команда"},{key:"matches_played",label:"Бои",width:60,align:"center"},{key:"wins",label:"Победы",width:60,align:"center"},{key:"draws",label:"Ничьи",width:60,align:"center"},{key:"losses",label:"Пораж.",width:60,align:"center"},{key:"team_points",label:"Очки",width:60,align:"center"}],I=G(()=>s.stages.map(a=>({label:a.title,value:a,disabled:!["complete","schedule_ready"].includes(a.state)}))),g=G(()=>t.selectedStage?t.selectedStage.groups.map(a=>({label:`Группа ${a.group_order}`,value:a})):[]),f=G(()=>{var a;switch((a=t.selectedStage)==null?void 0:a.state){case"draft":return"Проект создан";case"groups_ready":return"Группы сформированы";case"schedule_ready":return"График построен";case"complete":return"Этап завершён";default:return"..."}});Y(async()=>{var a;t.selectedStage=c(),t.selectedGroup=((a=t.selectedStage)==null?void 0:a.groups[0])??null,await y(),A()});function C(a){var p;const l=(p=t.selectedStage)==null?void 0:p.type;if(l==="SE"){if(a===1)return"Финал";if(a===2)return"Полуфинал";if(a===3)return"Четвертьфинал";if(a===-1)return"Матч за третье место"}if(l==="DE"){if(a===3)return"Верхняя сетка | Четвертьфинал";if(a===2)return"Верхняя сетка | Полуфинал";if(a===1)return"Верхняя сетка | Финал";if(a===0)return"Гранд-Финал";if(a===-1)return"Нижняя сетка | Финал";if(a===-2)return"Нижняя сетка | Полуфинал";if(a===-3)return"Нижняя сетка | Четвертьфинал"}return""}function A(){t.tableOne=[[],[],[],[]],t.tableTwo=[[],[],[],[]],t.matches.forEach(a=>{const l=t.tables.find(q=>q.team_id===a.team_1_id),p=t.tables.find(q=>q.team_id===a.team_2_id);if(!l||!p)return;const T={...a,teams:[l,p]};a.round===3&&t.tableOne[0].push(T),a.round===2&&t.tableOne[1].push(T),a.round===1&&t.tableOne[2].push(T),a.round===-3&&t.tableTwo[0].push(T),a.round===-2&&t.tableTwo[1].push(T),a.round===-1&&t.tableTwo[2].push(T),a.round===0&&t.tableTwo[3].push(T)})}function i(a,l){return l.team_id===a.winner_team_id}function c(){const a=s.stages.findLast(p=>p.state==="schedule_ready"),l=s.stages.findLast(p=>p.state==="complete");return a??l??s.stages[0]}async function y(){var p,T,q;const a=(p=t.selectedStage)==null?void 0:p.stage_id,l=(T=t.selectedGroup)==null?void 0:T.group_id;!a||!l||(await d({tournament_id:s.tournamentId,group_id:l,stage_id:a}),((q=t.selectedStage)==null?void 0:q.type)==="RR"?await h({tournament_id:s.tournamentId,team_id:e.value.map(J=>J.team_id).join(",")}):await v({tournament_id:s.tournamentId,group_id:l,stage_id:a}))}async function v(a){t.loading++;try{const{data:l}=await M.tournaments.getMatches({...a,limit:25});t.matches=l}catch(l){N(l,{title:"Получение матчей"})}t.loading--}async function h(a){const l=Be(String(a.team_id).split(","),10);for(const p of l)await x({...a,team_id:p.join(",")})}async function x(a){t.loading++;try{const{data:l,meta:p}=await M.tournaments.getStandings({...a,limit:25});t.standings.push(...l),t.standingsTotal=p.total}catch(l){N(l,{title:"Получение результатов команд"})}t.loading--}async function d(a){let l=1;const p=25,T=async()=>{await k({...a,page_no:l,limit:p}),t.total>l*p&&(l++,await T())};await T()}async function k(a){t.loading++;try{const{data:l,meta:p}=await M.tournaments.getTables(a);t.tables.push(...l),t.total=p.total}catch(l){N(l,{title:"Получение турнирной сетки"})}t.loading--}async function D(a){t.selectedStage=a,t.selectedGroup=a.groups[0],t.tableOne=[[],[],[],[]],t.tableTwo=[[],[],[],[]],t.standings=[],t.tables=[],t.matches=[],await y(),t.selectedStage.type!=="RR"&&A()}async function W(a){t.selectedGroup=a,t.selectedStage&&(t.selectedStage.type==="RR"?(t.standings=[],await h({tournament_id:s.tournamentId,team_id:e.value.map(l=>l.team_id).join(",")})):(t.tableOne=[[],[],[],[]],t.tableTwo=[[],[],[],[]],t.matches=[],await v({tournament_id:s.tournamentId,group_id:a.group_id,stage_id:t.selectedStage.stage_id}),A()))}function B(a){t.highlightTeamId=a.team_id}return(a,l)=>{var J,tt;const p=z,T=Ct,q=Z;return u(),b("div",He,[n("div",We,[n("div",Xe,[w(" Этап ("+_(o(t).total??0)+") ",1),S(p,{"model-value":o(t).selectedStage,"id-key":"stage_id",style:{width:"250px"},options:o(I),disabled:!o(I).length,onChange:D},null,8,["model-value","options","disabled"])]),n("div",Ye,[w(" Группа ("+_(((J=o(t).selectedStage)==null?void 0:J.groups.length)??"---")+") ",1),S(p,{"model-value":o(t).selectedGroup,"id-key":"group_id",style:{width:"170px"},disabled:!o(g).length,options:o(g),onChange:W},null,8,["model-value","disabled","options"])])]),n("div",Je,[l[0]||(l[0]=n("span",{class:"tournaments-tables__stage-state-label"}," Состояние этапа ",-1)),w(" "+_(o(f)),1)]),((tt=o(t).selectedStage)==null?void 0:tt.type)!=="RR"?(u(),b("div",Ke,[(u(!0),b(O,null,E([o(t).tableOne,o(t).tableTwo],(V,et)=>(u(),b("div",{key:et,class:Q(["tournaments-tables__table",[`tournaments-tables__table--${et?"bottom":"top"}`]])},[(u(!0),b(O,null,E(V,(it,lt)=>(u(),b("div",{key:lt,class:"tournaments-tables__table-round"},[(u(!0),b(O,null,E(it,(X,rt)=>(u(),b("div",{key:X.id,class:"tournaments-tables__table-battle"},[rt===0?(u(),b("div",Qe,_(C(X.round)),1)):R("",!0),(u(!0),b(O,null,E(X.teams,(j,at)=>(u(),b("button",{key:at,class:Q(["tournaments-tables__table-team",[i(X,j)?"tournaments-tables__table-team--is-winner":"",j.team_id===o(t).highlightTeamId?"tournaments-tables__table-team--is-highlight":""]]),onClick:ya=>B(j)},[n("span",ze,[S(st,{class:"tournaments-tables__table-team-clan-emblem",alt:j.clan_label,emblem:j.clan_emblem_preset_id},null,8,["alt","emblem"]),n("span",ta,[j.clan_label?(u(),b(O,{key:0},[w(" ["+_(j.clan_label)+"] ",1)],64)):R("",!0),w(" "+_(j.title),1)])]),n("span",ea,_(X[`team_${at+1}_score`]??"-"),1)],10,Ze))),128))]))),128))]))),128))],2))),128))])):(u(),F(T,{key:1,"no-wrap":"","scroll-auto-disabling":"","row-key":"account_id",height:"calc(100vh - 112px)",headers:$,data:o(r)},{name:L(({row:V})=>[n("div",aa,[S(st,{class:"tournaments-tables__table-team-clan-emblem",alt:V.clan_label,emblem:V.clan_emblem_preset_id},null,8,["alt","emblem"]),n("span",na,[V.clan_label?(u(),b(O,{key:0},[w(" ["+_(V.clan_label)+"] ",1)],64)):R("",!0),w(" "+_(V.title),1)])])]),_:1},8,["data"])),S(q,{loading:o(t).loading>0},null,8,["loading"])])}}}),oa={key:0,class:"tournaments-info-page__inner"},ia={class:"tournaments-info-page__header"},la={class:"tournaments-info-page__details"},ra={class:"tournaments-info-page__title"},ca={class:"tournaments-info-page__props"},ua={class:"tournaments-info-page__prop"},ma={class:"tournaments-info-page__prop-title"},_a={class:"tournaments-info-page__props"},da={class:"tournaments-info-page__prop"},pa={class:"tournaments-info-page__body"},ga=["textContent"],fa={class:"tournaments-info-page__body"},ha={class:"tournaments-info-page__body"},ba={class:"tournaments-info-page__body"},Qa=H({__name:"[id]",setup(m){ht({title:"Турнир"});const s=bt(),t=yt(),e=P({loading:0,tournament:null,stages:[],activeTab:"info"}),r=G(()=>{var c,y;const i=[{label:"Описание",name:"info"},{label:"Команды",name:"teams",disabled:((c=e.tournament)==null?void 0:c.status)==="upcoming"}];return e.stages.length&&i.push({label:"Сетка",name:"tables",disabled:!["running","finished","complete"].includes(((y=e.tournament)==null?void 0:y.status)??"")}),i}),$=G(()=>{var i;switch((i=e.tournament)==null?void 0:i.status){case"upcoming":return{title:"Начало регистрации",date:U.date.toDateTime(e.tournament.registration_start_at*1e3)};case"registration_started":return{title:"Окончание регистрации",date:U.date.toDateTime(e.tournament.registration_end_at*1e3)};case"registration_finished":return{title:"Начало мачей",date:U.date.toDateTime(e.tournament.matches_start_at*1e3)};case"running":return{title:"Завершение",date:U.date.toDateTime(e.tournament.end_at*1e3)};case"finished":case"complete":return{title:"Завершен",date:U.date.toDateTime(e.tournament.end_at*1e3)}}return{title:"---",date:"---"}});Y(async()=>{var c;const i=(c=s.query)==null?void 0:c.activeTab;C(i||r.value[0].name),await I()});async function I(){const i=s.params.id;i&&await Promise.all([g(i),f(i)])}async function g(i){e.loading++;try{const{data:c}=await M.tournaments.getInfo({tournament_id:i});e.tournament=c[i]??null}catch(c){N(c,{title:"Получение информации турнира"})}e.loading--}async function f(i){e.loading++;try{const{data:c}=await M.tournaments.getStages({tournament_id:i});e.stages=c??[]}catch(c){N(c,{title:"Получение этапов турнира"})}e.loading--}function C(i){var c;e.activeTab=i,((c=s.query)==null?void 0:c.activeTab)!==i&&t.replace({query:{...s.query,activeTab:i}})}function A({name:i}){C(i)}return(i,c)=>{const y=ct,v=jt,h=Jt,x=$e,d=sa,k=At,D=Z,W=xt;return u(),F(W,{class:"tournaments-info-page"},{default:L(()=>{var B,a,l,p;return[o(e).tournament?(u(),b("div",oa,[n("div",ia,[S(y,{src:o(e).tournament.logo.original,alt:"Tournament IMG",class:"tournaments-info-page__img"},null,8,["src"]),n("div",la,[n("h1",ra,_((B=o(e).tournament)==null?void 0:B.title),1),n("div",ca,[n("div",ua,[n("div",ma,_(o($).title),1),w(" "+_(o($).date),1)])]),n("div",_a,[n("div",da,[c[1]||(c[1]=n("div",{class:"tournaments-info-page__prop-title"}," Команд ",-1)),w(" "+_(((a=o(e).tournament)==null?void 0:a.teams.confirmed)||0)+" / "+_(((l=o(e).tournament)==null?void 0:l.teams.total)||0)+" / "+_(((p=o(e).tournament)==null?void 0:p.teams.max)||0),1)])])])]),S(k,{modelValue:o(e).activeTab,"onUpdate:modelValue":c[0]||(c[0]=T=>o(e).activeTab=T),tabs:o(r),onTabClick:A},{info:L(()=>[n("div",pa,[o(e).stages.length?(u(),F(v,{key:0,stages:o(e).stages,class:"tournaments-info-page__stages","tournament-id":o(e).tournament.tournament_id},null,8,["stages","tournament-id"])):R("",!0),n("div",{class:"tournaments-info-page__description",textContent:_(o(e).tournament.description)},null,8,ga)])]),matches:L(()=>[n("div",fa,[o(e).stages.length?(u(),F(h,{key:0,stages:o(e).stages,"tournament-id":o(e).tournament.tournament_id},null,8,["stages","tournament-id"])):R("",!0)])]),teams:L(()=>[n("div",ha,[S(x,{tournament:o(e).tournament},null,8,["tournament"])])]),tables:L(()=>[n("div",ba,[o(e).stages.length?(u(),F(d,{key:0,"tournament-id":o(e).tournament.tournament_id,stages:o(e).stages},null,8,["tournament-id","stages"])):R("",!0)])]),_:1},8,["modelValue","tabs"])])):R("",!0),S(D,{loading:o(e).loading>0},null,8,["loading"])]}),_:1})}}});export{Qa as default};
