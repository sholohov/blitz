import{d as q,r as B,j as E,an as F,k as R,z as U,o as l,n,ao as x,M as c,f,F as v,B as S,p as $,H as p,q as H,t as T,g as M,x as G,e as J,a4 as P}from"./CbpaTVLF.js";import{i as Q}from"./BYsS9vqb.js";import{d as V}from"./DD4asW33.js";const W={key:0,class:"ui-table-mobile__header"},X={key:1,class:"ui-table-mobile__head"},Y={class:"ui-table-mobile__sort"},Z=["title","onClick"],ee={key:0,class:"ui-table-mobile__sort-icons"},te={key:0,class:"ui-table-mobile__summary"},ae={key:2,class:"ui-table-mobile__no-data"},se={key:3,class:"ui-table-mobile__footer"},le=q({__name:"UiTableMobile",props:{data:{type:Array,required:!0,default:()=>[]},headers:{type:Array,default:()=>[]},summary:{type:Object,default:void 0},defaultSort:{type:Object,default:void 0},scrollAutoDisabling:{type:Boolean,default:!1},scrollToTop:{type:Boolean,default:!1},hideHeaders:{type:Boolean,default:!1},height:{type:String,default:void 0},rowKey:{type:String,default:void 0},maxHeight:{type:String,default:void 0},minHeight:{type:String,default:void 0}},emits:["sort","row-click"],setup(o,{expose:j,emit:z}){var A,C;const r=o,m=B(),y=B([]),d=E({order:((A=r.defaultSort)==null?void 0:A.order)??"",prop:((C=r.defaultSort)==null?void 0:C.prop)??""});F(()=>{var e;y.value=r.data,_(),r.scrollToTop&&((e=m.value)==null||e.scrollTo({top:0}))});let b=null;function D(){m.value&&(b=Q({target:[m.value],threshold:1,callback(e){const t=e.target;e.isIntersecting?V(!1,t):(V(!0,t),t.scrollTo({top:0}))}}))}R(()=>{r.scrollAutoDisabling&&D()}),U(()=>{r.scrollAutoDisabling&&(b==null||b.disconnect())});const g=(e="default")=>!!x()[e];function _(){var a;let e=d.order,t=d.prop;e===""&&r.defaultSort&&(e=r.defaultSort.order,t=r.defaultSort.prop);const s=(a=r.headers)==null?void 0:a.find(u=>u.key===t);s&&(typeof s.sortMethod=="function"?y.value.sort((u,i)=>{var h,k;return e==="desc"?((h=s.sortMethod)==null?void 0:h.call(s,i,u))||0:((k=s.sortMethod)==null?void 0:k.call(s,u,i))||0}):s.sortable===!0&&y.value.sort((u,i)=>{const h=(e==="desc"?i:u)[t],k=(e==="desc"?u:i)[t];return String(h).localeCompare(String(k),void 0,{numeric:!0,sensitivity:"base"})}))}const I=z;function N(e){let t=e.key,s=d.order;d.prop!==t&&(s=""),s?s==="asc"?s="desc":(s="",t=""):s="asc",d.order=s,d.prop=t}function K(e){var t;e.sortable&&((t=m.value)==null||t.scrollTo({top:0}),N(e),_(),I("sort",{...d,column:e}))}function L(e,t){return typeof e.formatter=="function"?e.formatter(t):t}function w(e,t){return d.order===e&&d.prop===t}function O(e){return typeof r.summary!="object"||!Object.keys(r.summary).includes(e.key)?"":typeof e.formatter=="function"?e.formatter(r.summary[e.key]):r.summary[e.key]}return j({sortItems:_}),(e,t)=>{const s=G;return l(),n("div",{class:"ui-table-mobile",style:P({height:o.height,maxHeight:o.maxHeight,minHeight:o.minHeight})},[g("header")?(l(),n("div",W,[c(e.$slots,"header")])):f("",!0),o.headers.length&&!o.hideHeaders?(l(),n("ul",X,[(l(!0),n(v,null,S(o.headers,a=>(l(),n("li",{key:a.key,class:"ui-table-mobile__head-item"},[$("div",Y,[$("button",{title:a.tooltip,class:p(["ui-table-mobile__sort-btn",[a.sortable?"ui-table-mobile__sort-btn--has-sort":""]]),onClick:u=>K(a)},[c(e.$slots,`${a.key}-header`,{},()=>[H(T(a.label),1)])],10,Z),a.sortable?(l(),n("span",ee,[M(s,{size:"16",name:"arrow-up",class:p(["ui-table-mobile__sort-icon",[w("asc",a.key)?"is-active":""]])},null,8,["class"]),M(s,{size:"16",name:"arrow-down",class:p(["ui-table-mobile__sort-icon",[w("desc",a.key)?"is-active":""]])},null,8,["class"])])):f("",!0)]),o.summary?(l(),n("div",te,[c(e.$slots,`${a.key}-summary`,{},()=>[H(T(O(a)),1)])])):f("",!0)]))),128))])):f("",!0),$("ul",{ref_key:"tableListRef",ref:m,class:"ui-table-mobile__list"},[(l(!0),n(v,null,S(J(y),(a,u)=>(l(),n("li",{key:String(o.rowKey?a[o.rowKey]:u),class:"ui-table-mobile__row"},[g("default")?c(e.$slots,"default",{key:0,row:a,data:null,index:u}):(l(!0),n(v,{key:1},S(o.headers,i=>(l(),n("td",{key:i.key,class:p(["ui-table-mobile__cell",[i.rowClass?i.rowClass:""]])},[a?c(e.$slots,`${i.key}`,{key:0,row:a,data:a[i.key],index:u},()=>[H(T(L(i,a[i.key])),1)]):f("",!0)],2))),128))]))),128))],512),Array.isArray(o.data)&&o.data.length?f("",!0):(l(),n("div",ae," Нет данных ")),g("footer")?(l(),n("div",se,[c(e.$slots,"footer")])):f("",!0)],4)}}});export{le as _};
