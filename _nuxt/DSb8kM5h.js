import{w as kt,u as ft,_ as Dt}from"./tkvQsply.js";import{d as E,o as g,m as U,n as t,h as a,v as x,R as Et,_ as G,c as q,x as bt,f as l,e as K,w as i,t as V,y as tt,z as lt,A as ot,F as D,D as dt,I as Z,r as j,k as F,g as N,E as z,S as Ht,C as Y,u as jt,j as Nt,M as qt,T as ht,i as At,H as vt,U as zt,G as yt,s as Kt}from"./DEnf58KD.js";import{_ as Ft}from"./DhxSjBWF.js";import{_ as ct}from"./DBMgnr_1.js";import{_ as rt,a as et,b as wt}from"./D95QyyOX.js";import{_ as Tt}from"./BUTcSoIg.js";import{_ as Gt}from"./BYDdsp9A.js";import{_ as Lt}from"./CfjgP0ko.js";import{u as mt}from"./Cztf3jdt.js";import{_ as Xt}from"./BqHuitxL.js";import{_ as $t}from"./Bw-LhXCx.js";import{_ as Jt}from"./CcapLji2.js";import{_ as Qt}from"./BfqZGrhM.js";import{_ as Yt}from"./BZetK0s1.js";import{_ as ut}from"./BIawf2pc.js";import{d as Zt}from"./CKeGCx3Z.js";import{s as M}from"./BLrdWoSV.js";import{_ as te}from"./CzC-342G.js";import{u as ee}from"./BeyRNKC8.js";import{_ as gt}from"./DzVGHTjI.js";import"./Dbl4fPep.js";import"./CttXHyuz.js";import"./DlAUqK2U.js";import"./DD4asW33.js";import"./CZtbIH5E.js";import"./CRnLVDZ5.js";import"./Co0YW0xm.js";import"./CmW1s-xp.js";import"./DzXMkOgy.js";import"./Dqed49L3.js";import"./BE0-VfMS.js";import"./uZwePpIY.js";import"./D2AYo3hX.js";const ae={class:"hand-statistic-tank-preview__img-wrapper"},se={class:"hand-statistic-tank-preview__description"},ne={class:"hand-statistic-tank-preview__description-tank"},ie={class:"hand-statistic-tank-preview__name"},le={class:"hand-statistic-tank-preview__name-text"},oe={class:"hand-statistic-tank-preview__description-tank"},de={class:"hand-statistic-tank-preview__props"},ce={class:"hand-statistic-tank-preview__prop"},re={class:"hand-statistic-tank-preview__prop-value"},me={class:"hand-statistic-tank-preview__prop"},ue={class:"hand-statistic-tank-preview__prop-value"},_e={class:"hand-statistic-tank-preview__prop"},pe={class:"hand-statistic-tank-preview__prop-value"},ke=E({__name:"HandStatisticTankPreview",props:{tank:{type:Object,default:()=>({}),required:!0}},setup(p){return(k,r)=>{const h=ct,f=et,u=G,b=Tt;return g(),U("div",Et({class:"hand-statistic-tank-preview"},k.$attrs),[t("div",ae,[a(h,{class:"hand-statistic-tank-preview__nation-img",src:`/img/nations/nation-${p.tank.nation}.svg`,alt:p.tank.nation},null,8,["src","alt"]),a(h,{class:"hand-statistic-tank-preview__tank-img",src:p.tank.images.preview,alt:p.tank.name},null,8,["src","alt"]),a(rt,{class:"hand-statistic-tank-preview__tier",tier:p.tank.tier},null,8,["tier"])]),t("div",se,[t("div",ne,[t("div",ie,[a(f,{type:p.tank.type,class:"hand-statistic-tank-preview__type","is-premium":p.tank.is_premium,"is-collectible":p.tank.is_collectible},null,8,["type","is-premium","is-collectible"]),t("span",le,x(p.tank.name??`Tank ID: ${p.tank.tank_id}`),1)])]),t("div",oe,[t("div",de,[t("span",ce,[a(u,{name:"sword-cross",size:"18"}),t("span",re,x(k.$formatter.number.toInteger(p.tank.stat.battles)),1)]),t("span",me,[a(u,{name:"flag-variant",size:"18"}),t("span",ue,[a(b,{"win-rate":p.tank.stat.winRate},null,8,["win-rate"])])]),t("span",_e,[a(u,{name:"destruction",size:"18"}),t("span",pe,x(k.$formatter.number.toInteger(p.tank.stat.damagePerBattle)),1)])])])])],16)}}}),fe={class:"hand-statistic-tank-table__row"},he={class:"hand-statistic-tank-table__tank"},ve={class:"hand-statistic-tank-table__name"},ye={class:"hand-statistic-tank-table__diff"},ge={style:{display:"flex",gap:"10px"}},be=E({__name:"HendStatisticTankTable",props:{items:{type:Array,default:()=>[],required:!0}},emits:["pressEdit"],setup(p,{emit:k}){const r={prop:"lastUpdateTime",order:"asc"},h=mt(),f=q(()=>h.isTablet),{$formatter:u}=bt(),b=[{key:"name",label:"Танк",sortable:!0},{key:"type",label:"Тип",sortable:!0},{key:"tier",label:"I-X",sortable:!0},{key:"battles",label:u.stat.accountProp("battles"),sortable:!0,sortMethod(e,c){const v=e,y=c;return v.stat.battles-y.stat.battles}},{key:"winRate",label:u.stat.accountProp("wins"),sortable:!0,sortMethod(e,c){const v=e,y=c;return v.stat.winRate-y.stat.winRate}},{key:"damagePerBattle",label:u.stat.accountProp("damage_dealt"),sortable:!0,sortMethod(e,c){const v=e,y=c;return v.stat.damagePerBattle-y.stat.damagePerBattle}},{key:"lastUpdateTime",label:"Дата обновления",sortable:!0,sortMethod(e,c){return c.lastUpdateTime-e.lastUpdateTime}},{key:"controls",label:"",width:100}],w=[{key:"battles",label:u.stat.accountProp("battles"),sortable:!0,sortMethod(e,c){const v=e,y=c;return v.stat.battles-y.stat.battles}},{key:"winRate",label:u.stat.accountProp("wins"),sortable:!0,sortMethod(e,c){const v=e,y=c;return v.stat.winRate-y.stat.winRate}},{key:"damagePerBattle",label:u.stat.accountProp("damage_dealt"),sortable:!0,sortMethod(e,c){const v=e,y=c;return v.stat.damagePerBattle-y.stat.damagePerBattle}},{key:"lastUpdateTime",label:"Дата обновления",sortable:!0,sortMethod(e,c){return c.lastUpdateTime-e.lastUpdateTime}}],o=k;return(e,c)=>{const v=ke,y=Gt,B=et,m=rt,O=ct,T=Tt,d=G,W=tt,P=Lt;return l(f)?(g(),K(y,{key:0,class:"hand-statistic-tank-table",headers:w,data:p.items,"default-sort":r},{default:i(({row:_})=>[a(v,{tank:_,onClick:I=>o("pressEdit",_)},null,8,["tank","onClick"])]),_:1},8,["data"])):(g(),K(P,{key:1,class:"hand-statistic-tank-table",headers:b,data:p.items,"default-sort":r},{type:i(({row:_})=>[a(B,{size:"24",type:_.type,"is-premium":_.is_premium,"is-collectible":_.is_collectible},null,8,["type","is-premium","is-collectible"])]),tier:i(({row:_})=>[a(m,{tier:_.tier},null,8,["tier"])]),name:i(({row:_})=>{var I;return[t("div",fe,[t("div",he,[a(O,{class:"hand-statistic-tank-table__tank-nation",src:`/img/nations/nation-${_.nation}.svg`,alt:_.nation},null,8,["src","alt"]),a(O,{class:"hand-statistic-tank-table__tank-img",alt:_.name,src:(I=_.images)==null?void 0:I.preview},null,8,["alt","src"])]),t("span",ve,x(_.name),1)])]}),battles:i(({row:_})=>[t("span",null,x(l(u).number.toInteger(_.stat.battles)),1)]),winRate:i(({row:_})=>[a(T,{"win-rate":_.stat.winRate},null,8,["win-rate"])]),damagePerBattle:i(({row:_})=>[V(x(l(u).number.toInteger(_.stat.damagePerBattle)),1)]),lastUpdateTime:i(({row:_})=>[V(x(l(u).date.toRelativeTime(_.lastUpdateTime)||"---")+" ",1),t("div",ye,x(l(u).date.toDateTime(_.lastUpdateTime)||"---"),1)]),controls:i(({row:_})=>[t("div",ge,[a(W,{onClick:I=>o("pressEdit",_)},{before:i(()=>[a(d,{name:"edit"})]),default:i(()=>[c[0]||(c[0]=V(" Изменить "))]),_:2},1032,["onClick"]),c[1]||(c[1]=t("div",null,null,-1))])]),_:1},8,["data"]))}}}),we=E({__name:"NationSelect",props:lt({noWrap:{type:Boolean,default:!1,required:!1}},{modelValue:{required:!0,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(p){const k=ot(p,"modelValue"),r=["ussr","germany","usa","uk","japan","china","france","european","other"];function h(f,u){u?k.value.push(f):k.value=[...k.value.filter(b=>b!==f)]}return(f,u)=>{const b=wt,w=ut;return g(),U("div",{class:Z(["nation-select",[p.noWrap?"nation-select--no-wrap":""]])},[(g(),U(D,null,dt(r,o=>{var e;return a(w,{key:o,"model-value":!!((e=k.value)!=null&&e.includes(o)),onChange:c=>h(o,c)},{default:i(()=>[a(b,{nation:o},null,8,["nation"])]),_:2},1032,["model-value","onChange"])}),64))],2)}}}),Te=E({__name:"TypeSelect",props:lt({noWrap:{type:Boolean,default:!1,required:!1}},{modelValue:{required:!0,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(p){const k=ot(p,"modelValue"),r=["lightTank","mediumTank","heavyTank","AT-SPG"];function h(f,u){u?k.value.push(f):k.value=[...k.value.filter(b=>b!==f)]}return(f,u)=>{const b=et,w=ut;return g(),U("div",{class:Z(["type-select",[p.noWrap?"type-select--no-wrap":""]])},[(g(),U(D,null,dt(r,o=>{var e;return a(w,{key:o,"model-value":!!((e=k.value)!=null&&e.includes(o)),onChange:c=>h(o,c)},{default:i(()=>[a(b,{type:o},null,8,["type"])]),_:2},1032,["model-value","onChange"])}),64))],2)}}}),$e={class:"hand-statistic-tank-select"},Ve={class:"hand-statistic-tank-select__body"},Se={class:"hand-statistic-tank-select__filters"},Ue={class:"hand-statistic-tank-select__filters-item"},xe={class:"hand-statistic-tank-select__filters-item"},Be={class:"hand-statistic-tank-select__filters-item"},Ce={class:"hand-statistic-tank-select__filters-item"},Re={class:"hand-statistic-tank-select__count"},Pe={key:0,class:"hand-statistic-tank-select__list",style:{display:"flex","align-items":"center","justify-content":"center"}},Ie={key:1,class:"hand-statistic-tank-select__list"},Me=["onClick","onKeyup"],Oe={class:"hand-statistic-tank-select__item-details"},We={class:"hand-statistic-tank-select__item-props"},De={key:2,class:"hand-statistic-tank-select__list",style:{display:"flex","align-items":"center","justify-content":"center"}},Ee={class:"hand-statistic-tank-select__controls"},He={class:"hand-statistic-tank-select__controls-row"},je=E({__name:"HandStatisticTankSelect",props:{items:{type:Object,default:()=>({}),required:!0},exclude:{type:Array,default:()=>[],required:!1}},emits:["select","cancel"],setup(p,{emit:k}){const r=j(),h=p,f=mt(),u=q(()=>f.isMobile),b=q(()=>Object.values(h.items).sort((T,d)=>d.tier-T.tier).filter(T=>[!T.name.startsWith("#"),!h.exclude.includes(T.tank_id),o.tiers.length?o.tiers.includes(T.tier):!0,o.types.length?o.types.includes(T.type):!0,o.nations.length?o.nations.includes(T.nation):!0].every(d=>d))),w=()=>({tiers:[],types:[],nations:[]}),o=F(w()),e=q(()=>!Zt(w(),o)),c=q(()=>o.tiers.length===0&&o.types.length===0&&o.nations.length===0),v=k;function y(T){let d="standard";return T.is_premium&&(d="premium"),T.is_collectible&&(d="collectible"),d}async function B(T,d){var W,P;v("select",T),await Ht(),(P=(W=r.value)==null?void 0:W[d+1])==null||P.focus()}function m(T){return h.exclude.includes(T.tank_id)}function O(){Object.assign(o,w())}return(T,d)=>{const W=Yt,P=we,_=Te,I=G,L=tt,at=ct,st=wt,A=et,nt=rt;return g(),U("div",$e,[t("div",Ve,[t("div",Se,[t("div",Ue,[a(W,{modelValue:l(o).tiers,"onUpdate:modelValue":d[0]||(d[0]=$=>l(o).tiers=$),"no-wrap":""},null,8,["modelValue"])]),t("div",xe,[a(P,{modelValue:l(o).nations,"onUpdate:modelValue":d[1]||(d[1]=$=>l(o).nations=$),"no-wrap":""},null,8,["modelValue"])]),t("div",Be,[a(_,{modelValue:l(o).types,"onUpdate:modelValue":d[2]||(d[2]=$=>l(o).types=$),"no-wrap":""},null,8,["modelValue"])]),t("div",Ce,[a(L,{title:"Сброс фильтров",disabled:!l(e),onClick:O},{before:i(()=>[a(I,{name:"close"})]),default:i(()=>[l(u)?N("",!0):(g(),U(D,{key:0},[V(" Сброс ")],64))]),_:1},8,["disabled"])])]),t("div",Re," Всего - "+x(Object.keys(h.items).length),1),l(c)?(g(),U("div",Pe," Выберите что-нибудь в фильтре... ")):l(b).length?(g(),U("div",Ie,[(g(!0),U(D,null,dt(l(b),($,X)=>(g(),U("div",{key:$.tank_id,ref_for:!0,ref_key:"itemsRef",ref:r,role:"button","aria-pressed":"false",class:Z(["hand-statistic-tank-select__item",[m($)?"hand-statistic-tank-select__item--excluded":""]]),tabindex:"0",onClick:it=>B($,X),onKeyup:z(it=>B($,X),["enter"])},[a(at,{class:"hand-statistic-tank-select__item-img",alt:$.name,src:$.images.preview},null,8,["alt","src"]),t("div",Oe,[t("div",{class:Z(["hand-statistic-tank-select__item-name",`hand-statistic-tank-select__item-name--${y($)}`])},x($.name),3),t("div",We,[a(st,{size:"18",nation:$.nation},null,8,["nation"]),a(A,{size:"24",type:$.type},null,8,["type"]),a(nt,{tier:$.tier},null,8,["tier"])])])],42,Me))),128))])):(g(),U("div",De," Ничего не найдено... "))]),t("div",Ee,[d[5]||(d[5]=t("div",{class:"hand-statistic-tank-select__controls-row"},null,-1)),t("div",He,[a(L,{onClick:d[3]||(d[3]=$=>v("cancel"))},{default:i(()=>d[4]||(d[4]=[V(" Закрыть ")])),_:1})])])])}}}),Ne={class:"hand-statistic-tank-edit"},qe={class:"hand-statistic-tank-edit__body"},Ae={class:"hand-statistic-tank-edit__params"},ze={class:"hand-statistic-tank-edit__params-item"},Ke={class:"hand-statistic-tank-edit__params-item"},Fe={class:"hand-statistic-tank-edit__params"},Ge={class:"hand-statistic-tank-edit__params-item"},Le={class:"hand-statistic-tank-edit__params-item"},Xe={class:"hand-statistic-tank-edit__params"},Je={class:"hand-statistic-tank-edit__params-item"},Qe={class:"hand-statistic-tank-edit__params-item"},Ye={class:"hand-statistic-tank-edit__params-item"},Ze={class:"hand-statistic-tank-edit__controls"},ta={class:"hand-statistic-tank-edit__controls-row"},ea=E({__name:"HandStatisticTankEdit",props:{modelValue:{required:!0,default:()=>({})},modelModifiers:{}},emits:lt(["close","save"],["update:modelValue"]),setup(p,{emit:k}){const r=ot(p,"modelValue"),h=F({isWin:!0}),f=F({damage_dealt:0,losses:0,wins:0});Y(()=>[r.value.stat],()=>{const{losses:o,wins:e}=r.value.stat;r.value.stat.battles=o+e,r.value.stat.winRate=M.winRate(r.value.stat),r.value.stat.damagePerBattle=M.damagePerBattle(r.value.stat)},{deep:!0});const u=k;function b(){u("close")}function w(){h.isWin?f.wins+=1:f.losses+=1,r.value.lastUpdateTime=Date.now(),r.value.stat=M.sum(r.value.stat,{...f,battles:f.losses+f.wins}),u("save",r.value)}return(o,e)=>{const c=$t,v=ut,y=G,B=tt;return g(),U("div",Ne,[t("div",qe,[t("div",Ae,[e[7]||(e[7]=t("div",{class:"hand-statistic-tank-edit__params-title"}," Информация ",-1)),t("div",ze,[e[5]||(e[5]=t("span",{class:"hand-statistic-tank-edit__params-item-title"}," Название танка: ",-1)),V(" "+x(r.value.name),1)]),t("div",Ke,[e[6]||(e[6]=t("span",{class:"hand-statistic-tank-edit__params-item-title"}," Дата обновления: ",-1)),V(" "+x(o.$formatter.date.toDateTime(r.value.lastUpdateTime)||"---"),1)])]),t("div",Fe,[e[11]||(e[11]=t("div",{class:"hand-statistic-tank-edit__params-title"}," Показатели за бой ",-1)),t("div",Ge,[e[8]||(e[8]=t("span",{class:"hand-statistic-tank-edit__params-item-title"}," Урон: ",-1)),a(c,{modelValue:l(f).damage_dealt,"onUpdate:modelValue":e[0]||(e[0]=m=>l(f).damage_dealt=m),width:"100px",min:"0",onKeyup:z(w,["enter"])},null,8,["modelValue"])]),t("div",Le,[e[10]||(e[10]=t("span",{class:"hand-statistic-tank-edit__params-item-title"}," Результат: ",-1)),a(v,{modelValue:l(h).isWin,"onUpdate:modelValue":e[1]||(e[1]=m=>l(h).isWin=m)},{default:i(()=>e[9]||(e[9]=[V(" Победа ")])),_:1},8,["modelValue"])])]),t("div",Xe,[e[15]||(e[15]=t("div",{class:"hand-statistic-tank-edit__params-title"}," Суммарные показатели ",-1)),t("div",Je,[e[12]||(e[12]=t("span",{class:"hand-statistic-tank-edit__params-item-title"}," Урон: ",-1)),a(c,{modelValue:r.value.stat.damage_dealt,"onUpdate:modelValue":e[2]||(e[2]=m=>r.value.stat.damage_dealt=m),width:"100px",min:"0",onKeyup:z(w,["enter"])},null,8,["modelValue"])]),t("div",Qe,[e[13]||(e[13]=t("span",{class:"hand-statistic-tank-edit__params-item-title"}," Побед: ",-1)),a(c,{modelValue:r.value.stat.wins,"onUpdate:modelValue":e[3]||(e[3]=m=>r.value.stat.wins=m),width:"100px",min:"0",onKeyup:z(w,["enter"])},null,8,["modelValue"])]),t("div",Ye,[e[14]||(e[14]=t("span",{class:"hand-statistic-tank-edit__params-item-title"}," Пораж.: ",-1)),a(c,{modelValue:r.value.stat.losses,"onUpdate:modelValue":e[4]||(e[4]=m=>r.value.stat.losses=m),width:"100px",min:"0",onKeyup:z(w,["enter"])},null,8,["modelValue"])])])]),t("div",Ze,[e[18]||(e[18]=t("div",{class:"hand-statistic-tank-edit__controls-row"},null,-1)),t("div",ta,[a(B,{onClick:b},{before:i(()=>[a(y,{name:"close"})]),default:i(()=>[e[16]||(e[16]=V(" Отмена "))]),_:1}),a(B,{onClick:w},{before:i(()=>[a(y,{name:"content-save"})]),default:i(()=>[e[17]||(e[17]=V(" Сохранить "))]),_:1})])])])}}}),aa={class:"hand-statistic-page__settings"},sa={key:0},na={class:"hand-statistic-page__params"},ia={class:"hand-statistic-page__params-item"},la={class:"hand-statistic-page__params-item-value"},oa={class:"hand-statistic-page__params-item"},da={class:"hand-statistic-page__params-item-value"},ca={class:"hand-statistic-page__params-item"},ra={class:"hand-statistic-page__params-item-value link",style:{"font-weight":"500"}},ma={style:{display:"flex","justify-content":"space-between"}},ua={style:{display:"flex","justify-content":"space-between"}},_a={style:{display:"flex",gap:"10px","text-align":"center"}},Ga=E({__name:"index",async setup(p){var _t;let k,r;const{$formatter:h}=bt();jt({title:[h.route.getTitle("hand-statistic")].join(" - ")});const f=j(),u=j(),b=j(),w=j(),o=Nt(),e=mt(),c=q(()=>e.isMobile),v=j([{key:"battles",label:h.stat.accountProp("battles"),value:0},{key:"winRate",label:h.stat.accountProp("winRate"),value:0},{key:"damagePerBattle",label:h.stat.accountProp("damagePerBattle"),value:0}]),y=ee(),B=qt(),m=F({tanks:[],currentTank:null}),O=ht("handleStatMetricsOpacity"),T=ht("handleStatMetricsWidth"),d=F({metricsOpacity:+O.value,metricsWidth:T.value});Y(()=>d.metricsOpacity,()=>{O.value=d.metricsOpacity}),Y(()=>d.metricsWidth,()=>{T.value=d.metricsWidth}),[k,r]=kt(async()=>ft("get-tanks-vehicles",async()=>await y.getTanksVehicles().then(()=>!0))),await k,r(),(_t=([k,r]=kt(()=>ft("get-handle-stat-tanks-list",()=>yt.handStat.tanks.get(o.accountId))),k=await k,r(),k).data.value)==null||_t.data.raw.forEach(n=>{var S;const s=(S=y.vehicles)==null?void 0:S[n.tankId];s&&m.tanks.push(I({tank:s,stat:n.stat,lastUpdateTime:n.lastBattleTime}))}),Y(()=>m.tanks,P,{deep:!0,immediate:!0});function P(){var s;let n={};m.tanks.forEach(S=>{n=M.sum(n,S.stat)}),(s=v.value)==null||s.forEach(S=>{S.key==="winRate"?S.value=M.winRate(n):S.key==="damagePerBattle"?S.value=M.damagePerBattle(n):S.value=n.battles??0})}function _(n){return{...n,battles:(n.losses||0)+(n.wins||0),winRate:M.winRate(n),damagePerBattle:M.damagePerBattle(n)}}function I(n){const s={...n.tank,stat:n.stat};return s.stat=_(s.stat),s.lastUpdateTime=n.lastUpdateTime,s}function L(){var n;(n=f.value)==null||n.doOpen()}function at(){var n;(n=b.value)==null||n.doOpen()}function st(){return{battles:0,damage_dealt:0,losses:0,wins:0,winRate:0,damagePerBattle:0}}async function A(n){try{return await yt.handStat.tanks.set(o.accountId,n.map(s=>({stat:s.stat,tankId:s.tank_id,lastBattleTime:s.lastUpdateTime}))),!0}catch(s){return Kt(s,{title:"Установка данных ручной статистики"}),!1}}async function nt(n){let s=[...m.tanks];m.tanks.some(C=>C.tank_id===n.tank_id)||(s=[{...n,lastUpdateTime:Date.now(),stat:st()},...s]),await A(s)&&(m.tanks=s,B.add({type:"success",message:"Техники успешно добавлена"}))}function $(){var n;(n=f.value)==null||n.doClose()}function X(n){var s;m.currentTank=vt(n),(s=u.value)==null||s.doOpen()}async function it(){var n;await((n=u.value)==null?void 0:n.doClose()),m.currentTank=null}async function Vt(){var C;if(!m.currentTank)return;const n=vt(m.currentTank);n.stat=_(n.stat);const s=m.tanks.findIndex(J=>J.tank_id===n.tank_id),S=[...m.tanks];s>=0&&S.splice(s,1,n),await A(S)&&(m.tanks=S,await((C=u.value)==null?void 0:C.doClose()),m.currentTank=null,B.add({type:"success",message:"Данные техники успешно обновлены"}))}function St(){var n;(n=w.value)==null||n.doOpen()}function Ut(){var n;(n=w.value)==null||n.doClose()}async function xt(){var n;m.tanks.length?await A([])&&(m.tanks=[],(n=w.value)==null||n.doClose(),B.add({type:"success",message:"Данные техники успешно обновлены"})):B.add({type:"info",message:"Нечего сбрасывать"})}function Bt(){zt({path:"/hand-statistic/widget",query:{accountId:o.accountId,opacity:d.metricsOpacity,width:d.metricsWidth}},{open:{target:"_blank"}})}return(n,s)=>{const S=Dt,H=G,C=tt,J=Ft,Ct=be,Rt=Xt,Pt=$t,It=Jt,Q=Qt,Mt=je,Ot=ea,Wt=te;return l(o).accountId?(g(),K(gt,{key:0,class:"hand-statistic-page"},{default:i(()=>[a(J,{title:"Средние показатели"},{default:i(()=>[a(S,{modelValue:l(v),"onUpdate:modelValue":s[0]||(s[0]=R=>At(v)?v.value=R:null),opacity:l(d).metricsOpacity,width:l(d).metricsWidth,class:"hand-statistic-page__average-list"},null,8,["modelValue","opacity","width"]),t("div",aa,[a(C,{title:"Добавить танк",onClick:L},{before:i(()=>[a(H,{name:"add"})]),default:i(()=>[l(c)?N("",!0):(g(),U(D,{key:0},[V(" Добавить танк ")],64))]),_:1}),a(C,{title:"Сброс",onClick:St},{before:i(()=>[a(H,{name:"refresh"})]),default:i(()=>[l(c)?N("",!0):(g(),U(D,{key:0},[V(" Сброс ")],64))]),_:1}),a(C,{title:"Настройки",onClick:at},{before:i(()=>[a(H,{name:"tune"})]),default:i(()=>[l(c)?N("",!0):(g(),U(D,{key:0},[V(" Настройки ")],64))]),_:1}),a(C,{title:"К виджету",onClick:Bt},{before:i(()=>[a(H,{name:"open-in-new"})]),default:i(()=>[l(c)?N("",!0):(g(),U("span",sa," К виджету "))]),_:1})])]),_:1}),a(J,{title:"Техника"},{default:i(()=>[a(Ct,{items:l(m).tanks,onPressEdit:X},null,8,["items"])]),_:1}),a(Q,{ref_key:"settingsDialogRef",ref:b,width:"480px",title:"Настройки"},{footer:i(()=>[t("div",ma,[s[9]||(s[9]=t("span",null,null,-1)),a(C,{onClick:s[3]||(s[3]=R=>{var pt;return(pt=l(b))==null?void 0:pt.doClose()})},{default:i(()=>s[8]||(s[8]=[V(" Закрыть ")])),_:1})])]),default:i(()=>[t("div",na,[t("div",ia,[s[5]||(s[5]=t("div",{class:"hand-statistic-page__params-item-title"}," Прозрачность фона виджета ",-1)),t("div",la,[a(Rt,{modelValue:l(d).metricsOpacity,"onUpdate:modelValue":s[1]||(s[1]=R=>l(d).metricsOpacity=R),width:"200px",min:0,max:1,step:.1},null,8,["modelValue"]),V(" "+x(l(h).number.toPercent((l(d).metricsOpacity||0)*100)),1)])]),t("div",oa,[s[6]||(s[6]=t("div",{class:"hand-statistic-page__params-item-title"}," Ширина виджета (200px - 1880px) ",-1)),t("div",da,[a(Pt,{modelValue:l(d).metricsWidth,"onUpdate:modelValue":s[2]||(s[2]=R=>l(d).metricsWidth=R),width:"80px",min:0,max:1880,step:10},null,8,["modelValue"])])]),t("div",ca,[s[7]||(s[7]=t("div",{class:"hand-statistic-page__params-item-title"}," Выбор темы интерфейса ",-1)),t("label",ra,[a(It,{"is-large":""})])])])]),_:1},512),a(Q,{ref_key:"selectTankDialogRef",ref:f,width:"640px","no-scroll":"",title:"Добавление танка"},{default:i(()=>[l(y).vehicles?(g(),K(Mt,{key:0,items:l(y).vehicles,exclude:l(m).tanks.map(R=>R.tank_id),onSelect:nt,onCancel:$},null,8,["items","exclude"])):N("",!0)]),_:1},512),a(Q,{ref_key:"editTankDialogRef",ref:u,width:"480px","no-scroll":"",title:"Изменение показателей"},{default:i(()=>[a(Ot,{modelValue:l(m).currentTank,"onUpdate:modelValue":s[4]||(s[4]=R=>l(m).currentTank=R),onClose:it,onSave:Vt},null,8,["modelValue"])]),_:1},512),a(Q,{ref_key:"confirmResetDialogRef",ref:w,width:"480px",title:"Сброс сессии"},{footer:i(()=>[t("div",ua,[s[12]||(s[12]=t("span",null,null,-1)),t("div",_a,[a(C,{width:"80px",align:"center",onClick:xt},{default:i(()=>s[10]||(s[10]=[V(" Да ")])),_:1}),a(C,{width:"80px",align:"center",onClick:Ut},{default:i(()=>s[11]||(s[11]=[V(" Нет ")])),_:1})])])]),default:i(()=>[s[13]||(s[13]=t("div",{class:"content-area"},[t("p",null," Вы уверены? Текущий прогресс будет утерян. ")],-1))]),_:1},512)]),_:1})):(g(),K(gt,{key:1,class:"hand-statistic-page"},{default:i(()=>[a(Wt,{height:"calc(70vh)"},{default:i(()=>s[14]||(s[14]=[V(" Для использования ручной статистики необходимо авторизоваться ")])),_:1})]),_:1}))}}});export{Ga as default};
